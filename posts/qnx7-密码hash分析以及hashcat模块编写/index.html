<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.147.8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="前言
在 2021 年想要碰撞 QNX Hash 发现 hashcat 不支持 QNX 6.6.0版本。当时 issue 就有人提了这个需求，但我一直很忙没时间开发。"><title>QNX7 密码 hash 算法分析以及 Hashcat 模块编写&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.63f706677e61b4ee62b8daf083358d3bbf8ac8ab03c7d171af3180fab3a3ebb83efb79fb98674f13dde6db11de2bf694.css" integrity="sha384-Y/cGZ35htO5iuNrwgzWNO7&#43;KyKsDx9FxrzGA&#43;rOj67g&#43;&#43;3n7mGdPE93m2xHeK/aU"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="QNX7 密码 hash 算法分析以及 Hashcat 模块编写" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/about">About</a><a class="nav item" href="/links">Links</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">QNX7 密码 hash 算法分析以及 Hashcat 模块编写</h1><p class="article date">Thursday, September 14, 2023</p></section><article class="article markdown-body"><h2 id="前言">前言</h2>
<p>在 2021 年想要碰撞 QNX Hash 发现 hashcat 不支持 QNX 6.6.0版本。当时 issue 就有人提了这个需求，但我一直很忙没时间开发。</p>
<p>直到2023年9月的艰难单刷工信部车联网攻防演练，又遇到了 QNX 7 的 Hash，发现那么多年过去了还是没支持。</p>
<p>为了防止下次又遇到这个需求，于是就抽空研究了 qnx 的库还有 hashcat，为了编写 hashcat 模块走了一点弯路。</p>
<p><img loading="lazy"  src="qnxhash.png"
        alt="qnxhash.png"/></p>
<h2 id="qnx-etcshadow-hash算法分析">QNX /etc/shadow hash算法分析</h2>
<p>根据官方文档 <a href="https://www.qnx.com/developers/docs/7.0.0/index.html#com.qnx.doc.neutrino.user_guide/topic/accounts_etc_shadow.html"target="_blank" rel="noopener noreferrer">QNX 700 docs: accounts_etc_shadow</a>，可以得知Hash组成如下</p>
<pre tabindex="0"><code>@digest@hash@salt
@digest,iterations@hash@salt
</code></pre><p>这个 hash 使用 @ 作为分隔符，大写的 S 代表是 SHA-512，小写的 s 代表 SHA-256。如果加逗号和数字就代表迭代的次数。随后是 Base64 格式的 hash 和 base64 格式的 salt。</p>
<p>阅读完 QNX 官方文档的描述，给人的感觉是原来那么简单。如果看了 hashcat 的 QNX6 (-m 19200) 的模块，第一反应就是，是不是改一下迭代和格式就行了？</p>
<p>于是我复制了一份 QNX6 碰撞模块，想复用代码减轻工作量。按照官方文档适配，hashcat 总是返回 self-test 失败。随后分析 /src/OpenCL/m19200.cl 发现参考了 John 的代码，并且做了一些 hack 的处理，不够优雅。首先猜测是这段 CL 代码有 bug，下一步就是去分析 QNX 7 的 hash 生成逻辑。</p>
<p>hash 的生成逻辑在 <code>/usr/lib/pam.qnx.so</code></p>
<p>分析完逻辑，和 m19200.cl 对比发现，首先旧版本 CL 代码里轮次不对，第一轮就是盐和密码拼接计算一次 SHA，其次新生成的 digest 没有和上一次结果异或。所以不是简单 base64 就行的。</p>
<p><img loading="lazy"  src="pam_qnx.png"
        alt="pam_qnx.png"/></p>
<p>其实新版的 hash 生成逻辑使用的是 标准的 PBKDF2 (Password-Based Key Derivation Function) 算法，很多软件（Adobe、MacOS、Cisco等）都使用这个算法生成 Hash，迭代次数越高，碰撞 hash 的效率就越低。QNX 官方文档没有明说算法名称，只说是 SHA-512，某种意义上提高了安全研究门槛。</p>
<p><img loading="lazy"  src="pbkdf2.png"
        alt="PBKDF2"/></p>
<p>可以使用 Cyberchef 来验证。</p>
<pre tabindex="0"><code>https://gchq.github.io/CyberChef/#recipe=Derive_PBKDF2_key(%7B&#39;option&#39;:&#39;UTF8&#39;,&#39;string&#39;:&#39;hashcat&#39;%7D,512,4096,&#39;SHA512&#39;,%7B&#39;option&#39;:&#39;Base64&#39;,&#39;string&#39;:&#39;NDY2MDEwNjk3YjBjYzM2MzliMzc3Mzc0ZTNiMTAzNzE%3D&#39;%7D)&amp;input=dm0ybkJHSGVzNlFrWHJhMGY3NFhtb3VTaVJ6allEM3IvMHB5K3R4djBLcjhBNGhDUE1HRkhvWnFyNDFKRmlZY0pQUE9lSWhlcUZzZU15THl3LzE1UHc9PQ
</code></pre><h2 id="hashcat模块编写">Hashcat模块编写</h2>
<p>参考官方文档</p>
<p><a href="https://github.com/hashcat/hashcat/blob/master/docs/hashcat-plugin-development-guide.md"target="_blank" rel="noopener noreferrer">https://github.com/hashcat/hashcat/blob/master/docs/hashcat-plugin-development-guide.md</a></p>
<p>最开始我还在想办法写新的 CL 代码，得知是标准算法后，直接摆烂，想找一个顺眼的来改。</p>
<pre tabindex="0"><code>./hashcat -hh | grep PBKDF2
  11900 | PBKDF2-HMAC-MD5                                            | Generic KDF
  12000 | PBKDF2-HMAC-SHA1                                           | Generic KDF
  10900 | PBKDF2-HMAC-SHA256                                         | Generic KDF
  12100 | PBKDF2-HMAC-SHA512                                         | Generic KDF
   2500 | WPA-EAPOL-PBKDF2                                           | Network Protocol
  22000 | WPA-PBKDF2-PMKID+EAPOL                                     | Network Protocol
  16800 | WPA-PMKID-PBKDF2                                           | Network Protocol
  12800 | MS-AzureSync PBKDF2-HMAC-SHA256                            | Operating System
   9200 | Cisco-IOS $8$ (PBKDF2-SHA256)                              | Operating System
   7100 | macOS v10.8+ (PBKDF2-SHA512)                               | Operating System
</code></pre><p>hashcat 每次运行都会自检当前模块，ST_HASH 和 ST_PASS 就是测试用例。于是把 KERN_TYPE 直接改为7100，打算一点一点调试，但是没想到一次就跑通了。</p>
<p>hashcat 是开源项目，合并代码比较慢，所以附上代码。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Author......: See docs/credits.txt
</span></span></span><span class="line"><span class="cl"><span class="cm"> * License.....: MIT
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;common.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;types.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;modules.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;bitops.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;convert.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;shared.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;emu_inc_hash_sha512.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;memory.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">ATTACK_EXEC</span>    <span class="o">=</span> <span class="n">ATTACK_EXEC_OUTSIDE_KERNEL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS0</span>      <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS1</span>      <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS2</span>      <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS3</span>      <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_SIZE</span>      <span class="o">=</span> <span class="n">DGST_SIZE_8_16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">HASH_CATEGORY</span>  <span class="o">=</span> <span class="n">HASH_CATEGORY_OS</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">HASH_NAME</span>      <span class="o">=</span> <span class="s">&#34;QNX 7 /etc/shadow (SHA512)&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u64</span>   <span class="n">KERN_TYPE</span>      <span class="o">=</span> <span class="mi">7100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">OPTI_TYPE</span>      <span class="o">=</span> <span class="n">OPTI_TYPE_ZERO_BYTE</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTI_TYPE_USES_BITS_64</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTI_TYPE_SLOW_HASH_SIMD_LOOP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u64</span>   <span class="n">OPTS_TYPE</span>      <span class="o">=</span> <span class="n">OPTS_TYPE_STOCK_MODULE</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTS_TYPE_PT_GENERATE_LE</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTS_TYPE_ST_BASE64</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTS_TYPE_HASH_COPY</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">SALT_TYPE</span>      <span class="o">=</span> <span class="n">SALT_TYPE_EMBEDDED</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ST_PASS</span>        <span class="o">=</span> <span class="s">&#34;hashcat&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ST_HASH</span>        <span class="o">=</span> <span class="s">&#34;@S@vm2nBGHes6QkXra0f74XmouSiRzjYD3r/0py+txv0Kr8A4hCPMGFHoZqr41JFiYcJPPOeIheqFseMyLyw/15Pw==@NDY2MDEwNjk3YjBjYzM2MzliMzc3Mzc0ZTNiMTAzNzE=&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_attack_exec</span>    <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">ATTACK_EXEC</span><span class="p">;</span>     <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos0</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS0</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos1</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS1</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos2</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS2</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos3</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS3</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_size</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_SIZE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_hash_category</span>  <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">HASH_CATEGORY</span><span class="p">;</span>   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">module_hash_name</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">HASH_NAME</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u64</span>         <span class="nf">module_kern_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">KERN_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_opti_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">OPTI_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u64</span>         <span class="nf">module_opts_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">OPTS_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_salt_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">SALT_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">module_st_hash</span>        <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">ST_HASH</span><span class="p">;</span>         <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">module_st_pass</span>        <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">ST_PASS</span><span class="p">;</span>         <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">pbkdf2_sha512</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">u32</span> <span class="n">salt_buf</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kt">pbkdf2_sha512_t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">pbkdf2_sha512_tmp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">ipad</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">opad</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">dgst</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">out</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kt">pbkdf2_sha512_tmp_t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u64</span> <span class="nf">module_esalt_size</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u64</span> <span class="n">esalt_size</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">u64</span><span class="p">)</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">pbkdf2_sha512_t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">esalt_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u64</span> <span class="nf">module_tmp_size</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u64</span> <span class="n">tmp_size</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">u64</span><span class="p">)</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">pbkdf2_sha512_tmp_t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">tmp_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">ROUNDS_QNX</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">HASH_SIZE</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">module_hash_decode</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">void</span> <span class="o">*</span><span class="n">digest_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">salt_t</span> <span class="o">*</span><span class="n">salt</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">void</span> <span class="o">*</span><span class="n">esalt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">void</span> <span class="o">*</span><span class="n">hook_salt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">hashinfo_t</span> <span class="o">*</span><span class="n">hash_info</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">line_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">line_len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span> <span class="o">*</span><span class="n">digest</span> <span class="o">=</span> <span class="p">(</span><span class="n">u64</span> <span class="o">*</span><span class="p">)</span> <span class="n">digest_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="kt">pbkdf2_sha512_t</span> <span class="o">*</span><span class="n">pbkdf2_sha512</span> <span class="o">=</span> <span class="p">(</span><span class="kt">pbkdf2_sha512_t</span> <span class="o">*</span><span class="p">)</span> <span class="n">esalt_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">hc_token_t</span> <span class="n">token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">token</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">hc_token_t</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">token_cnt</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// @digest@hash@salt
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// @digest,iterations@hash@salt
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_FIXED_LENGTH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_min</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_VERIFY_LENGTH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_min</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_max</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_VERIFY_LENGTH</span> <span class="o">|</span> <span class="n">TOKEN_ATTR_VERIFY_BASE64A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_min</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_max</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_VERIFY_LENGTH</span> <span class="o">|</span> <span class="n">TOKEN_ATTR_VERIFY_BASE64A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">int</span> <span class="n">rc_tokenizer</span> <span class="o">=</span> <span class="nf">input_tokenizer</span> <span class="p">((</span><span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="p">)</span> <span class="n">line_buf</span><span class="p">,</span> <span class="n">line_len</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">token</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">rc_tokenizer</span> <span class="o">!=</span> <span class="n">PARSER_OK</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="n">rc_tokenizer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// check hash type
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;S&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SIGNATURE_UNMATCHED</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// check iter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">u32</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">ROUNDS_QNX</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;,&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SEPARATOR_UNMATCHED</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">iter</span> <span class="o">=</span> <span class="nf">hc_strtoul</span> <span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// iter++; the additional round is added in the init kernel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_iter</span> <span class="o">=</span> <span class="n">iter</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">hash_pos</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">int</span> <span class="n">hash_len</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">decoded_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">u8</span> <span class="n">tmp_buf</span><span class="p">[</span><span class="mi">512</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">decoded_len</span> <span class="o">=</span> <span class="nf">base64_decode</span> <span class="p">(</span><span class="n">base64_to_int</span><span class="p">,</span> <span class="n">hash_pos</span><span class="p">,</span> <span class="n">hash_len</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">decoded_len</span> <span class="o">!=</span> <span class="n">HASH_SIZE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SALT_LENGTH</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memcpy</span> <span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">,</span> <span class="mi">64</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">7</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// salt
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">salt_pos</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">int</span> <span class="n">salt_len</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">decoded_len</span> <span class="o">=</span> <span class="nf">base64_decode</span> <span class="p">(</span><span class="n">base64_to_int</span><span class="p">,</span> <span class="n">salt_pos</span><span class="p">,</span> <span class="n">salt_len</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">decoded_len</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SALT_LENGTH</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span> <span class="p">(</span><span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">,</span> <span class="n">decoded_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_len</span> <span class="o">=</span> <span class="n">decoded_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_OK</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">module_hash_encode</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">digest_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">salt_t</span> <span class="o">*</span><span class="n">salt</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">esalt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">hook_salt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashinfo_t</span> <span class="o">*</span><span class="n">hash_info</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">line_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">line_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">snprintf</span> <span class="p">(</span><span class="n">line_buf</span><span class="p">,</span> <span class="n">line_size</span><span class="p">,</span> <span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">hash_info</span><span class="o">-&gt;</span><span class="n">orighash</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">module_init</span> <span class="p">(</span><span class="kt">module_ctx_t</span> <span class="o">*</span><span class="n">module_ctx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_context_size</span>             <span class="o">=</span> <span class="n">MODULE_CONTEXT_SIZE_CURRENT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_interface_version</span>        <span class="o">=</span> <span class="n">MODULE_INTERFACE_VERSION_CURRENT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_attack_exec</span>              <span class="o">=</span> <span class="n">module_attack_exec</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_esalt</span>          <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_hook_salt</span>      <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_mask</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_charset</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_salt</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_build_plain_postprocess</span>  <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_deep_comp_kernel</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_deprecated_notice</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos0</span>                <span class="o">=</span> <span class="n">module_dgst_pos0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos1</span>                <span class="o">=</span> <span class="n">module_dgst_pos1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos2</span>                <span class="o">=</span> <span class="n">module_dgst_pos2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos3</span>                <span class="o">=</span> <span class="n">module_dgst_pos3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_size</span>                <span class="o">=</span> <span class="n">module_dgst_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dictstat_disable</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_esalt_size</span>               <span class="o">=</span> <span class="n">module_esalt_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_extra_buffer_size</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_extra_tmp_size</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_extra_tuningdb_block</span>     <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_forced_outfile_format</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_binary_count</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_binary_parse</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_binary_save</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode_postprocess</span>  <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode_potfile</span>      <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode_zero_hash</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode</span>              <span class="o">=</span> <span class="n">module_hash_decode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_encode_status</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_encode_potfile</span>      <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_encode</span>              <span class="o">=</span> <span class="n">module_hash_encode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_init_selftest</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_mode</span>                <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_category</span>            <span class="o">=</span> <span class="n">module_hash_category</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_name</span>                <span class="o">=</span> <span class="n">module_hash_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hashes_count_min</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hashes_count_max</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hlfmt_disable</span>            <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_extra_param_size</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_extra_param_init</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_extra_param_term</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook12</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook23</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_salt_size</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_size</span>                <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_jit_build_options</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_jit_cache_disable</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_accel_max</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_accel_min</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_loops_max</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_loops_min</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_threads_max</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_threads_min</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kern_type</span>                <span class="o">=</span> <span class="n">module_kern_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kern_type_dynamic</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_opti_type</span>                <span class="o">=</span> <span class="n">module_opti_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_opts_type</span>                <span class="o">=</span> <span class="n">module_opts_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_outfile_check_disable</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_outfile_check_nocomp</span>     <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_potfile_custom_check</span>     <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_potfile_disable</span>          <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_potfile_keep_all_hashes</span>  <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_pwdump_column</span>            <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_pw_max</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_pw_min</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_salt_max</span>                 <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_salt_min</span>                 <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_salt_type</span>                <span class="o">=</span> <span class="n">module_salt_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_separator</span>                <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_st_hash</span>                  <span class="o">=</span> <span class="n">module_st_hash</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_st_pass</span>                  <span class="o">=</span> <span class="n">module_st_pass</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_tmp_size</span>                 <span class="o">=</span> <span class="n">module_tmp_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_unstable_warning</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_warmup_disable</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="参考">参考</h2>
<p><a href="https://news.sophos.com/fr-fr/2013/11/21/stocker-mots-de-passe-en-securite/"target="_blank" rel="noopener noreferrer">Serious Security : stocker vos mots de passe en toute sécurité</a></p>
<p><a href="https://github.com/openwall/john/blob/bleeding-jumbo/src/sha2.c#L578-L595"target="_blank" rel="noopener noreferrer">https://github.com/openwall/john/blob/bleeding-jumbo/src/sha2.c#L578-L595</a></p>
<p><a href="https://github.com/hashcat/hashcat"target="_blank" rel="noopener noreferrer">https://github.com/hashcat/hashcat</a></p>
</article><section class="article labels"><a class="category" href=/categories/%E6%B1%BD%E8%BD%A6%E5%AE%89%E5%85%A8/>汽车安全</a><a class="tag" href=/tags/qnx/>QNX</a><a class="tag" href=/tags/hashcat/>Hashcat</a><a class="tag" href=/tags/pbkdf2/>PBKDF2</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/posts/vw-id.4-%E8%BD%A6%E6%8E%A7%E5%88%86%E6%9E%90/"><span class="iconfont icon-article"></span>VW ID.4 ICAS1 车控分析</a></p><p><a class="link" href="/posts/%E5%9B%BA%E4%BB%B6%E9%80%86%E5%90%91%E7%9A%84%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7/"><span class="iconfont icon-article"></span>固件逆向的通用技巧</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2025 Gorgias' Blog. </p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>