<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.147.8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="è¿™æ®µæ—¶é—´æœ‰ä¸å°‘è¿›å±•ï¼Œä½†æ˜¯é‡åˆ°ç“¶é¢ˆäº†ï¼Œå¤§æ¦‚è¿˜æœ‰æœ‰ä¸‰ç¯‡çš„é‡ï¼Œæœ€è¿‘å¾ˆå¿™ï¼Œå…ˆæ›´æ–°ç¬¬ä¸‰ç¯‡ã€‚
æˆ‘æŠŠèŠ¯ç‰‡è´´çº¸æ‹†å¼€å¹¶åšäº†è¯¦ç»†çš„åˆ†æå·¥ä½œï¼Œç¬¬ä¸€ç¯‡ç¡¬ä»¶åˆ†ææ–¹å‘åŸºæœ¬ä¸Šæ²¡é”™ï¼Œæ›´æ–°äº†å¯¹IGSçš„èŠ¯ç‰‡æè¿°ï¼Œç¬¬äºŒç¯‡æ–‡ç« ä»£ç æœ‰ä¸€äº›bugï¼Œå·²æ›´æ–°ã€‚"><title>IGS Arcade é€†å‘ç³»åˆ—ï¼ˆä¸‰ï¼‰- Getshell&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.63f706677e61b4ee62b8daf083358d3bbf8ac8ab03c7d171af3180fab3a3ebb83efb79fb98674f13dde6db11de2bf694.css" integrity="sha384-Y/cGZ35htO5iuNrwgzWNO7&#43;KyKsDx9FxrzGA&#43;rOj67g&#43;&#43;3n7mGdPE93m2xHeK/aU"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="IGS Arcade é€†å‘ç³»åˆ—ï¼ˆä¸‰ï¼‰- Getshell" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/about">About</a><a class="nav item" href="/links">Links</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">IGS Arcade é€†å‘ç³»åˆ—ï¼ˆä¸‰ï¼‰- Getshell</h1><p class="article date">Monday, June 23, 2025</p></section><article class="article markdown-body"><p>è¿™æ®µæ—¶é—´æœ‰ä¸å°‘è¿›å±•ï¼Œä½†æ˜¯é‡åˆ°ç“¶é¢ˆäº†ï¼Œå¤§æ¦‚è¿˜æœ‰æœ‰ä¸‰ç¯‡çš„é‡ï¼Œæœ€è¿‘å¾ˆå¿™ï¼Œå…ˆæ›´æ–°ç¬¬ä¸‰ç¯‡ã€‚</p>
<p>æˆ‘æŠŠèŠ¯ç‰‡è´´çº¸æ‹†å¼€å¹¶åšäº†è¯¦ç»†çš„åˆ†æå·¥ä½œï¼Œç¬¬ä¸€ç¯‡ç¡¬ä»¶åˆ†ææ–¹å‘åŸºæœ¬ä¸Šæ²¡é”™ï¼Œæ›´æ–°äº†å¯¹IGSçš„èŠ¯ç‰‡æè¿°ï¼Œç¬¬äºŒç¯‡æ–‡ç« ä»£ç æœ‰ä¸€äº›bugï¼Œå·²æ›´æ–°ã€‚</p>
<p><a href="/posts/igs_arcade_re_1">IGS Arcade é€†å‘ç³»åˆ—ï¼ˆä¸€ï¼‰- E2000å¹³å°åˆ†æ</a></p>
<p><a href="/posts/igs_arcade_re_2">IGS Arcade é€†å‘ç³»åˆ—ï¼ˆäºŒï¼‰- æ¸¸æˆæ–‡ä»¶æ¢å¤</a></p>
<p>è¦é«˜æ•ˆåˆ†ææ¸¸æˆä¸»ç¨‹åºï¼Œæœ€å¥½æ˜¯è®¾å¤‡ä¸ŠåŠ¨æ€è°ƒè¯•ï¼Œé¦–å…ˆéœ€è¦shellæƒé™ã€‚é™¤äº†CFå¡å’ŒIOå£ï¼Œæˆ‘ç›®å‰å‡ ä¹æ²¡æœ‰ä»»ä½•å¯¹è¿™ä¸ªè®¾å¤‡è¾“å…¥å†…å®¹çš„é€”å¾„ã€‚</p>
<p>å¦‚æœèµ°ä¸²å£è°ƒè¯•ï¼Œç¬¬ä¸€æ­¥æ‰¾åˆ°ç¡¬ä»¶è°ƒè¯•å£ï¼Œä¸‹ä¸€æ­¥ä¿®æ”¹kernelå†…ç½®çš„boot commandã€‚å¾ˆéº»çƒ¦ï¼Œè¿˜è¦é‡æ‰“åŒ…å›å»ï¼Œä¸å¤Ÿä¼˜é›…ã€‚</p>
<p>CFå¡æœ‰ä¸¤ä¸ªåˆ†åŒºæˆ‘å¯ä»¥ç›´æ¥å†™å…¥ï¼Œä¸€ä¸ªå°±æ˜¯Kernelæ‰€åœ¨çš„Bootåˆ†åŒºï¼Œå¦ä¸€ä¸ªæ˜¯æ—¥å¿—å’Œä¸´æ—¶æ–‡ä»¶åˆ†åŒºï¼Œé‚£ä¸ªè¯´ä¸å®šå¯ä»¥getshellï¼Œä½†æ˜¯Pwnè¿™ä¸ªç¡¬ä»¶ä¸æ˜¯æˆ‘çš„ç›®çš„ã€‚</p>
<h2 id="igs-cramfs-é‡æ‰“åŒ…">IGS CRAMFS é‡æ‰“åŒ…</h2>
<p>ä¹‹å‰æˆ‘æ ¹æ®IGSé­”æ”¹çš„cramfsç‰¹å¾ï¼ŒäºŒæ¬¡å¼€å‘äº†cramfs-toolsï¼Œä½†æ˜¯å®ƒåªèƒ½è§£åŒ…ï¼Œä¸èƒ½é‡æ‰“åŒ…ã€‚å®ƒæ˜¯ä¸å®Œç¾çš„ï¼Œæˆ‘æœ‰ä¸€ç‚¹å¼ºè¿«ç—‡ï¼Œæƒ³è¦è®©å®ƒä½œä¸ºçœŸæ­£çš„toolkitsã€‚</p>
<p>IGS é­”æ”¹äº†cramfsçš„ç»“æ„ä½“ï¼Œåœ¨cramfs_inodeåŠ å…¥äº†æ ¡éªŒå€¼ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡è¯»å–inodeå°±ä¼šæ£€æŸ¥ã€‚</p>
<pre tabindex="0"><code>struct cramfs_super {
	unsigned int magic1;
	unsigned int future;	/* future = CRAMFS_MAGIC ^ IGS_MAGIC_MASK2 ^ IGS_MAGIC_MASK1 */ 
    char igs_info[64];
	unsigned int size;	
	unsigned int magic2;
	unsigned int flags;	
	unsigned int padding;	
	struct cramfs_info fsid;
	char name[64];	
	struct cramfs_inode root;
};
struct cramfs_inode {
	u32 inode_magic;
	u32 namelen:CRAMFS_NAMELEN_WIDTH, offset:CRAMFS_OFFSET_WIDTH;
	u32 size:CRAMFS_SIZE_WIDTH, gid:CRAMFS_GID_WIDTH;
	u32 mode:CRAMFS_MODE_WIDTH, uid:CRAMFS_UID_WIDTH;
};
struct cramfs_info {
	u32 crc;
	u32 edition;
	u32 blocks;
	u32 files;
};
</code></pre><p>åœ¨get_cramfs_inodeï¼Œæœ‰ä¸€ä¸ªæš—æ¡©ï¼Œç”¨inode_magicå¼‚æˆ–æ ¹inodeçš„magicï¼Œåˆ¤æ–­æ˜¯å¦ç­‰äº0x705DE1ï¼Œå¦‚æœä¸ç­‰äºå°±å‡ºé”™ã€‚è™½ç„¶ç®€å•ï¼Œä½†æ˜¯æ¯ä¸ªæ¸¸æˆéƒ½ä¸ä¸€æ ·ï¼Œé‡å¤çš„patchå·¥ä½œä¹ŸæŒºçƒ¦äººçš„ã€‚
ä¸‹å›¾çš„å¯è¯»æ€§çœ‹èµ·æ¥ä¸é”™ï¼Œæ˜¯å› ä¸ºæˆ‘åšäº†ä¸€äº›è´¹æ—¶é—´çš„å·¥ä½œã€‚å…¶å®è¿™é‡ŒIDAçš„åç¼–è¯‘ä¸€å¼€å§‹æ˜¯è¯†åˆ«é”™è¯¯çš„ï¼Œå’Œæ±‡ç¼–å®Œå…¨ä¸ä¸€æ ·ã€‚è¦æŠŠç»“æ„ä½“å…ˆè¿˜åŸäº†ï¼Œè¿™é‡Œçš„åˆ†æ”¯æ‰ä¼šæ­£ç¡®ï¼Œä¸ç„¶å°±ä¼šä¸¢å¤±å¾ˆå¤šä»£ç ã€‚</p>
<p><img loading="lazy"  src="./get_inode.png"
        alt="get_inode"/></p>
<p>æˆ‘å·²ç»å®ç°äº†cramfsé‡æ‰“åŒ…çš„åŠŸèƒ½ <a href="https://github.com/gorgiaxx/igs-toolkits/tree/master/"target="_blank" rel="noopener noreferrer">igs-toolkits cramfs-tools</a></p>
<p>Unpack</p>
<pre tabindex="0"><code>sudo ./igs-toolkits/cramfs-tools/cramfsck -v -x./out ./test.img
</code></pre><p>Repack</p>
<pre tabindex="0"><code>sudo ./igs-toolkits/cramfs-tools/mkcramfs ./out test.img
</code></pre><h2 id="ä¿®å¤-shell-ç¯å¢ƒ">ä¿®å¤ Shell ç¯å¢ƒ</h2>
<p>IGS åœ¨æ–°ç‰ˆçš„PM2008ï¼Œåšäº†å¾ˆå¤šé˜»æ­¢ç ´è§£çš„æªæ–½ã€‚è¿™ä¸ªKerneléå¸¸è€ï¼Œæˆ‘èŠ±äº†å¤§é‡æ—¶é—´è§£å†³å…¼å®¹æ€§é—®é¢˜ã€‚æ“ä½œç³»ç»Ÿï¼Œç¼–è¯‘å·¥å…·é“¾ï¼Œæºä»£ç åå¤æµ‹è¯•äº†è®¸å¤šç‰ˆæœ¬ï¼Œç»ˆäºæ‰¾åˆ°äº†ç¨³å®šçš„ç¼–è¯‘ç¯å¢ƒã€‚</p>
<h3 id="ä¿®å¤agetty">ä¿®å¤agetty</h3>
<p>ç°åœ¨çš„ç³»ç»Ÿåˆå§‹åŒ–åæ˜¯æ²¡æœ‰tty shellçš„ï¼Œå› ä¸ºIGSç§»é™¤äº†agettyã€‚è¿™ä¸ªç»„ä»¶ä½äºutil-linuxã€‚éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œé™æ€é“¾æ¥ã€‚</p>
<pre tabindex="0"><code>CC=&#34;/opt/gcc_3.2.2/bin/gcc&#34;
LDFLAGS=&#34;-static&#34;
DESTDIR=/root/build-linux-utils
export LDFLAGS CC DESTDIR
./configure --enable-static
make
make install
</code></pre><p>ç„¶ååœ¨ /etc/inittabï¼Œå¢åŠ ä¸‹é¢è¿™è¡Œå‘½ä»¤ã€‚çœ‹èµ·æ¥æ˜¯æœ‰115200çš„ä¸²å£è¾“å‡ºï¼Œæˆ‘è¿˜æ²¡æœ‰åœ¨COMå£å°è¯•ã€‚å› ä¸ºåœ¨å§å®¤é‡Œç ”ç©¶ï¼Œåœºåœ°æœ‰é™ï¼Œæˆ‘å–œæ¬¢æ›´ä¼˜é›…çš„è°ƒè¯•æ–¹å¼ã€‚</p>
<pre tabindex="0"><code>1:4:respawn:/sbin/agetty ttyS1 115200 vt102
</code></pre><h3 id="ä¿®å¤ssh-services">ä¿®å¤SSH Services</h3>
<p>IGSç§»é™¤äº†sshæœåŠ¡ï¼Œæœ¬æ¥æƒ³ç”¨ç°æˆçš„dropbearï¼Œç»“æœæ²¡ä¸€ä¸ªèƒ½è¿è¡Œã€‚èŠ±äº†å¤§é‡æ—¶é—´æ‰¾åˆ°ä¸ªå…¼å®¹çš„dropbear 0.53ç‰ˆæœ¬ï¼Œå®Œæˆé™æ€ç¼–è¯‘ï¼ˆè§£å†³äº†å¾ˆå¤šé”™è¯¯ï¼‰ï¼Œå¾ˆå¤šç‰¹æ€§æ˜¯åœ¨ä»£ç é‡Œå†™æ­»çš„ï¼Œæˆ‘ç”šè‡³åšäº†ä¸€äº›patchï¼Œä½†è¿˜ä¼šå‡ºç°å¥‡æ€ªçš„é—®é¢˜ã€‚
äºæ˜¯åªèƒ½é€‰æ‹©sshï¼Œæ–°ç‰ˆçš„sshç”±äºå¼ƒç”¨äº†è¿‡æ—¶åŠ å¯†ç®—æ³•ï¼Œè¿æ¥æ—§ç‰ˆsshéƒ½è¦æŒ‡å®šç®—æ³•ã€‚å› æ­¤è¦é€‰æ‹©è¾ƒæ–°ç‰ˆæœ¬çš„opensshï¼Œä»¥åŠopensslã€‚</p>
<p>ç¼–è¯‘å¥½åç”Ÿæˆå¯†é’¥å¯¹ï¼Œå› ä¸ºç®—æ³•å’Œæ ¼å¼æœ‰å·®å¼‚ï¼Œæ‰€ä»¥è¦é‡æ–°ç”Ÿæˆ</p>
<pre tabindex="0"><code>ssh-keygen -q -t rsa -f ssh_host_key
ssh-keygen -q -t rsa -f ssh_host_rsa_key
</code></pre><p>sshd_config éœ€è¦æ‰‹åŠ¨é…ç½®è¿™äº›</p>
<pre tabindex="0"><code>HostKey /home/ssh_host_key
HostKey /home/ssh_host_rsa_key
SyslogFacility AUTHPRIV
LogLevel INFO
PermitRootLogin yes
AuthorizedKeysFile	.ssh/authorized_keys
PermitEmptyPasswords yes
X11Forwarding yes
Subsystem	sftp	/home/sftp-server
</code></pre><p>æœ€åéœ€è¦ä¿®å¤sshdçš„æƒé™ï¼Œå¦åˆ™ä¼šå‡ºé”™</p>
<pre tabindex="0"><code>mkdir /var/empty
echo &#34;sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin&#34; &gt;&gt; /etc/passwd
</code></pre><p>åœ¨å‰æ–‡æåˆ°çš„å¯åŠ¨è„šæœ¬æ·»åŠ sshå¯åŠ¨å‘½ä»¤</p>
<pre tabindex="0"><code>/home/sshd -f /home/sshd_config -h /home/ssh_host_rsa_key -p 22 -E /PM2008v2/pm2_data/sshd.log &gt; /PM2008v2/pm2_data/sshd_run.log 2&gt;&amp;1
</code></pre><h3 id="ä¿®å¤ifconfigå¹¶ä¸”å¯ç”¨ç½‘ç»œ">ä¿®å¤ifconfigå¹¶ä¸”å¯ç”¨ç½‘ç»œ</h3>
<p>IGS ç¦æ­¢äº†ç½‘ç»œè¿æ¥ï¼Œæˆ‘åœ¨æ¸¸æˆä»£ç é‡Œçœ‹åˆ°æ˜¯å¯ä»¥è”ç½‘çš„ï¼Œç”šè‡³è¿˜æœ‰DHCPæœåŠ¡ã€‚ä½†æ˜¯é…ç½®IPçš„é€»è¾‘å†™åœ¨ä»£ç é‡Œï¼Œå°šä¸æ¸…æ¥šæ˜¯å¦‚ä½•è§¦å‘çš„ï¼ˆå¯èƒ½éœ€è¦å®Œæ•´çš„å°æ¶ç¯å¢ƒï¼‰ã€‚</p>
<p>ifconfigè¢«å¤±æ•ˆäº†ï¼Œæ‡’å¾—åˆ†æï¼Œè‡ªå·±é‡æ–°ç¼–è¯‘ä¸€ä¸ªã€‚</p>
<pre tabindex="0"><code>/home/ifconfig eth0 up mtu 1500 &gt;&gt; /PM2008v2/pm2_data/game_stdout.log 2&gt;&amp;1
/home/ifconfig eth0 192.168.2.128 netmask 255.255.255.0 broadcast 192.168.2.255 &gt;&gt; /PM2008v2/pm2_data/game_stdout.log 2&gt;&amp;1
</code></pre><p>è¿™æ ·å°±å¯ä»¥è¿æ¥å¤–éƒ¨ç½‘ç»œäº†ã€‚</p>
<p>æˆ‘è¿˜ç¼–è¯‘äº†ä¸€ç‰ˆ busyboxï¼Œé‡åˆ°å¤§é‡å…¼å®¹æ€§é—®é¢˜ï¼Œåšäº†ä¸€äº›patchï¼Œä¹ŸèŠ±äº†å¾ˆå¤šæ—¶é—´æ‰ç¼–è¯‘æˆåŠŸã€‚äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½</p>
<p><a href="https://github.com/gorgiaxx/igs-toolkits/tree/master/E2000_binaries"target="_blank" rel="noopener noreferrer">https://github.com/gorgiaxx/igs-toolkits/tree/master/E2000_binaries</a></p>
<p>å°†è¿™äº›æ–‡ä»¶æ”¾åˆ°æŒ‡å®šç›®å½•ï¼Œç„¶åé‡æ‰“åŒ…ï¼Œå†™å…¥CFå¡ï¼Œé‡å¯è®¾å¤‡ï¼ŒsshæœåŠ¡å°±å¯ä»¥ç›´æ¥è®¿é—®äº†ã€‚</p>
<p>ç”±äºæ²¡æœ‰å›æ˜¾ï¼Œåªèƒ½å°†stdoutè¾“å‡ºåˆ°rdisk4s4ï¼Œä¹Ÿå°±æ˜¯ext3åˆ†åŒºï¼Œè¯»å–å¹¶æŒ‚åœ¨æŸ¥çœ‹å›æ˜¾ã€‚èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰è°ƒè¯•æˆåŠŸï¼Œè¿™ä¸¤æ¡å‘½ä»¤ç”¨äº†æ— æ•°æ¬¡ã€‚</p>
<pre tabindex="0"><code>sudo dd if=/dev/rdisk4s4 of=./rdisk4s4.img bs=1M &amp;&amp; rm -rf ./part4 &amp;&amp; 7z x ./rdisk4s4.img -o./part4
</code></pre><pre tabindex="0"><code>sudo ../igs-toolkits/cramfs-tools/mkcramfs ./out test.img &amp;&amp; sudo dd if=./test.img of=/dev/rdisk4s2 bs=1M
</code></pre><h2 id="æ¸¸æˆç¯å¢ƒåˆ†æ">æ¸¸æˆç¯å¢ƒåˆ†æ</h2>
<h3 id="æ¸¸æˆä¸»ç¨‹åº">æ¸¸æˆä¸»ç¨‹åº</h3>
<p>æ¸¸æˆä¸»ç¨‹åºå®é™…è¿è¡Œåœ¨/exec/PM2008v2 ä¼šå¯åŠ¨3ä¸ªè¿›ç¨‹</p>
<p><img loading="lazy"  src="./shell.png"
        alt="shell"/></p>
<p>æ ¹æ®åœ°å€ç©ºé—´ï¼Œå¯ä»¥åˆ¤æ–­å‡ºï¼Œæ­¤ç¨‹åºè¿è¡Œåœ¨X11ï¼ŒOpenGLæ¸²æŸ“ã€‚å¹¶ä¸”å¯ä»¥æ§åˆ¶è¯»å¡å™¨ã€‚è°ƒç”¨äº†/dev/plx/Pci9030-0ï¼Œè®¿é—®æ–¹å¼æ˜¯DMAè½¬è™šæ‹Ÿåœ°å€ï¼Œåº”è¯¥æ˜¯æ¸¸æˆçš„ç‰©ç†I/Oã€‚</p>
<pre tabindex="0"><code>[IGS_Linux]root ~# cat /proc/120/maps 
08048000-084b6000 r-xp 00000000 00:08 98         /exec/PM2008v2
084b6000-084cb000 rw-p 0046e000 00:08 98         /exec/PM2008v2
084cb000-0b044000 rwxp 00000000 00:00 0 
40000000-40013000 r-xp 00000000 16:02 11153856   /lib/ld-2.3.2.so
40013000-40014000 rw-p 00012000 16:02 11153856   /lib/ld-2.3.2.so
40014000-40015000 rw-p 00000000 00:00 0 
40015000-4001d000 r-xp 00000000 16:02 57643504   /usr/sbin/cardread/lib/libcasmcard.so
4001d000-4001e000 rw-p 00007000 16:02 57643504   /usr/sbin/cardread/lib/libcasmcard.so
4001e000-40020000 rwxp 00000000 00:0b 2217       /dev/zero
40020000-4002d000 r-xp 00000000 16:02 12504408   /lib/libpthread-0.10.so
4002d000-4002e000 rw-p 0000d000 16:02 12504408   /lib/libpthread-0.10.so
4002e000-40070000 rw-p 00000000 00:00 0 
40070000-40072000 r-xp 00000000 16:02 11995640   /lib/libdl-2.3.2.so
40072000-40073000 rw-p 00001000 16:02 11995640   /lib/libdl-2.3.2.so
40073000-400de000 r-xp 00000000 16:02 28323568   /usr/X11R6/lib/libGL.so.1.0.8762
400de000-400f7000 rwxp 0006b000 16:02 28323568   /usr/X11R6/lib/libGL.so.1.0.8762
400f7000-400f8000 rwxp 00000000 00:00 0 
400f8000-400f9000 rw-p 00000000 00:00 0 
400f9000-4021e000 r-xp 00000000 16:02 11262808   /lib/libc-2.3.2.so
4021e000-40223000 rw-p 00124000 16:02 11262808   /lib/libc-2.3.2.so
40223000-40225000 rw-p 00000000 00:00 0 
40225000-40246000 r-xp 00000000 16:02 12066128   /lib/libm-2.3.2.so
40246000-40247000 rw-p 00020000 16:02 12066128   /lib/libm-2.3.2.so
40247000-40254000 r-xp 00000000 16:02 34514852   /usr/X11R6/lib/libXext.so.6.4
40254000-40255000 rw-p 0000c000 16:02 34514852   /usr/X11R6/lib/libXext.so.6.4
40255000-40331000 r-xp 00000000 16:02 33143504   /usr/X11R6/lib/libX11.so.6.2
40331000-40334000 rw-p 000db000 16:02 33143504   /usr/X11R6/lib/libX11.so.6.2
40334000-40342000 r-xp 00000000 16:02 57803624   /usr/sbin/cardread/lib/libpcsclite.so.0.0.1
40342000-40343000 rw-p 0000d000 16:02 57803624   /usr/sbin/cardread/lib/libpcsclite.so.0.0.1
40343000-40344000 rw-p 00000000 00:00 0 
40344000-40ad2000 r-xp 00000000 16:02 28719620   /usr/X11R6/lib/libGLcore.so.1.0.8762
40ad2000-40b02000 rwxp 0078d000 16:02 28719620   /usr/X11R6/lib/libGLcore.so.1.0.8762
40b02000-40b06000 rwxp 00000000 00:00 0 
40b06000-40b07000 rw-p 00000000 00:00 0 
40b07000-40b08000 r-xp 00000000 16:02 40614972   /usr/X11R6/lib/libnvidia-tls.so.1.0.8762
40b08000-40b09000 rw-p 00000000 16:02 40614972   /usr/X11R6/lib/libnvidia-tls.so.1.0.8762
40b09000-40b6b000 rw-p 00000000 00:00 0 
40b6b000-40b6c000 rw-s 00000000 00:0b 2004       /dev/plx/Pci9030-0
40b6c000-40b8c000 rw-s 00000000 00:0b 2004       /dev/plx/Pci9030-0
40b8c000-40b8d000 rw-s 00000000 00:0b 2004       /dev/plx/Pci9030-0
40b8d000-4158e000 rw-p 00000000 00:00 0 
4158e000-41596000 r-xp 00000000 16:02 34498192   /usr/X11R6/lib/libXcursor.so.1.0
41596000-41597000 rw-p 00007000 16:02 34498192   /usr/X11R6/lib/libXcursor.so.1.0
41597000-4159e000 r-xp 00000000 16:02 37237160   /usr/X11R6/lib/libXrender.so.1.2
4159e000-4159f000 rw-p 00006000 16:02 37237160   /usr/X11R6/lib/libXrender.so.1.2
4159f000-415a0000 rw-s e8001000 00:0b 1990       /dev/nvidia0
415a0000-415a1000 rw-s e8c02000 00:0b 1990       /dev/nvidia0
415a1000-415aa000 r-xp 00000000 16:02 12388932   /lib/libnss_files-2.3.2.so
415aa000-415ab000 rw-p 00008000 16:02 12388932   /lib/libnss_files-2.3.2.so
415ab000-415c2000 rw-s 00000000 00:04 0          /SYSV00000000 (deleted)
415c2000-416ee000 rw-s d0000000 00:0b 1990       /dev/nvidia0
416ee000-41750000 rw-p 00000000 00:0b 2217       /dev/zero
41750000-41791000 rw-p 00000000 00:00 0 
41791000-41893000 rw-s e0011000 00:0b 1990       /dev/nvidia0
41893000-41894000 rw-s 16fc2000 00:0b 1990       /dev/nvidia0
41894000-41895000 rw-s 17027000 00:0b 1990       /dev/nvidia0
41895000-41896000 rw-s df93b000 00:0b 1990       /dev/nvidia0
41896000-4189a000 rw-s 17025000 00:0b 1990       /dev/nvidia0
4189a000-4189b000 rw-s df939000 00:0b 1990       /dev/nvidia0
4189b000-4189c000 rw-s 17021000 00:0b 1990       /dev/nvidia0
4189c000-4199c000 rw-s e0114000 00:0b 1990       /dev/nvidia0
4199c000-4199d000 rw-s 00000000 00:04 98305      /SYSV00000000 (deleted)
4199d000-4199e000 rw-s 00000000 00:04 131074     /SYSV00000000 (deleted)
4199e000-41a56000 rw-p 00000000 00:00 0 
41a56000-41a57000 ---p 00000000 00:00 0 
41a57000-41c56000 rwxp 00001000 00:00 0 
41c56000-43096000 rw-p 00003000 00:00 0 
43096000-43097000 r--s 00000000 00:07 2709       /tmp/pcsc/.pcscpub
43097000-43098000 r--s 00001000 00:07 2709       /tmp/pcsc/.pcscpub
43098000-43099000 r--s 00002000 00:07 2709       /tmp/pcsc/.pcscpub
43099000-4309a000 r--s 00003000 00:07 2709       /tmp/pcsc/.pcscpub
4309a000-4309b000 r--s 00004000 00:07 2709       /tmp/pcsc/.pcscpub
4309b000-4309c000 r--s 00005000 00:07 2709       /tmp/pcsc/.pcscpub
4309c000-4309d000 r--s 00006000 00:07 2709       /tmp/pcsc/.pcscpub
4309d000-4309e000 r--s 00007000 00:07 2709       /tmp/pcsc/.pcscpub
4309e000-4309f000 r--s 00008000 00:07 2709       /tmp/pcsc/.pcscpub
4309f000-430a0000 r--s 00009000 00:07 2709       /tmp/pcsc/.pcscpub
430a0000-430a1000 r--s 0000a000 00:07 2709       /tmp/pcsc/.pcscpub
430a1000-430a2000 r--s 0000b000 00:07 2709       /tmp/pcsc/.pcscpub
430a2000-430a3000 r--s 0000c000 00:07 2709       /tmp/pcsc/.pcscpub
430a3000-430a4000 r--s 0000d000 00:07 2709       /tmp/pcsc/.pcscpub
430a4000-430a5000 r--s 0000e000 00:07 2709       /tmp/pcsc/.pcscpub
430a5000-430a6000 r--s 0000f000 00:07 2709       /tmp/pcsc/.pcscpub
430a6000-4352f000 rw-p 00000000 00:00 0 
43530000-441c9000 rw-p 0048a000 00:00 0 
4423c000-44322000 rw-p 01196000 00:00 0 
443a7000-444b0000 rw-p 01301000 00:00 0 
bfde2000-c0000000 rwxp ffde3000 00:00 0
</code></pre><p>æ¸¸æˆç¨‹åºæœ¬èº«æœ‰å¤§é‡ç¬¦å·ï¼Œçœ‹èµ·æ¥åƒæ˜¯ç¼–ç åçš„æ•°æ®ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»æ¥æ²¡æ¥è§¦è¿‡Big5ç¼–ç ï¼Œç›´æ¥è®©deepseekå¸®æˆ‘å†™äº†ä¸ªè„šæœ¬è¯†åˆ«ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">chardet</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">encodings.aliases</span> <span class="kn">import</span> <span class="n">aliases</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">try_all_encodings</span><span class="p">(</span><span class="n">hex_str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">all_encodings</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">aliases</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">byte_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">hex_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŸå§‹16è¿›åˆ¶æ•°æ®: </span><span class="si">{</span><span class="n">hex_str</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å­—èŠ‚é•¿åº¦: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">byte_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">detected</span> <span class="o">=</span> <span class="n">chardet</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">byte_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è‡ªåŠ¨æ£€æµ‹ç»“æœ: </span><span class="si">{</span><span class="n">detected</span><span class="p">[</span><span class="s1">&#39;encoding&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (ç½®ä¿¡åº¦: </span><span class="si">{</span><span class="n">detected</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">common_encodings</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;gbk&#39;</span><span class="p">,</span> <span class="s1">&#39;gb18030&#39;</span><span class="p">,</span> <span class="s1">&#39;gb2312&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-16&#39;</span><span class="p">,</span> <span class="s1">&#39;big5&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;hz&#39;</span><span class="p">,</span> <span class="s1">&#39;iso-2022-jp&#39;</span><span class="p">,</span> <span class="s1">&#39;euc-kr&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== å¸¸è§ç¼–ç æµ‹è¯• ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="n">common_encodings</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">decoded</span> <span class="o">=</span> <span class="n">byte_data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[</span><span class="si">{</span><span class="n">enc</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="n">decoded</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== å®Œæ•´ç¼–ç æµ‹è¯• ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_encodings</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">decoded</span> <span class="o">=</span> <span class="n">byte_data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">decoded</span><span class="o">.</span><span class="n">isprintable</span><span class="p">():</span> 
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[</span><span class="si">{</span><span class="n">enc</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="n">decoded</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">hex_data</span> <span class="o">=</span> <span class="s2">&#34;C2 F7 B6 7D 3A A6 50 AE C9 BA 56 C0 BB 31 50 A4 CE 32 50 B9 AA AD B1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">try_all_encodings</span><span class="p">(</span><span class="n">hex_data</span><span class="p">)</span>
</span></span></code></pre></div><p>æ¸¸æˆæ˜¯å°æ¹¾åœ°åŒºç ”å‘çš„ï¼Œä½¿ç”¨äº†ç¹ä½“ä¸­æ–‡ï¼ŒIDAä¸èƒ½è‡ªåŠ¨è¯†åˆ«ã€‚éœ€è¦æ‰‹åŠ¨æ·»åŠ ã€‚</p>
<p>Option -&gt; Strings -&gt; Default(8-bit) -&gt; Insert(Right Click) -&gt; Big5</p>
<p><img loading="lazy"  src="./big5.png"
        alt="big5"/></p>
<p>å› ä¸ºéASCIIï¼Œä¹Ÿæ²¡æœ‰å¤ªå¥½çš„è¯†åˆ«æ–¹å¼ï¼Œå°±è¿˜æ˜¯å‚è€ƒä¸Šç¯‡æ–‡ç« çš„ä¿®å¤å­—ç¬¦ä¸²æ€è·¯å§ã€‚</p>
<p><img loading="lazy"  src="./strings.png"
        alt="strings"/></p>
<p>è¿è¡Œæ¸¸æˆä¸»ç¨‹åºï¼Œåªä¼šæ‰“å°è¿™äº›æ—¥å¿—ã€‚</p>
<pre tabindex="0"><code>[IGS_Linux]root /proc/sys# /exec/PM2008v2
Device Handle 4
Version Major 4,Minor 3,Rev 0
Get Virtual address!!

[CommandPortAddresss]=0x40b8c000,[ShareRAMAddress]=0x40b6c000
Clear CommandPort Complete.
start
</code></pre><p>ä»£ç é‡Œå°†dprintfé€»è¾‘ç§»é™¤äº†ï¼Œæ‰€ä»¥ä¸ä¼šæ‰“å°æ—¥å¿—ã€‚</p>
<h2 id="åæ§½">åæ§½</h2>
<p>ä¸Šä¸ªæœˆæˆ‘éƒ½Linuxç”µè„‘CPUç¼©è‚›äº†ï¼Œæ­»å› æ˜¯é•¿æœŸè¿è¡Œï¼Œæ•£çƒ­ä¸å¥½ï¼ŒèŠ±äº†å¤§é‡æ—¶é—´æ’æŸ¥ï¼Œç„¶åè¿ç§»å·¥å…·ã€‚
ä»¥å‰å†™åšå®¢éƒ½æ˜¯nvmåˆ°æ—§ç‰ˆnodeï¼Œè¿è¡ŒHexoæ¡†æ¶ç”Ÿæˆé™æ€é¡µé¢ï¼Œ8å¹´æ²¡æœ‰åŠ¨è¿‡ï¼Œé‚£ä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„ä¾èµ–ï¼Œåœ¨MacOSå¾ˆéš¾è·‘èµ·æ¥ï¼Œæˆ‘ä¸ç†è§£ä¸€ä¸ªnodejsç¨‹åºä¸ºä»€ä¹ˆè¦ç”¨åˆ°python3.8ã€‚
è¿ç§»ç‰ˆhexoåˆé‡åˆ°å¤§é‡ä¾èµ–é—®é¢˜ï¼Œæˆ‘éƒ½ç”¨asdfäº†ï¼Œæ€ä¹ˆè¿˜èƒ½è¿™æ ·ï¼Ÿæœæ–­æ”¾å¼ƒHexoï¼Œè¿ç§»åšå®¢åˆ°Hugoç”¨äº†å¾ˆå¤šæ—¶é—´ã€‚</p>
<p>ç°åœ¨é‡åˆ°ç“¶é¢ˆäº†ï¼Œå› ä¸ºèŠ‚å¥æ¸¸æˆçš„åˆ¤æ–­ï¼Œæ˜¯æ”¾åˆ°ASICï¼ŒASICæŠŠåˆ¤å®šçŠ¶æ€ä¼ é€’åˆ°CPUã€‚ä¸»ç¨‹åºæ˜¯æ²¡æœ‰åˆ¤æ–­é€»è¾‘çš„ï¼Œè‡ªå·±å†™å€’æ˜¯æ²¡é—®é¢˜ï¼Œä½†è¿™è¿˜å«ç ´è§£å—ğŸ˜‚ï¼Ÿåªæœ‰ç ´è§£äº†ASICï¼Œæ‰èƒ½å®Œç¾æ¨¡æ‹Ÿè¿™äº›æ¸¸æˆã€‚ä¸çŸ¥é“ä»Šå¹´èƒ½ä¸èƒ½æŠŠASICç ´è§£ã€‚</p>
<p>ä¸‹ä¸€ç¯‡å°†åˆ†æPLXPCIåè®®ï¼Œä»¥åŠä¸€äº›patchå·¥ä½œã€‚</p>
</article><section class="article labels"><a class="category" href=/categories/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/>é€†å‘å·¥ç¨‹</a><a class="tag" href=/tags/igs/>IGS</a><a class="tag" href=/tags/arcade/>Arcade</a><a class="tag" href=/tags/crack/>Crack</a><a class="tag" href=/tags/%E9%88%8A%E8%B1%A1%E7%94%B5%E5%AD%90/>éˆŠè±¡ç”µå­</a><a class="tag" href=/tags/e2000/>E2000</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/posts/igs_arcade_re_2/"><span class="iconfont icon-article"></span>IGS Arcade é€†å‘ç³»åˆ—ï¼ˆäºŒï¼‰- æ¸¸æˆæ–‡ä»¶æ¢å¤</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2025 Gorgias' Blog. </p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>