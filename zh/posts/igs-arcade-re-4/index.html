<!DOCTYPE html>
<html lang="zh"><meta charset="utf-8"><meta name="generator" content="Hugo 0.154.5"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="åµŒå…¥å¼æ¶æ„åˆ†æ
IGSçš„åç›—ç‰ˆæŠ€æœ¯ä¸Šä¸éš¾ï¼Œä½†æ˜¯éå¸¸è¯¡å¼‚ï¼Œå¯èƒ½æ˜¯ä»£ç å†™çš„å¤ªçƒ‚äº†ã€‚"><title>IGS Arcade é€†å‘ç³»åˆ—ï¼ˆå››ï¼‰- ASIC27åè®®å’ŒTSGROMæ–‡ä»¶é™æ€åˆ†æ&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.363cdd0e3e6340dd0e88b1f21887fb7e53e3129ed31d7f3cf62686d06069621ece79dc5ffb48a77ebba54468e667212f.css" integrity="sha384-NjzdDj5jQN0OiLHyGIf7flPjEp7THX889iaG0GBpYh7Oedxf&#43;0infrulRGjmZyEv"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="IGS Arcade é€†å‘ç³»åˆ—ï¼ˆå››ï¼‰- ASIC27åè®®å’ŒTSGROMæ–‡ä»¶é™æ€åˆ†æ" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/zh/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/zh/categories/">åˆ†ç±»</a><a class="nav item" href="/zh/tags/">æ ‡ç­¾</a><a class="nav item" href="/zh/about/">å…³äº</a><a class="nav item" href="/zh/links/">å‹é“¾</a><a class="nav item" href="/en/posts/igs-arcade-re-4/" title="English">
            <span class="lang-icon">ğŸŒ</span>English</a></nav></div></span></div></section><section id="content"><style>
     
    .toc-wrapper {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 9999;
        display: flex;
        flex-direction: column-reverse;
        align-items: flex-end;
        gap: 10px;
    }

     
    .toc-button {
        background-color: #fff;
        color: #333;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        border: 1px solid #ddd;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .toc-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    .toc-button svg {
        width: 24px;
        height: 24px;
        fill: currentColor;
    }

     
    .toc-content-box {
        background: #fff;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 15px;
        width: 250px;
        max-height: 60vh;
        overflow-y: auto;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        display: none;
         
        font-size: 0.9em;
        opacity: 0;
        transform: translateY(10px);
        transition: opacity 0.3s, transform 0.3s;
    }

    .toc-content-box.show {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    .toc-header {
        font-weight: bold;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 8px;
        margin-bottom: 8px;
        font-size: 1.1em;
    }

     
    #TableOfContents {
        text-align: left;
    }

    #TableOfContents ul,
    #TableOfContents ol {
        list-style: none;
        padding-left: 0;
        margin: 0;
    }

    #TableOfContents li {
        margin: 4px 0;
    }

    #TableOfContents ul ul,
    #TableOfContents ol ol {
        padding-left: 1em;
    }

    #TableOfContents a {
        text-decoration: none;
        color: #555;
        display: block;
        padding: 2px 0;
        transition: color 0.2s;
    }

    #TableOfContents a:hover {
        color: #007bff;
    }

     
    @media (prefers-color-scheme: dark) {
        .toc-button {
            background-color: #333;
            color: #ddd;
            border-color: #555;
        }

        .toc-content-box {
            background-color: #2a2a2a;
            border-color: #444;
            color: #ddd;
        }

        .toc-header {
            border-bottom-color: #444;
        }

        #TableOfContents a {
            color: #aaa;
        }

        #TableOfContents a:hover {
            color: #fff;
        }
    }
</style><div class="article-container"><section class="article header">
    <h1 class="article title">IGS Arcade é€†å‘ç³»åˆ—ï¼ˆå››ï¼‰- ASIC27åè®®å’ŒTSGROMæ–‡ä»¶é™æ€åˆ†æ</h1><p class="article date">2025-09-08<span class="langs"><span class="lang">
                    <a href="/en/posts/igs-arcade-re-4/" title="English">
                        <span class="lang-icon">ğŸŒ</span>English</a>
                </span></span></p></section><article class="article markdown-body"><h1 id="åµŒå…¥å¼æ¶æ„åˆ†æ">åµŒå…¥å¼æ¶æ„åˆ†æ</h1>
<p>IGSçš„åç›—ç‰ˆæŠ€æœ¯ä¸Šä¸éš¾ï¼Œä½†æ˜¯éå¸¸è¯¡å¼‚ï¼Œå¯èƒ½æ˜¯ä»£ç å†™çš„å¤ªçƒ‚äº†ã€‚</p>
<p>IGS E2000 æœ¬è´¨ä¸Šï¼Œæ˜¯ PC + æ¸¸æˆåŸºæ¿ çš„ç»„åˆï¼ˆç ”åè®¾è®¡ï¼‰ã€‚æ—¢è¦è€ƒè™‘åˆ° Anti-Copy ï¼ˆåç›—ç‰ˆï¼‰ï¼Œåˆéœ€è¦è€ƒè™‘åˆ°è½¯ä»¶å·¥ç¨‹ä¸Šçš„å¤ç”¨ã€‚ASICç›¸å½“äºä¸€ä¸ªå®Œå…¨é»‘ç›’çš„è®¡ç®—æ¨¡å—ï¼Œå°†æ¸¸æˆå…³é”®é€»è¾‘æ”¾åœ¨é‡Œé¢ï¼Œæ—¢èƒ½æå‡æ€§èƒ½ï¼Œä¹Ÿå¯ä»¥é˜²æ­¢ç ´è§£ã€‚</p>
<p><img loading="lazy"  src="diagram.png"
        alt="diagram"/></p>
<h2 id="ä¸»ç¨‹åºæµç¨‹åˆ†æ">ä¸»ç¨‹åºæµç¨‹åˆ†æ</h2>
<p>æ¸¸æˆä¸»ç¨‹åºä¼šå¼€è¾Ÿä¸€æ®µ 0x200034çš„æ ˆç©ºé—´ï¼Œå…¶ä¸­ç¼“å†²åŒºå 0x200000ï¼Œè€Œä¸”è¿™ä¸ªæ ˆå¼€è¾Ÿå‡ºæ¥åä¸ä¼šæ¢å¤ï¼Œè¿™ä¼šå¯¼è‡´IDA Proæ— æ³•åç¼–è¯‘ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ•…æ„çš„ã€‚</p>
<p><img loading="lazy"  src="main.png"
        alt="main"/></p>
<p>é¦–å…ˆéœ€è¦patchè¿™ä¸ªç¼“å†²åŒºå¤§å°ï¼Œå‡å°å‡½æ•°çš„æ ˆå¸§ï¼Œç„¶åå°†å‡½æ•° undefineï¼Œæœ€åé‡æ–°è¯†åˆ«ï¼Œå°±å¯ä»¥æˆåŠŸåç¼–è¯‘ã€‚</p>
<p><img loading="lazy"  src="edit_func.png"
        alt="edit_func"/></p>
<ol>
<li>Kernel mount_root æ—¶ï¼Œä»¥åŠæ¸¸æˆç¨‹åºå¯åŠ¨æ—¶ ä¼šæ ¡éªŒ BIOS ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¼€å‘è€…å´è¯´æ˜¯è·å–CRCç»“æœï¼Œç»“æœæˆ‘æ„£æ˜¯æ‰¾éäº†æ‰€æœ‰CRCçš„ä½ç½®ï¼Œä¹Ÿæ²¡æ‰¾åˆ°ä»»ä½•åç›—ç‰ˆæœ‰å…³çš„CRCè®¡ç®—é€»è¾‘ï¼›</li>
<li>BIOS ä¿¡æ¯æ ¡éªŒå¤±è´¥å°±æ ¡éªŒPCIçš„é©±åŠ¨ä¿¡æ¯ï¼Œå¦‚æœå¤±è´¥ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰ä»»ä½•æ“ä½œï¼Œä½†å…¶ä»–åœ°æ–¹ä¹Ÿæ’å…¥äº†è®¸å¤šä¸€æ ·çš„æ ¡éªŒæ¡©ï¼Œæ ¡éªŒå¤±è´¥å°±ä¼šé˜»æ­¢è¿è¡Œï¼›</li>
<li>ç³»ç»Ÿåˆå§‹åŒ–ï¼šå±å¹•ã€éŸ³é¢‘ã€å›¾å½¢ã€æ–‡å­—ã€è¯­è¨€ã€ASICã€Timerã€PLXPCIã€æ¸¸æˆã€éŸ³ä¹ã€æ§åˆ¶å™¨ã€æ‘„åƒæœºã€å°è´¦ã€æ§åˆ¶ã€æŠ•å¸ã€æ··åˆå™¨ç­‰ç­‰ï¼›</li>
<li>åˆ·æ–°4æ¬¡ASICï¼Œwhy???ï¼›</li>
<li>åŠ è½½åŸºç¡€ action æ–‡ä»¶ï¼ˆTSGROMæ ¼å¼ï¼‰ï¼Œæ¯æ¬¡åŠ è½½éƒ½åˆ·æ–°ä¸€æ¬¡ASICï¼›</li>
<li>æ¸¸æˆç‰ˆæœ¬æ ¡éªŒï¼Œæ˜¾ç¤ºç¬¬ä¸€å±ï¼ŒåŠ è½½å­—ä½“ï¼ŒåŠ è½½å£°éŸ³ï¼›</li>
<li>åŠ è½½è¯»å¡å™¨ï¼›</li>
<li>æ¸¸æˆLoopï¼Œ4ç§çŠ¶æ€(Game, Test, Setting, Demo)ï¼Œå¯é€šè¿‡ASICæ§åˆ¶</li>
</ol>
<p><img loading="lazy"  src="main_loop.png"
        alt="main_loop"/></p>
<p>æ¸¸æˆä½¿ç”¨äº†SDL 1.2.7å¼€å‘ï¼ŒSDLï¼ˆSimple DirectMedia Layerï¼‰æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¤šåª’ä½“å¼€å‘åº“ï¼Œä¸»è¦ç”¨äºæä¾›å¯¹éŸ³é¢‘ã€è¾“å…¥è®¾å¤‡ï¼ˆé”®ç›˜/é¼ æ ‡/æ¸¸æˆæ‰‹æŸ„ï¼‰å’Œå›¾å½¢ç¡¬ä»¶çš„åº•å±‚è®¿é—®â€Œã€‚ä½†æ˜¯è¿™ä¸ªæ€§èƒ½æ¯”è¾ƒä½ï¼Œåªé€‚åˆ2Dæ¸¸æˆã€‚Percussion Master 2008 æ˜¯2Dæ¸¸æˆã€‚Speed Driver 2 æ˜¯ 3Dæ¸¸æˆï¼Œä¸¤è€…çš„å·®åˆ«å¯èƒ½å¾ˆå¤§ã€‚</p>
<p>å¼€å‘è€…åœ¨æ¸¸æˆä¸»ç¨‹åºæ¯ä¸€å¤„ä¸ ASIC äº¤äº’çš„ä½ç½®ï¼Œéƒ½æ’äº†ä»£ç æ¡©ï¼Œæš‚æ—¶æŠŠä»–ç§°ä½œ <code>RealTimeEvent</code>ï¼Œåº”è¯¥æ˜¯ç»Ÿä¸€äº‹ä»¶å¤„ç†ç¨‹åºï¼Œæ¯æ¬¡é€»è¾‘çš„å˜åŒ–ã€åŠ¨ç”»çš„å˜åŒ–ï¼Œéƒ½éœ€è¦åˆ·æ–°äº‹ä»¶ã€‚ç”¨æ¥å®ç°å„ç§å¤æ‚çš„æ§åˆ¶åŠŸèƒ½ï¼Œä¹Ÿé™„å¸¦äº†ä¸€äº›åç›—ç‰ˆåŠŸèƒ½ã€‚ä¸å¾—ä¸åæ§½ï¼Œè¿™ä¸ªä»£ç è´¨é‡çœŸç³Ÿç³•ï¼Œæ¯æ¬¡éƒ½è¦åšå¤§é‡çš„è®¡ç®—ï¼Œæ€§èƒ½å¾ˆå·®ï¼Œå’Œç”¨çº¯ js + html å¼€å‘å•é¡µé¢åº”ç”¨ä¸€æ ·ã€‚</p>
<p>çŠ¶æ€æ£€æŸ¥æ¡©çš„é€»è¾‘</p>
<ol>
<li>æ›´æ–°æ—¶é’Ÿ</li>
<li>è®¡æ—¶å™¨æ£€æŸ¥</li>
<li>Actionå¤„ç†</li>
<li>éŸ³ä¹å¤„ç†</li>
<li>éŸ³é¢‘å¤„ç†</li>
<li>æŒ‰é”®çŠ¶æ€ä»¥åŠæ§åˆ¶è¾“å…¥</li>
<li>å°è´¦</li>
<li>æ¸¸æˆå¸å¤„ç†</li>
<li>PLX PCI çŠ¶æ€å¤„ç†</li>
<li>SDL äº‹ä»¶å¤„ç†</li>
<li>ç»˜åˆ¶åŠ¨æ€äº”è¾¹å½¢åŠ¨ç”»</li>
<li>PCI æ§åˆ¶å†™å…¥</li>
<li>ASIC 27 å‘½ä»¤å†™å…¥</li>
<li>PCI æ•°æ®è¯»å–</li>
<li>å›¾å½¢åˆ·æ–°</li>
</ol>
<h3 id="åŒºåŸŸåˆå§‹åŒ–">åŒºåŸŸåˆå§‹åŒ–</h3>
<p>percussion master 2008 æ”¯æŒ7ä¸ªåœ°åŒºï¼Œ3ç§è¯­è¨€ï¼›ç®€ä½“ä¸­æ–‡ã€ç¹ä½“ä¸­æ–‡ã€è‹±æ–‡ã€‚</p>
<p><img loading="lazy"  src="location_table.png"
        alt="location_table"/></p>
<h2 id="roio-bios-ä¿¡æ¯æ ¡éªŒ">ROIO BIOS ä¿¡æ¯æ ¡éªŒ</h2>
<p>å†…æ ¸ä¼šè¿è¡Œä¸€ä¸ªé©±åŠ¨ /dev/roio, æ¸¸æˆç¨‹åºé€šè¿‡æ­¤é©±åŠ¨å¯¹æ¯”å†…ç½®çš„ç‰ˆæœ¬ä¿¡æ¯è¡¨ï¼Œå®ç°æ ¡éªŒåŠŸèƒ½ã€‚å†…æ ¸æœ¬èº«å’Œæ¸¸æˆç¨‹åºå‡å†…ç½®äº†è¡¨æ ¼ï¼ŒåŸç†åº”è¯¥æ˜¯å¼€å‘è€…é€šè¿‡æŸäº›å·¥å…·è§£æäº†BIOSä¿¡æ¯ï¼Œç„¶åå°†ç‰©ç†åç§»ç¡¬ç¼–ç åˆ°ç¨‹åºå’Œå†…æ ¸é‡Œé¢ã€‚</p>
<p><img loading="lazy"  src="bios_table.png"
        alt="bios_table"/></p>
<p>å†…æ ¸å’Œä¸»ç¨‹åºçš„ BIOS ä¿¡æ¯è¡¨ç»“æ„æœ‰äº›åŒºåˆ«ï¼ŒKernelçš„4å­—èŠ‚å¯¹é½ï¼Œä½†ä½¿ç”¨åŸç†éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>Game BIOS table</p>
<pre tabindex="0"><code>struct bios_item {
    unsigned int index;  // index
    unsigned char table_cmp_max_count;
    unsigned int value_addr; // base addr 0xC0000000
    unsigned char char_cmp_max_count;
    unsigned int name_addr;
}
</code></pre><p>Kernel BIOS table</p>
<pre tabindex="0"><code>struct bios_item {
    unsigned int index;  // index
    unsigned int table_cmp_max_count;
    unsigned int value_addr; // base addr 0xC0000000
    unsigned int char_cmp_max_count;
    unsigned int name_addr;
}
</code></pre><p>å¯¹æ¯”çš„é€»è¾‘ä¹Ÿå¾ˆç®€å•ï¼Œ</p>
<p>ç¬¬ä¸€æ­¥é€šè¿‡éå†ç¨‹åºå†…ç½®çš„ BIOS Tableï¼Œè·å–ç‰ˆæœ¬å­—ç¬¦ä¸²åœ°å€ã€ç›®æ ‡å­—ç¬¦ä¸²ç‰©ç†åœ°å€ã€éå†è½®æ•°ç­‰ã€‚
ç¬¬äºŒæ­¥ï¼Œé€šè¿‡ IOCTL Call /dev/roioï¼Œ å¯¹æ¯”System ROM åŒºåŸŸæŒ‡å®šåç§»å’Œç¨‹åºå†…ç½®çš„å¯¹åº”å­—ç¬¦ä¸²ï¼Œåªè¦æœ‰ä¸€ä¸ªå­—ç¬¦ç›¸ç­‰å°±é€šè¿‡ï¼Œå¤ªè ¢äº†ã€‚</p>
<p>è¯¥å†…æ ¸åªå…è®¸è¿è¡Œåœ¨4ç§ä¸»æ¿ï¼Œä½†æ˜¯æ¸¸æˆå…è®¸è¿è¡Œåœ¨æ›´å¤šçš„è®¾å¤‡ï¼Œå› æ­¤éœ€è¦æ ¡éªŒä¸»ç¨‹åºã€å†…æ ¸ã€ä¸»æ¿æ˜¯å¦åŒ¹é…ã€‚è¿™æ˜¯åç›—ç‰ˆçš„æœºåˆ¶ï¼Œç›´æ¥patchæ‰å°±è¡Œäº†ã€‚</p>
<p>ç»è¿‡ç»Ÿè®¡ï¼Œåœ°å€å’Œç‰ˆæœ¬å­—ç¬¦ä¸²å¦‚ä¸‹ï¼Œæ‰€æœ‰åœ°å€éƒ½æ˜¯0x0f0000èµ·å§‹ã€‚</p>
<pre tabindex="0"><code># Kernel + Game
0x0F086E   i852-W83627HF
0x0FEC7C   i852-W83627HF
0x0FEC8A   6A69YILTC-00
0x0FECDE   Ph6A69YILT

# Game
0x0FE0C1   L4S5MG3
0x0FEC84   6A6IXE19C-00
0x0FECDF   I6A6IXE19
0x0FE0C1   L4S5MG/651+
0x0F006D   nVidia-nForce
0x0FECDE   Ph6A61BPA9
0x0FEC8A   6A61B_00C-00
0x0FECDE   Ph6A61B_00
</code></pre><p>æ¥ä¸‹æ¥åˆ†æROIOé©±åŠ¨ï¼Œå¤§éƒ¨åˆ†ä»£ç éƒ½æ’äº† Anti-Copy æš—æ¡©ï¼Œä½¿ç”¨XORï¼Œå¯¹æ€§èƒ½å½±å“æœ€å°ï¼Œå¯ä»¥é˜²æ­¢æ¸¸æˆAç¨‹åºæ”¾åˆ°æ¸¸æˆBçš„ç³»ç»Ÿè¿è¡Œã€‚</p>
<ul>
<li>è¾“å…¥å‚æ•° mask 0x1FB8408E</li>
<li>è¿”å›å€¼ mask 0xC2E83AB8</li>
</ul>
<p><img loading="lazy"  src="roio_0xfc.png"
        alt="ioctl_0xfc"/></p>
<p>ROIO çš„ Magic Number æœ‰ä¸‰ç§ï¼š</p>
<ul>
<li>0xfc è·å–ç›®æ ‡åœ°å€çš„32ä½æ•°å€¼ï¼Œå°ç«¯</li>
<li>0xfd è·å–ç›®æ ‡åœ°å€çš„32ä½æ•°å€¼ï¼Œå¤§ç«¯</li>
<li>0xfe è·å–ç›®æ ‡åœ°å€çš„8ä½æ•°å€¼</li>
</ul>
<p>æœ€åå† xor 0xC2E83AB8</p>
<p><img loading="lazy"  src="roio_ioctl_dispatcher.png"
        alt="roio_ioctl_dispatcher"/></p>
<p>è¿™é‡Œçš„dataä½œä¸ºåç§»ï¼ŒåŸºå€æ˜¯0xc0000000ï¼Œç„¶ååŠ ä¸ŠBIOSä¿¡æ¯çš„å€¼ï¼Œæ˜¯å› ä¸ºx86æ‰“å¼€äº†pagingï¼Œå› æ­¤CPUè®¿é—®å†…å­˜éœ€è¦èµ°è™šæ‹Ÿåœ°å€ã€‚Linux i386 å¯¹äºè™šæ‹Ÿåœ°å€åç§»çš„è®¾å®šå¦‚ä¸‹</p>
<pre tabindex="0"><code>#define __PAGE_OFFSET (0xC0000000)
#define __pa(x)			((unsigned long) (x) - PAGE_OFFSET)
#define __va(x)			((void *)((unsigned long) (x) + PAGE_OFFSET))
</code></pre><p>é€šè¿‡IOMEMçš„mapï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°BIOSä¿¡æ¯çš„åœ°å€ä½äº System ROM</p>
<pre tabindex="0"><code># cat /proc/iomem
00000000-0009fbff : System RAM
0009fc00-0009ffff : reserved
000a0000-000bffff : Video RAM area
000c0000-000c7fff : Video ROM
000f0000-000fffff : System ROM
00100000-1feeffff : System RAM
  00100000-0050aab5 : Kernel code
  0050aab6-006f8f27 : Kernel data
1fef0000-1fefffff : reserved
1ff00000-1ff003ff : Intel Corp. 82801DB Ultra ATA Storage Controller
d0000000-dfffffff : PCI Bus #01
  d0000000-dfffffff : PCI device 10de:0221 (nVidia Corporation)
e0000000-e7ffffff : Intel Corp. 82852/855GM Host Bridge
e8000000-eaffffff : PCI Bus #01
  e8000000-e8ffffff : PCI device 10de:0221 (nVidia Corporation)
    e8000000-e8ffffff : nvidia
  e9000000-e9ffffff : PCI device 10de:0221 (nVidia Corporation)
eb000000-eb01ffff : PLX Technology, Inc. PCI &lt;-&gt; IOBus Bridge Hot Swap
eb020000-eb02007f : PLX Technology, Inc. PCI &lt;-&gt; IOBus Bridge Hot Swap
eb021000-eb0213ff : PLX Technology, Inc. PCI &lt;-&gt; IOBus Bridge Hot Swap
eb022000-eb022fff : Intel Corp. 82801BD PRO/100 VE (CNR) Ethernet Controller
  eb022000-eb022fff : e100
eb100000-eb1003ff : Intel Corp. 82801DB USB2
  eb100000-eb1003ff : ehci_hcd
eb101000-eb1011ff : Intel Corp. 82801DB AC&#39;97 Audio Controller
  eb101000-eb1011ff : Intel 82801DB-ICH4
eb102000-eb1020ff : Intel Corp. 82801DB AC&#39;97 Audio Controller
  eb102000-eb1020ff : Intel 82801DB-ICH4
fec00000-ffffffff : reserved
</code></pre><p>BIOSèŠ¯ç‰‡å°è£…æ˜¯PLCC 32ï¼Œä½¿ç”¨RT809HæˆåŠŸdumpã€‚</p>
<p><img loading="lazy"  src="PLCC32_BIOS.jpg"
        alt="PLCC32_BIOS"/></p>
<p>ä½¿ç”¨ç³»ç»Ÿå¯åŠ¨åï¼ŒBIOS ROMçš„ä¸€äº›æ•°æ®è¢«è§£æåˆ°äº†å†…å­˜é‡Œï¼Œä¸æ˜¯1:1 copyï¼Œåç§»åœ°å€æ˜¯ 0xF0000ï¼Œã€‚</p>
<p><img loading="lazy"  src="bios_version.png"
        alt="bios_version"/></p>
<h2 id="pccard-éšæœºæ•°æ ¡éªŒ">PCCard éšæœºæ•°æ ¡éªŒ</h2>
<p>æˆ‘å®åœ¨ä¸ç†è§£è¿™ä¸ªä»£ç çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œé©±åŠ¨ä»£ç é‡Œæœ‰SPYçš„å…³é”®è¯ï¼Œå¯èƒ½æ˜¯åå—…æ¢ç”¨çš„æš—æ¡©ï¼Ÿåœ¨å¯åŠ¨ç¨‹åºã€åˆå§‹åŒ–æ¸¸æˆå’Œprintæ—¥å¿—ä¼šè§¦å‘ï¼Œå¦‚æœä¸Šé¢çš„BIOS Check å¤±è´¥äº†ï¼Œä¹Ÿä¼šè§¦å‘æ­¤æ ¡éªŒã€‚é€šè¿‡ioctlæ¥è¯·æ±‚<code>/dev/pccard0</code>ï¼Œè·å–ç»“æœæˆ–è€…ä¸è·å–ç»“æœã€‚</p>
<p><img loading="lazy"  src="pccard_random_value_check1.png"
        alt="pccard_random_value_check1"/></p>
<p>request 0 åˆ—è¡¨ï¼Œç”¨äºå¯¹æ¯”ç»“æœã€‚åˆ—è¡¨æœ‰4ä¸ªæˆå‘˜ï¼Œå¯¹åº”ç›¸å…³åç§»ã€‚ä»å››ä¸ªé‡Œéšæœºé€‰ä¸€ä¸ªï¼Œå¹¶å¸¦ä¸Šéšæœºæ•°ï¼Œéšæœºå€¼åŒºé—´ [17, 768]ï¼Œæœ¬åœ°è®¡ç®—åï¼Œå‘åˆ°é©±åŠ¨æ‰§è¡Œä¸€ä¸‹ï¼Œç„¶åå‘å›æ¥ï¼Œå®é™…ä¸ŠPCIæ²¡æœ‰çœŸæ­£å‚ä¸ã€‚</p>
<pre tabindex="0"><code>0x64 åŸºå€ï¼š0xC8000000 è®¾ç½® SPY_FLAG spy_fixec_func
0x6e åŸºå€ï¼š0xD0000000 è®¾ç½® SPY_FLAG spy_quit_func
0x96 åŸºå€ï¼š0xA8000000 è®¾ç½® SPY_FLAG
0xa0 åŸºå€ï¼š0xB0000000 è®¾ç½® SPY_FLAG
</code></pre><p>request 1 åˆ—è¡¨ï¼Œé•¿åº¦17</p>
<pre tabindex="0"><code>0xfe,0xc8,0xfd,0xa0,0x96,0x6e,0x64,0xdd,0xde,0xdf,0xe0,0xe1,0xe2,0xe3,0xe4,0xe5,0xe6
</code></pre><p>çœ‹[1,255]çš„å€¼æ˜¯å¦èƒ½å‘½ä¸­åˆ—è¡¨çš„å€¼ï¼Œå°è¯•5-30æ¬¡ï¼Œå¦‚æœå‘½ä¸­ï¼Œå°è¯•æ¬¡æ•°-1ï¼Œç„¶åå†æ¥ä¸€æ¬¡ã€‚å¦‚æœæ²¡å‘½ä¸­ï¼Œå°±é€šè¿‡ioctlæ¥è¯·æ±‚éšæœºå€¼å¯¹åº”çš„åç§»ï¼ˆå‚æ•°[17,768]ï¼‰ï¼Œå¹»æ•°å°±æ˜¯å‘½ä¸­çš„é‚£ä¸ªå€¼ã€‚æˆ‘æ„Ÿè§‰å¯èƒ½æ˜¯ç”¨æ¥åˆå§‹åŒ–é©±åŠ¨çš„ï¼Œå®åœ¨æƒ³ä¸åˆ°å…¶ä»–ä½œç”¨äº†ã€‚ä¸ºä»€ä¹ˆå†™çš„é‚£ä¹ˆå¤æ‚ï¼Ÿ</p>
<p><img loading="lazy"  src="pccard_random_value_check.png"
        alt="pccard_random_value_check"/></p>
<p>åœ¨æ¸¸æˆä¸»ç¨‹åºçš„æŸå¤„ï¼Œå‘ç°äº†æ®‹ç•™çš„ä»£ç ï¼Œå¼‚æˆ–çš„å†…å®¹æ˜¯ 0xD4AA268Aï¼Œåœ¨ percussion master 2008 æœªå‘ç°è§¦å‘é€»è¾‘ï¼Œåº”è¯¥æ˜¯å¦ä¸€ä¸ªæ¸¸æˆçš„æš—æ¡©ã€‚å¯ä»¥æ›´ç¡®å®šï¼Œè¿™ä¸ªåŠŸèƒ½å°±æ˜¯ä¸ºäº†åç›—ç‰ˆçš„ã€‚ï¼ˆè™½ç„¶è®¾è®¡çš„å¾ˆçƒ‚ï¼‰</p>
<p><img loading="lazy"  src="pccard_random_value_check2.png"
        alt="pccard_random_value_check2"/></p>
<h2 id="asic-27-åè®®">ASIC 27 åè®®</h2>
<h3 id="a27-åˆå§‹åŒ–">A27 åˆå§‹åŒ–</h3>
<p>æ¸¸æˆä¸»ç¨‹åºä¸I/Oæ¿çš„é€šä¿¡ï¼Œç»è¿‡ PLX PCI 9030 èŠ¯ç‰‡ï¼Œä»¥å…±äº«å†…å­˜çš„æ–¹å¼ï¼Œè¿›è¡Œæ•°æ®äº¤æ¢ã€‚</p>
<p>æ¸¸æˆå¯åŠ¨åï¼ŒASIC 27 åˆå§‹åŒ–ä¹‹å‰ï¼Œä¼šå…ˆåŠ è½½PCI 9030é©±åŠ¨ï¼Œå¹¶å¼€è¾Ÿä¸€æ®µç¼“å†²åŒºï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾ ASIC Bufferï¼Œé‡Œé¢æœ‰å„ç§æ•°æ®çŠ¶æ€ã€‚å¼€å‘è€…ç§°ä½œ CommandPortã€‚</p>
<p><img loading="lazy"  src="pci9030_init.png"
        alt="pci9030_init"/></p>
<p>æ¥ä¸‹æ¥åˆå§‹åŒ– ASIC 27ï¼Œé¦–å…ˆæ›´æ–°Checksumï¼Œå°†ä½äºbufferçš„æŒ‰é”®çµæ•åº¦ã€æŒ‰é”®è¾“å…¥ã€ç¯å…‰çŠ¶æ€ã€system modeã€buffersizeç´¯åŠ å¾—åˆ°æ•°å€¼checksumï¼Œç„¶åæ”¾åœ¨bufferçš„ä¸¤ä¸ªä½ç½®ã€‚åç»­çš„æ¯æ¬¡ASIC 27 è¯·æ±‚ï¼Œéƒ½ä¼šé‡æ–°è®¡ç®— checksumã€‚</p>
<p>é¦–å…ˆå†™å…¥0x2024å­—èŠ‚åˆ°ASIC 27ï¼Œcmd: 0xfeï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æ‹·è´ç¼“å†²åŒºæ•°æ®åˆ°åˆ°å…±äº«å†…å­˜ã€‚
ç„¶åASICå¤„ç†åï¼Œåˆ·æ–°çš„å…±äº«å†…å­˜ï¼Œå¹¶ä¸”ä¼šå°†smä»0x1cæ”¹ä¸ºå…¶ä»–å€¼ï¼Œä»£è¡¨å¤„ç†ç»“æŸã€‚</p>
<p>ASICä¼šå°†æ¸¸æˆçš„é…ç½®ä¿¡æ¯ï¼ŒåŒæ­¥OSç”¨äºæ›´æ–°æ¸¸æˆé…ç½®ï¼Œå°†ä¼šæ›´æ–°ä»¥ä¸‹ç›®å½•</p>
<pre tabindex="0"><code>./pm2_data/storename.dat
./pm2_data/soundset.bin
./pm2_data/gameset.bin
</code></pre><p>å°†smè®¾ä¸º0ï¼ŒåŒæ—¶å†æ›´æ–°ä¸€æ¬¡ checksumï¼Œå‘é€åˆ°A27</p>
<h3 id="system-mode">System Mode</h3>
<p>ç»è¿‡åˆ†æï¼Œä»¥ä¸‹æ¨¡å¼</p>
<ul>
<li>0x0: é»˜è®¤æ¨¡å¼</li>
<li>0x1: ASICæµ‹è¯•æ•°æ®è¯»å–</li>
<li>0x2: æŒ‰é”®æµ‹è¯•</li>
<li>0x3: èœ‚é¸£å™¨æµ‹è¯•</li>
<li>0x4: ç¯å…‰æ¿æµ‹è¯•</li>
<li>0x5: æŠ•å¸æµ‹è¯•</li>
<li>0x6: Trackball æµ‹è¯•</li>
<li>0x7: SelModeï¼ŒIGS Logo</li>
<li>0x8: Teammark</li>
<li>0xc: Coin Page</li>
<li>0xf: option</li>
<li>0x14: Photo</li>
<li>0x10: Song Play</li>
<li>0x1a: CCD</li>
<li>0x1d: è°ƒæ•´éŸ³é‡</li>
</ul>
<h3 id="a27-system-mode-write-çŠ¶æ€æœº">A27 System Mode Write çŠ¶æ€æœº</h3>
<p>å‘é€æ•°æ®åˆ°ASICä¹‹å‰çš„é¢„å¤„ç†ï¼Œå½“ sm ä¸ºä»¥ä¸‹å€¼ï¼Œæ— å¤„ç†é€»è¾‘ï¼Œè¿”å›1</p>
<pre tabindex="0"><code>0x0,0x2,0x3,0x6,0x9,0xa,0xb,0x11,0x12,0x15,0x16,0x17,0x18,0x19,0x1b,0x1c,0x1e
</code></pre><ul>
<li>0x1: æµ‹è¯•æ•°æ®å†™å…¥</li>
<li>0x4: ç¯å…‰æµ‹è¯•</li>
<li>0x5: æŠ•å¸æµ‹è¯•</li>
<li>0x7: SelMode</li>
<li>0x8: Teammark</li>
<li>0xc: ä»£ç å·²åˆ é™¤</li>
<li>0xe: ä»£ç å·²åˆ é™¤</li>
<li>0xf: ä»£ç å·²åˆ é™¤</li>
<li>0x10: Song</li>
<li>0x13: ä»£ç å·²åˆ é™¤</li>
<li>0x14: ä»£ç å·²åˆ é™¤</li>
<li>0x1a: æ‘„åƒæœºæµ‹è¯•</li>
<li>0x1d: è°ƒæ•´éŸ³é‡</li>
</ul>
<p>å…¶ä»–å€¼åˆ™è§¦å‘ Assert</p>
<h3 id="a27-system-mode-analysis-çŠ¶æ€æœº">A27 System Mode Analysis çŠ¶æ€æœº</h3>
<p>ASIC è¿”å›çš„æ•°æ®ï¼Œç”±æ¸¸æˆä¸»ç¨‹åºå¤„ç†ï¼Œå½“ sm ä¸ºä»¥ä¸‹å€¼ï¼Œæ— å¤„ç†é€»è¾‘ï¼Œè¿”å›1</p>
<pre tabindex="0"><code>0x0,0x6,0x9,0xa,0xa,0xb,0x11,0x12,0x15,0x16,0x17,0x18,0x19,0x1b,0x1c,0x1d,0x1e
</code></pre><p>System Mode å¯¹åº”çš„å¤„ç†</p>
<ul>
<li>0x1: ASICæµ‹è¯•æ•°æ®è¯»å–</li>
<li>0x2: è¿›å…¥æŒ‰é”®æµ‹è¯•</li>
<li>0x3: è¿›å…¥èœ‚é¸£å™¨æµ‹è¯•</li>
<li>0x4: è¿›å…¥ç¯å…‰æ¿æµ‹è¯•</li>
<li>0x5: æŠ•å¸æµ‹è¯•</li>
<li>0x7: åŠ è½½ IGS LOGO</li>
<li>0x8: åŠ è½½ Teammark æ•°æ®</li>
<li>0xC: ä»£ç å·²åˆ é™¤</li>
<li>0xE: ä»£ç å·²åˆ é™¤</li>
<li>0xF: ä»£ç å·²åˆ é™¤</li>
<li>0x10: Song</li>
<li>0x13: ä»£ç å·²åˆ é™¤</li>
<li>0x14: ä»£ç å·²åˆ é™¤</li>
<li>0x1a: CCD ä¿¡æ¯</li>
</ul>
<p>å…¶ä»–å€¼åˆ™è§¦å‘ Assert</p>
<h3 id="æŒ‰é”®çŠ¶æ€æœº">æŒ‰é”®çŠ¶æ€æœº</h3>
<pre tabindex="0"><code>                press
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  release    â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”
   â”‚   Idle   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚Releasedâ”‚
   â”‚   (0)    â”‚             â”‚   (3)  â”‚
   â””â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”˜             â””â”€â”€â–²â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚
        â”‚ press                â”‚ release
        â”‚                      â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” long press  â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”
   â”‚ Pressed  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚Holding â”‚
   â”‚   (1)    â”‚             â”‚  (2)   â”‚ keep holding, counter++
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><h3 id="buffer-ç»“æ„ä½“åˆ†æ">Buffer ç»“æ„ä½“åˆ†æ</h3>
<p>Buffer çš„æœ€å¤§é•¿åº¦æ˜¯ 8192</p>
<p>Buffer å“åº”çš„ Header æ ¼å¼å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">g_rBufferRead</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">_dwBufferSize</span><span class="p">;</span> <span class="c1">// æ•°æ®å¤§å°
</span></span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">system_mode</span><span class="p">;</span>   <span class="c1">// ç³»ç»Ÿæ¨¡å¼
</span></span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">coin_inserted</span><span class="p">;</span> <span class="c1">// æŠ•å¸äº†
</span></span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">a27_error_flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">short</span>  <span class="n">error_number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">key_io_list</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">int8</span>   <span class="n">key_channels</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">pc0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">pc1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">int16</span>  <span class="n">area_code</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">int16</span>  <span class="n">padding_1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">in_rom_version_name</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">ext_rom_version_name</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">int16</span>  <span class="n">inet_password_data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">int16</span>  <span class="n">a27_has_message</span><span class="p">;</span> <span class="c1">// å†³å®š a27_message æ˜¯å¦æºå¸¦æ•°æ®
</span></span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">is_light_io_reset</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">pci_card_version</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">bCheckSum1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">bCheckSum2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">a27_message</span><span class="p">[</span><span class="mi">40</span><span class="p">];</span> 
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">asic27_buffer</span><span class="p">[</span><span class="n">unknown</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Buffer è¯·æ±‚çš„ Header æ ¼å¼å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">g_rBufferWrite</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">_dwBufferSize</span><span class="p">;</span> <span class="c1">// æ•°æ®å¤§å°
</span></span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">system_mode</span><span class="p">;</span>   <span class="c1">// ç³»ç»Ÿæ¨¡å¼
</span></span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">key_input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">int16</span>  <span class="n">trackball_data</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">bCheckSum1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">bCheckSum2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">lightdisable</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">key_sensitivity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">lightstate</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span>    <span class="n">lightpattern</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span>   <span class="n">data</span><span class="p">[</span><span class="n">unknown</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="a27-response-checksum">A27 Response Checksum</h3>
<p>ASIC 27 å“åº”ä¹Ÿä¼šæºå¸¦ Checksumï¼Œæ¸¸æˆä¸»ç¨‹åºä¼šéªŒè¯ã€‚è®¡ç®—æ–¹å¼ä¸ºä»¥ä¸‹æ•°æ®çš„ç´¯åŠ </p>
<p>a27_has_message + inet_password_data + rd_is_light_io_reset + error_number + asic27_error + coin_inserted + system_mode[0] + buffer_size</p>
<h3 id="buffer-æ··æ·†åˆ†æ">Buffer æ··æ·†åˆ†æ</h3>
<p>Percussion Master 2008å¯¹æ¯”æ—§ç‰ˆæœ¬ï¼Œå¢åŠ äº†ç®€æ˜“æ··æ·†ï¼Œç›®çš„æ˜¯åç›—ç‰ˆï¼Œé¿å…æ‹·è´ROMç›´æ¥è¿è¡Œã€‚å½“ä»ç¼“å†²åŒºæ‹·è´åˆ° ASIC 27 bufferæ—¶ï¼Œæ•°æ®å°±ä¼šè¢«æ··æ·†å¤„ç†ã€‚</p>
<p>æ··æ·†çš„å‰ææ¡ä»¶æ˜¯ System Mode ç¬¦åˆä¸‹åˆ—å€¼æ‰ä¼šè§¦å‘ï¼Œåˆšå¥½è¿™äº› mode çš„æ•°æ®éƒ½æ²¡æœ‰è¢«WriteçŠ¶æ€æœºé¢„å¤„ç†ã€‚</p>
<ul>
<li>0x7: SelModeï¼ŒIGS Logo</li>
<li>0x8: Teammark</li>
<li>0xc: Coin Page</li>
<li>0xd:</li>
<li>0xe:</li>
<li>0xf: Option</li>
<li>0x13:</li>
<li>0x14: Photo</li>
<li>0x15:</li>
</ul>
<p>æ··æ·†é˜¶æ®µï¼Œç¨‹åºæŠŠ asic27_buffer çš„æ•°æ®å¤åˆ¶åˆ° destã€‚ç”¨ dest ä½œä¸ºæºï¼Œåˆ†å—å¤„ç†ï¼Œæ¯å—å¤§å°æ˜¯ 0x500 = 1280 å­—èŠ‚ã€‚å–æ•°æ®å—ï¼Œç”¨å—å¤´ 4 å­—èŠ‚ + mask_table è®¡ç®—æ‰°åŠ¨å€¼ï¼Œæ ¹æ®æ‰°åŠ¨å€¼å¯¹å—æ•°æ®åšå¾ªç¯é‡æ’ï¼Œæœ€ç»ˆå†™å›ç¼“å†²åŒºã€‚</p>
<pre tabindex="0"><code>v3 = mask_table[v1[0]];
v3 ^= mask_table[v1[1]];
v3 ^= mask_table[v1[2]];
v3 ^= mask_table[v1[3]];
</code></pre><p>ç”¨ v3 ç®—ä¸€ä¸ªåç§»é‡ï¼Œå¦‚æœå‰©ä½™æ•°æ®ä¸è¶³ 0x500ï¼Œåˆ™ v3 % (å‰©ä½™é•¿åº¦-4) + 4ï¼›å¦åˆ™å›ºå®š % 0x4FC + 4ï¼Œä¿è¯åç§»èŒƒå›´åœ¨ [4, 0x4FF]ã€‚</p>
<p>å…ˆæŠŠ [v3, end] æ‹·è´åˆ°ç›®æ ‡ï¼Œå†æŠŠ [4, v3) æ‹·è´è¿‡å»ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªâ€œæ—‹è½¬è¿‡â€çš„å—ï¼Œå‰ 4 å­—èŠ‚ï¼ˆheaderï¼‰æœ¬èº«ä¸æŒ‰é¡ºåºå¤åˆ¶ï¼Œè€Œæ˜¯è¢«è·³è¿‡+é‡æ–°æ‹¼æ¥ã€‚</p>
<p>è®© AI å†™äº†ä¸€ä¸ª python çš„ä»£ç å®ç°ã€‚</p>
<pre tabindex="0"><code>import random

# size: 0x400
mask_table = [0x00, 0x00, 0x00, 0x00, 0x39, 0x4E, 0xC1, 0xE6, 0x02, 0x19, 0xB1, 0xB9, 0x63, 0xCB, 0xC7, 0x9E, 0xE4, 0xCD, 0x76, 0xE7, 0x23, 0x8D, 0xB3, 0x6B, 0x3F, 0xDA, 0x89, 0xF5, 0x4D, 0xCB, 0x56, 0xB5, 0xD3, 0xA9, 0xBC, 0x2E, 0xA0, 0xE0, 0x80, 0xD6, 0x92, 0x62, 0xDE, 0xC9, 0xFD, 0x24, 0x04, 0x06, 0x4B, 0x70, 0xB2, 0x21, 0x26, 0xD1, 0xB1, 0xAF, 0xA0, 0x29, 0x29, 0x9D, 0x0C, 0x5E, 0x59, 0x09, 0xA2, 0xC9, 0xF3, 0x67, 0x4F, 0xE6, 0xCD, 0x6E, 0xF3, 0x97, 0xF1, 0xF9, 0xD1, 0xE1, 0xCD, 0x26, 0x62, 0x0D, 0xF4, 0x7A, 0x72, 0x98, 0x3C, 0x9B, 0xE2, 0x43, 0xCE, 0x54, 0xF4, 0x44, 0xE9, 0xF5, 0x22, 0xC4, 0x3F, 0xD0, 0x38, 0x5F, 0x96, 0xAD, 0x05, 0xB7, 0x18, 0x47, 0xFE, 0x00, 0x14, 0xED, 0x5B, 0x75, 0x3B, 0xF2, 0x08, 0xA2, 0x44, 0x1E, 0xE5, 0x59, 0x68, 0x4A, 0x36, 0x9E, 0xF6, 0x87, 0x74, 0xAA, 0x70, 0x68, 0x6A, 0x1B, 0xED, 0x84, 0xE9, 0xB2, 0x35, 0xC5, 0x54, 0x83, 0xE8, 0x5B, 0x05, 0xD9, 0x77, 0x9A, 0xD6, 0x20, 0xD9, 0x48, 0xA9, 0x59, 0x18, 0x40, 0xB1, 0x5A, 0x81, 0xC1, 0x96, 0x7B, 0xC7, 0x1F, 0xD5, 0x5A, 0xB1, 0x01, 0x9E, 0xA8, 0x67, 0x52, 0xF4, 0x7A, 0x39, 0x51, 0x80, 0x18, 0xC9, 0x61, 0xEE, 0x01, 0xEC, 0x19, 0x2F, 0x25, 0xBC, 0x74, 0x85, 0x6A, 0x99, 0x92, 0x6A, 0x28, 0x13, 0xF6, 0x9A, 0xED, 0x02, 0x26, 0xF4, 0x69, 0x9F, 0x1E, 0xED, 0xC3, 0x18, 0x0E, 0xBD, 0x32, 0x1F, 0x47, 0x4F, 0x55, 0x8B, 0x91, 0x75, 0xEC, 0x66, 0xC8, 0x83, 0xED, 0x2E, 0x1B, 0x0F, 0xB0, 0x65, 0xEC, 0x87, 0xD3, 0xE0, 0xE2, 0x2B, 0x16, 0xCB, 0x0A, 0x0F, 0x70, 0x64, 0x52, 0xBA, 0x38, 0x6B, 0x5C, 0xEA, 0xFD, 0xA9, 0xB1, 0x8D, 0x8F, 0x26, 0x4B, 0xD9, 0xD3, 0x40, 0x4A, 0x66, 0x33, 0xBB, 0x01, 0xCE, 0x3C, 0x3C, 0x56, 0x14, 0xAE, 0xFD, 0x05, 0x7A, 0x8F, 0x4D, 0x4D, 0x79, 0x29, 0xCC, 0x81, 0xCD, 0x07, 0x43, 0x68, 0x57, 0x0C, 0xDA, 0xDE, 0x79, 0x1D, 0xE0, 0x01, 0x8D, 0x91, 0x17, 0x55, 0x4F, 0xF8, 0x25, 0x60, 0xCE, 0x11, 0x34, 0x3F, 0x3F, 0x03, 0xA3, 0xEF, 0xFA, 0xF5, 0x13, 0xE5, 0xEA, 0x75, 0x6A, 0xD7, 0xE1, 0x65, 0x94, 0x90, 0x42, 0xC9, 0x1D, 0x7F, 0x66, 0xDB, 0x68, 0xB8, 0x18, 0x18, 0x8B, 0x22, 0x49, 0x70, 0x71, 0x88, 0x2D, 0xD9, 0x96, 0x29, 0x4B, 0xAC, 0x7F, 0x58, 0x50, 0x57, 0x0F, 0xDC, 0x4D, 0xB9, 0x53, 0x81, 0x65, 0xD9, 0xB7, 0x85, 0x10, 0xF0, 0xCE, 0x4B, 0x2B, 0xAA, 0x7F, 0x7C, 0x75, 0xBA, 0xB2, 0x01, 0x64, 0x13, 0x07, 0x0A, 0x5E, 0x3F, 0xEF, 0xFA, 0x00, 0x8B, 0x31, 0x89, 0x6A, 0xE9, 0x17, 0x81, 0xC1, 0x4D, 0xEE, 0x31, 0x8C, 0xF0, 0x3A, 0xFD, 0x77, 0x90, 0xDF, 0x7C, 0x83, 0xDF, 0xF9, 0x99, 0xE4, 0xC0, 0xE5, 0x82, 0x22, 0xBD, 0x46, 0xBC, 0xF8, 0x23, 0xE1, 0xDD, 0x48, 0xF3, 0xE1, 0xB0, 0x66, 0x13, 0x93, 0x85, 0xB8, 0xEC, 0x9B, 0xCE, 0x0C, 0xEA, 0xDD, 0x14, 0x42, 0xDF, 0x45, 0x50, 0xAE, 0xC0, 0x60, 0xB2, 0xB7, 0x16, 0xB1, 0xAD, 0x2A, 0x2E, 0x1D, 0xC8, 0xE8, 0xE9, 0xAF, 0x0F, 0x44, 0x5D, 0xC5, 0x80, 0xA6, 0xB2, 0x01, 0xCF, 0xDB, 0x96, 0x49, 0x52, 0xC2, 0xBA, 0x97, 0x36, 0xB0, 0x33, 0x59, 0x88, 0x1D, 0x5A, 0x22, 0xAD, 0xA5, 0x9C, 0xD7, 0x5B, 0x59, 0xCA, 0x83, 0x7D, 0x7B, 0xFA, 0x84, 0x22, 0x65, 0x64, 0x7C, 0xDF, 0xF3, 0xA6, 0x41, 0x49, 0x14, 0x81, 0xED, 0x3B, 0x0C, 0x0A, 0xDF, 0xF6, 0x35, 0x79, 0x98, 0xDC, 0x6A, 0x5D, 0x0E, 0x94, 0x8B, 0x87, 0x5D, 0x0A, 0xEC, 0xFA, 0xC1, 0x6C, 0xE5, 0x01, 0xFD, 0x1E, 0x54, 0x29, 0xB7, 0xC6, 0x26, 0x33, 0x49, 0x60, 0x92, 0x44, 0xD2, 0x0C, 0x1E, 0x84, 0x03, 0x2B, 0x67, 0x82, 0xC3, 0x75, 0x7E, 0x2E, 0x2B, 0xC6, 0x96, 0x6E, 0x8A, 0x5D, 0x27, 0x7A, 0x62, 0x8C, 0xFE, 0x00, 0xCA, 0xFB, 0xFA, 0xD0, 0x9A, 0xB4, 0x60, 0xD1, 0x52, 0xC8, 0xB8, 0x7A, 0x83, 0xA9, 0xAE, 0x2A, 0x14, 0xFE, 0x33, 0xB1, 0x0F, 0xA2, 0x89, 0x25, 0xC1, 0xD5, 0x3A, 0xDE, 0xED, 0x09, 0xE1, 0x49, 0x4A, 0xD7, 0x9F, 0x49, 0xF1, 0x28, 0x88, 0xD1, 0x50, 0x2C, 0x24, 0x4C, 0x09, 0x36, 0x3F, 0x15, 0xD3, 0x1D, 0xA8, 0x1F, 0xE8, 0xAD, 0xC5, 0x5F, 0x95, 0x04, 0xFE, 0x2C, 0x6E, 0xB6, 0x0E, 0xF6, 0x47, 0x4A, 0xF6, 0xAC, 0x5C, 0xBA, 0xD9, 0x35, 0xEA, 0x27, 0x41, 0xF8, 0x84, 0xF2, 0xF8, 0x74, 0x2F, 0xE4, 0xEF, 0x69, 0xC6, 0xC7, 0x4B, 0xEC, 0xD7, 0xEB, 0x83, 0x47, 0xE3, 0x82, 0x74, 0x06, 0xD2, 0x64, 0x1D, 0xEB, 0xCD, 0x7C, 0x74, 0xFC, 0xF2, 0xC9, 0x3F, 0x90, 0x14, 0xDE, 0x1B, 0x25, 0xF8, 0x52, 0xE8, 0x9D, 0xB9, 0x11, 0x0A, 0xEC, 0xA5, 0x59, 0xEA, 0x5C, 0x7E, 0x7D, 0x33, 0x79, 0xEA, 0x26, 0xF6, 0x06, 0x23, 0x4D, 0x67, 0x26, 0x88, 0x12, 0xFE, 0x13, 0x9A, 0xE9, 0x66, 0x5A, 0x4F, 0x67, 0xB1, 0xBD, 0xA2, 0x89, 0x02, 0x40, 0x01, 0x7E, 0xF2, 0x4D, 0x0E, 0x98, 0x2C, 0x40, 0x8F, 0x8F, 0x90, 0x1B, 0x9F, 0x4D, 0x84, 0xB3, 0x9A, 0x03, 0x6E, 0x71, 0x24, 0x03, 0xFC, 0xD3, 0x23, 0x14, 0x3C, 0xA8, 0x90, 0x11, 0x54, 0x07, 0xDA, 0x3A, 0xDB, 0x19, 0x94, 0xC2, 0x6E, 0x7A, 0x92, 0x9F, 0x0C, 0x0C, 0x0F, 0x7D, 0xFA, 0xA4, 0x3A, 0x9B, 0xA0, 0xBB, 0xC4, 0x5C, 0xDA, 0xCE, 0x74, 0x78, 0x88, 0x8E, 0x83, 0xD8, 0xEE, 0x21, 0x31, 0x9E, 0x75, 0xC0, 0x2E, 0x2B, 0xE9, 0x17, 0x31, 0x46, 0x39, 0xD8, 0x85, 0xBC, 0xA9, 0xF8, 0x57, 0xCA, 0xA3, 0xE0, 0x59, 0xC5, 0xF2, 0x0D, 0x52, 0x73, 0x95, 0x40, 0x7C, 0xAF, 0xB2, 0xAF, 0x14, 0x99, 0xD1, 0x62, 0xCE, 0xB3, 0xAD, 0x17, 0x5E, 0x95, 0x26, 0x8F, 0xF0, 0x2A, 0x92, 0xBF, 0xF1, 0xA1, 0x77, 0xE0, 0xF4, 0x6D, 0x62, 0xCF, 0xCE, 0x15, 0x74, 0xFD, 0x7A, 0xA5, 0xD0, 0x90, 0x75, 0x4B, 0xFE, 0xE0, 0x63, 0x5A, 0xBA, 0x8B, 0x09, 0x8B, 0xE6, 0x12, 0x71, 0xB7, 0xD4, 0xD9, 0x29, 0x1E, 0xFD, 0xEB, 0x93, 0x14, 0x0D, 0xD4, 0xA7, 0x5F, 0x04, 0x85, 0x7D, 0xDA, 0x26, 0xE4, 0x63, 0x94, 0xEC, 0x49, 0x0D, 0x21, 0xF1, 0x42, 0x20, 0x18, 0x66, 0x9F, 0xF6, 0x64, 0x5F, 0x57, 0xCE, 0x33, 0x43, 0xB2, 0x38, 0xFA, 0xF0, 0x5C, 0x1D, 0x4F, 0x65, 0xE8, 0x85, 0x1E, 0xC6, 0x9B, 0xDF, 0x85, 0x9B, 0x9D, 0xAD, 0x17, 0x81, 0x7C, 0xD5, 0x5C, 0xA8, 0xF8, 0x81, 0x40, 0x13, 0x38, 0xF0, 0x00, 0x5B, 0x73, 0xD3, 0xF0, 0x2D, 0x38, 0x00, 0xD7, 0x87, 0x47, 0x82, 0x81, 0xAF, 0xA5, 0xC8, 0x2D, 0x0C, 0xCC, 0x52, 0x2C, 0x5A, 0x09, 0x07, 0x38, 0xAB, 0x4D, 0x01, 0x4B, 0x11, 0x8C, 0xAF, 0x63, 0x25, 0x00, 0x82, 0x25, 0xA2, 0x77, 0x71, 0x07, 0x7B, 0x71, 0x95, 0x14, 0xD1, 0x23, 0x3D, 0x6C, 0x4E, 0xD7, 0x0C, 0x61, 0x7D, 0xFA, 0xC6, 0xCB, 0x6F, 0x6C, 0x97, 0x65, 0x57, 0x23, 0xEB, 0x7E, 0xCF, 0x89, 0x37, 0x69, 0x52, 0x19, 0x7F, 0xED, 0x1F, 0x96, 0xAD, 0xC6, 0x3C, 0x04, 0x31, 0x42, 0x31, 0xCD, 0xBB, 0xB5, 0xD9, 0x5D, 0xF2, 0xE5, 0xF4, 0x77, 0x21, 0xAF, 0xE8, 0x3E, 0xA5, 0x20, 0x2B, 0xFC, 0xE1, 0xDC, 0x5A, 0x2F, 0xEA, 0x5B, 0x85, 0x96, 0xBA, 0x97, 0xE1, 0x48, 0xA1, 0xC0]

BLOCK_SIZE = 0x500

def obfuscate_block(block: bytes) -&gt; bytes:
    &#34;&#34;&#34;æ··æ·†å•ä¸ª 0x500 å¤§å°çš„æ•°æ®å—&#34;&#34;&#34;
    if len(block) &lt; 4:
        return block

    block_header = block[:4]

    obfs_value = mask_table[block_header[0]]
    for i in range(1, 4):
        obfs_value ^= mask_table[block_header[i]]

    # è®¡ç®—åç§»é‡ï¼ˆèŒƒå›´ 4 ~ 0x4FFï¼‰
    obfs_value = obfs_value % 0x4FC + 4

    # æ•°æ®é‡æ’ï¼š
    #   [obfs_value:end] + [4:obfs_value]
    part1 = block[obfs_value:]       # ä» obfs_value å¼€å§‹åˆ°ç»“å°¾
    part2 = block[4:obfs_value]      # ä» 4 åˆ° obfs_value
    new_block = part1 + part2
    return new_block


def deobfuscate_block(block: bytes, header: bytes) -&gt; bytes:
    &#34;&#34;&#34;åæ··æ·†å•ä¸ª 0x500 æ•°æ®å—ï¼Œéœ€è¦åŸå§‹ header&#34;&#34;&#34;
    if len(block) &lt; 4:
        return block

    # é‡æ–°è®¡ç®—æ‰°åŠ¨å€¼ï¼ˆå¿…é¡»ç”¨åŸå§‹ headerï¼‰
    obfs_value = mask_table[header[0]]
    for i in range(1, 4):
        obfs_value ^= mask_table[header[i]]
    obfs_value = obfs_value % 0x4FC + 4

    # block çš„æ’åˆ—è§„åˆ™æ˜¯ï¼š
    #   new_block = block[obfs_value:] + block[4:obfs_value]
    # æˆ‘ä»¬è¦åè¿‡æ¥æ‹¼å›åŸå§‹
    part1_len = len(block) - (obfs_value - 4)  # å¯¹åº” obfs_value ~ end
    part1 = block[:part1_len]
    part2 = block[part1_len:]

    # æ¢å¤æˆ [0:4] + [4:obfs_value] + [obfs_value:end]
    original = header + part2 + part1
    return original


def obfuscate(data: bytes) -&gt; bytes:
    out = bytearray()
    for i in range(0, len(data), BLOCK_SIZE):
        block = data[i:i+BLOCK_SIZE]
        out.extend(obfuscate_block(block))
    return bytes(out)


def deobfuscate(data: bytes, headers: list[bytes]) -&gt; bytes:
    out = bytearray()
    for idx, i in enumerate(range(0, len(data), BLOCK_SIZE)):
        block = data[i:i+BLOCK_SIZE]
        header = headers[idx]
        out.extend(deobfuscate_block(block, header))
    return bytes(out)


if __name__ == &#34;__main__&#34;:
    data = bytearray()
    headers = []
    for blk in range(3):
        header = bytes([blk, blk+1, blk+2, blk+3])
        headers.append(header)
        body = bytes([blk]* (BLOCK_SIZE - 4))
        data.extend(header + body)

    print(&#34;åŸå§‹æ•°æ®å‰ 32 å­—èŠ‚:&#34;, data[:32])

    obfs = obfuscate(data)
    print(&#34;æ··æ·†åå‰ 32 å­—èŠ‚:&#34;, obfs[:32])

    deobfs = deobfuscate(obfs, headers)
    print(&#34;åæ··æ·†å‰ 32 å­—èŠ‚:&#34;, deobfs[:32])
    print(&#34;åæ··æ·†æ˜¯å¦æ­£ç¡®:&#34;, deobfs == data)
</code></pre><h2 id="tsgrom-è§£æ">TSGROM è§£æ</h2>
<p>TSGROMæ˜¯æ¸¸æˆå¤šåª’ä½“èµ„æºæ–‡ä»¶ï¼Œæœ‰è„šæœ¬ã€è´´å›¾ã€‚ç±»ä¼¼ unity çš„ assetsã€‚</p>
<p>PM2008 çš„ TSGROM ç‰ˆæœ¬æ”¯æŒä¸ä½äº 00.0000.0004ï¼Œå’ŒPM1ä¸€è‡´ã€‚ä»£ç å†™çš„ç®€å•ç²—æš´ï¼Œå…¨æ˜¯while(1)ã€‚</p>
<p><img loading="lazy"  src="tsgrom_parse.png"
        alt="tsgrom_parse"/></p>
<p>ä¹Ÿæœ‰ä¸€äº› rom æ²¡æœ‰æºå¸¦ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸çŸ¥é“æœ‰ä»€ä¹ˆä½œç”¨ï¼Œæ¯”å¦‚biglogo.romï¼Œæœ‰å¤§é‡LZSSå›¾ç‰‡æ•°æ®ï¼Œä½†æ˜¯å’Œä»£ç é‡Œçš„é¢œè‰²æ ¼å¼å¯¹ä¸ä¸Šï¼Œåº”è¯¥æ˜¯å†å²é—ç•™ã€‚</p>
<p><img loading="lazy"  src="biglogo.png"
        alt="biglogo"/></p>
<p>TSGROM æ—¢å¯ä»¥ä»æ–‡ä»¶åŠ è½½ã€ä¹Ÿå¯ä»¥ä»RAMåŠ è½½ã€‚ç¬¬ä¸€æ¬¡åŠ è½½åï¼Œå°±ä¼šå­˜åˆ°RAMï¼Œåç»­å°±ä¸ç”¨å†æ“ä½œæ–‡ä»¶äº†ã€‚</p>
<p>PM2008æ”¯æŒ TGAã€BPMã€PCXçš„å›¾å½¢æ–‡ä»¶ï¼ŒTSGROM æ ¼å¼åˆè‡­åˆé•¿éå¸¸æ— èŠï¼Œæ²¡å¿…è¦å±•å¼€åˆ†æï¼Œæˆ‘å¼€å‘äº†è§£æTSGROMçš„è„šæœ¬ <a href="https://github.com/gorgiaxx/igs-toolkits/tree/master/tsgrom_loader"target="_blank" rel="noopener noreferrer">igs-toolkits tsgrom_loader</a></p>
<pre tabindex="0"><code>(base) âœ  tsgrom_loader git:(master) âœ— python ./tsgrom_loader.py -f ./test/resultl.rom -o ./test/resultl --format png
TSGROM Header:
  Header: TSGROM01
  Version: 00.0000.0004
  Length: 0
  Data Zones: 2276
  Data Type Counts:
       SOUND: 1
    ACTBLOCK: 531
    ACTINDEX: 1
    ACT_DATA: 60
    ACT_POOL: 531
    ACT_STEP: 975
    BASEDATA: 1
    BMP_OPSS: 18
    MTV_INAC: 1
    PALETTE1: 1
    TGA_OPSS: 156
Found 174 image data zones
</code></pre><p>ä»¥ IGS Logo ä¸ºä¾‹ï¼Œè§£å‹åæœ‰åŠ¨ç”»çš„æ¯ä¸€å¸§çš„å›¾ç‰‡</p>
<p><img loading="lazy"  src="tsgrom_extracted.png"
        alt="tsgrom_extracted"/></p>
<h3 id="action-parser">Action Parser</h3>
<p>IGS çš„ TSGROM å®šä¹‰äº†æ¸¸æˆçš„å„ç§å›¾å½¢è¡Œä¸ºï¼Œå¹¶ç§°ä¹‹ä¸º actionï¼Œä¸»ç¨‹åºé€šè¿‡è§£æ action æ¥å®ç°åŠŸèƒ½ã€‚å¦‚æœè¦åœ¨PCè¿è¡Œæ¸¸æˆä¸»ç¨‹åºï¼Œæ¸¸æˆçš„å„ç§äº‹ä»¶éƒ½å’ŒA27åè®®æœ‰å…³ï¼Œéœ€è¦é€†å‘åˆ†æå¯¹åº”Actionï¼Œä½†æ˜¯æˆ‘æƒ³å°è¯•æœ€å®Œç¾çš„ç ´è§£æ–¹å¼ï¼Œdump ASIC ROM æ”¾åˆ°æ¨¡æ‹Ÿå™¨è¿è¡Œï¼Œä¸æƒ³åˆ†æè¿™ç§å±å±±ä»£ç ã€‚</p>
<ul>
<li>ACT BLOCK   æ•°æ®å—æ•°é‡</li>
<li>ACT INDEX   ACT ç´¢å¼•</li>
<li>ACT DATA    Action æ•°æ®</li>
<li>ACT POOL    Action æ•°æ®</li>
<li>ACT STEP    åŠ¨ä½œå¸§</li>
</ul>
<p>ä¸»ç¨‹åºæ˜¯ç¬¦å·å‰¥ç¦»çš„ï¼Œåˆ†æèµ·æ¥å¾ˆè´¹æ—¶é—´ï¼Œç®€å•è®°å½•ä¸€ä¸‹ï¼š</p>
<p>åœ¨åŠ è½½ TSGROM æ—¶ï¼Œç¨‹åºä¼šåŠ è½½ act_data åˆ°å†…å­˜ï¼Œæ ¹æ® act_pool çš„çš„æ•°é‡ï¼Œå°† pool data ä¹ŸåŠ è½½åˆ°å†…å­˜; æ¯ä¸ª TSGROM ä¼šè¢«åˆ†é…ç‹¬ç«‹çš„ Group IDã€‚Action ç³»åˆ—çš„å‡½æ•°ï¼Œéƒ½æ˜¯æ ¹æ® Group ID æ¥åŒºåˆ†ã€‚æœ€å¤š 0x80 ä¸ª action groupï¼Œæ¯ä¸ª Group é•¿åº¦ 0x2AA4ã€‚æ¯ä¸ª Group è¿˜æœ‰å¯¹åº”çš„ indexï¼Œaction index å¤§å° 0xaa9, åˆ—è¡¨é•¿åº¦ä¹Ÿæ˜¯ 0x80ã€‚</p>
<p>åœ¨åŠ è½½ tsgrom ä¹‹å‰ï¼Œé¦–å…ˆåˆ›å»º action å¯¹è±¡ï¼Œæ€»å…± 1024 ä¸ª action_dataï¼Œæ¯ä¸ª action_data é•¿åº¦ 0x8D å­—èŠ‚ã€‚
æ¥ç€è°ƒç”¨ ActionUse åˆå§‹åŒ– act_dataï¼Œå¹¶ä¸”åˆ†é…å›¾å½¢æ˜¾ç¤ºèµ„æºï¼Œç”¨ ActionFace, ActionShow ç­‰é…ç½®æ§åˆ¶å›¾å½¢æ˜¾ç¤ºï¼Œæœ€åè°ƒç”¨<code>RealTimeEvent</code>ç»Ÿä¸€åˆ·æ–°ç”»é¢ã€‚</p>
<p><img loading="lazy"  src="actions.png"
        alt="actions"/></p>
<h3 id="tsg-rom-æš—æ¡©">TSG ROM æš—æ¡©</h3>
<p>IGS æ•…æ„æŸåäº†èµ„æºæ–‡ä»¶çš„æŸäº›æ•°æ®å—ï¼Œéœ€è¦é€šè¿‡ ASIC èŠ¯ç‰‡åŠ¨æ€ä¿®å¤ï¼Œè¿™ä¹Ÿæ˜¯ IGS çš„åç›—ç‰ˆæœºåˆ¶ï¼Œé˜²æ­¢ç ´è§£è€…ä¿®æ”¹åŠ¨ç”»æ–‡ä»¶å®ç°æ¢çš®æ¸¸æˆã€‚</p>
<p>IGS Logo</p>
<p><img loading="lazy"  src="tsgrom_extracted_broken.png"
        alt="tsgrom_extracted_broken"/></p>
<p>Teammark</p>
<p><img loading="lazy"  src="tsgrom_extracted_broken1.png"
        alt="tsgrom_extracted_broken1"/></p>
<p>ä»¥ IGS Logo ä¸ºä¾‹ï¼Œå½“ buffer çš„æ ‡è¯†æ•°åŒ¹é… 1 æ—¶ï¼Œä»£è¡¨æ•°æ®åŒ…ç±»å‹æ˜¯èµ„æºä¿®å¤ï¼Œå½“éå†åˆ°æŒ‡å®šçš„å—ï¼Œæ­¤å¤„æ˜¯7ï¼Œå°±å°†æ¥è‡ª ASIC 27 çš„ 0x400 å­—èŠ‚è¿½åŠ åˆ°å¯¹åº”çš„æŸååŒºåŸŸï¼Œå®Œæˆèµ„æºæ•°æ®ä¿®å¤ã€‚</p>
<p><img loading="lazy"  src="load_igslogolc_to_memory.png"
        alt="load_igslogolc_to_memory"/></p>
<h2 id="å†™åœ¨ç»“å°¾">å†™åœ¨ç»“å°¾</h2>
<p>IGSå°†æ¸¸æˆä¸»ç¨‹åºå’Œç¡¬ä»¶å¼ºå…³è”ï¼Œå¦‚æœè¦å°†æ¸¸æˆç›—ç‰ˆè‡³å…¶ä»–å¹³å°ï¼Œéœ€è¦ä»˜å‡ºéå¸¸å¤šçš„æ—¶é—´ã€‚</p>
<p>æ¸¸æˆæ¡†æ¶ã€æ­Œæ›²è°±é¢ï¼Œé€»è¾‘æ˜¯çŠ¶æ€æœºï¼Œæ¯”è¾ƒå¤æ‚ï¼Œä¸åœ¨æˆ‘çš„ç ´è§£ç›®æ ‡å†…ã€‚</p>
<p>æŠŠé€†å‘å·¥ç¨‹å†™åˆ°åšå®¢ï¼Œæ„Ÿè§‰èŠ±è´¹äº†æ›´å¤šçš„ç²¾åŠ›ï¼Œè‡ªå·±é€†å‘åªéœ€è¦è®°å½•ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯å½¢æˆæ–‡ç« ï¼Œå°±è¦å†™çš„è®©åˆ«äººçœ‹æ‡‚ã€‚</p>
<p>ä¸‹ä¸€ç¯‡ä¸»é¢˜ï¼šIGS Arcade é€†å‘ç³»åˆ—ï¼ˆäº”ï¼‰- ASIC27åè®®Hookå’Œä¸»ç¨‹åºpatchå·¥ä½œ</p>
<p>çºªå¿µè¡€æœˆï¼Œèµç¾å¥³ç¥</p>
</article><section class="article labels"><a class="category" href=/zh/categories/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/>é€†å‘å·¥ç¨‹</a><a class="tag" href=/zh/tags/igs/>IGS</a><a class="tag" href=/zh/tags/arcade/>Arcade</a><a class="tag" href=/zh/tags/crack/>Crack</a><a class="tag" href=/zh/tags/%E9%88%8A%E8%B1%A1%E7%94%B5%E5%AD%90/>éˆŠè±¡ç”µå­</a><a class="tag" href=/zh/tags/e2000/>E2000</a></section>
</div>

<div class="toc-wrapper">
    <div class="toc-content-box" id="toc-content-box">
        <div class="toc-header">ç›®å½•</div>
        <nav id="TableOfContents">
  <ol>
    <li><a href="#ä¸»ç¨‹åºæµç¨‹åˆ†æ">ä¸»ç¨‹åºæµç¨‹åˆ†æ</a>
      <ol>
        <li><a href="#åŒºåŸŸåˆå§‹åŒ–">åŒºåŸŸåˆå§‹åŒ–</a></li>
      </ol>
    </li>
    <li><a href="#roio-bios-ä¿¡æ¯æ ¡éªŒ">ROIO BIOS ä¿¡æ¯æ ¡éªŒ</a></li>
    <li><a href="#pccard-éšæœºæ•°æ ¡éªŒ">PCCard éšæœºæ•°æ ¡éªŒ</a></li>
    <li><a href="#asic-27-åè®®">ASIC 27 åè®®</a>
      <ol>
        <li><a href="#a27-åˆå§‹åŒ–">A27 åˆå§‹åŒ–</a></li>
        <li><a href="#system-mode">System Mode</a></li>
        <li><a href="#a27-system-mode-write-çŠ¶æ€æœº">A27 System Mode Write çŠ¶æ€æœº</a></li>
        <li><a href="#a27-system-mode-analysis-çŠ¶æ€æœº">A27 System Mode Analysis çŠ¶æ€æœº</a></li>
        <li><a href="#æŒ‰é”®çŠ¶æ€æœº">æŒ‰é”®çŠ¶æ€æœº</a></li>
        <li><a href="#buffer-ç»“æ„ä½“åˆ†æ">Buffer ç»“æ„ä½“åˆ†æ</a></li>
        <li><a href="#a27-response-checksum">A27 Response Checksum</a></li>
        <li><a href="#buffer-æ··æ·†åˆ†æ">Buffer æ··æ·†åˆ†æ</a></li>
      </ol>
    </li>
    <li><a href="#tsgrom-è§£æ">TSGROM è§£æ</a>
      <ol>
        <li><a href="#action-parser">Action Parser</a></li>
        <li><a href="#tsg-rom-æš—æ¡©">TSG ROM æš—æ¡©</a></li>
      </ol>
    </li>
    <li><a href="#å†™åœ¨ç»“å°¾">å†™åœ¨ç»“å°¾</a></li>
  </ol>
</nav>
    </div>
    <div class="toc-button" onclick="toggleTOC()" title="">
        
        <svg viewBox="0 0 24 24">
            <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"></path>
        </svg>
    </div>
</div>

<script>
    function toggleTOC() {
        const tocBox = document.getElementById('toc-content-box');
        if (tocBox.classList.contains('show')) {
            tocBox.classList.remove('show');
            
            
            
            
            
            setTimeout(() => {
                tocBox.style.display = 'none';
            }, 300); 
        } else {
            tocBox.style.display = 'block';
            
            void tocBox.offsetWidth;
            tocBox.classList.add('show');
        }
    }

    
    document.addEventListener('click', function (event) {
        const wrapper = document.querySelector('.toc-wrapper');
        const tocBox = document.getElementById('toc-content-box');
        if (wrapper && !wrapper.contains(event.target) && tocBox.classList.contains('show')) {
            toggleTOC();
        }
    });
</script><div class="article bottom"><section class="article navigation"><p><a class="link" href="/zh/posts/igs-arcade-re-3/"><span class="iconfont icon-article"></span>IGS Arcade é€†å‘ç³»åˆ—ï¼ˆä¸‰ï¼‰- Getshell</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2026 Gorgias' Blog. </p><p class="license">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">
            <img alt="CC BY-NC-SA" loading="lazy" src="/images/by-nc.svg" style="vertical-align: middle; height: 1.2em; margin: 0 0.2em;" />
            CC BY-NC-SA 4.0
        </a>
        (ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«).
    </p><p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>