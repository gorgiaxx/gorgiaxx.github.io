<!DOCTYPE html>
<html lang="zh"><meta charset="utf-8"><meta name="generator" content="Hugo 0.154.5"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="å‰è¨€
Scheme ç¼–ç¨‹è¯­è¨€æ˜¯ä¸€ç§Lispæ–¹è¨€ï¼Œè¯ç”Ÿäº1975å¹´ï¼Œç”± MIT çš„ Gerald J. Sussman å’Œ Guy L. Steele Jr. å®Œæˆã€‚å®ƒæ˜¯ç°ä»£ä¸¤å¤§Lispæ–¹è¨€ä¹‹ä¸€ï¼›å¦ä¸€ä¸ªæ–¹è¨€æ˜¯Common Lisp
å†å²æ‚ ä¹…çš„Schemeä¾ç„¶æ´»è·ƒï¼Œæ‹¥æœ‰é’ˆå¯¹å„ç§è®¡ç®—æœºå¹³å°å’Œç¯å¢ƒçš„å®ç°ï¼Œä¾‹å¦‚Racketã€Guileã€MIT Schemeã€Chez Schemeç­‰ã€‚
Tinyschemeæ˜¯ä¸€æ¬¾è½»é‡çº§åµŒå…¥å¼çš„Schemeè„šæœ¬è§£æå™¨ï¼Œä½¿ç”¨R5RS(Revised 5 Report on the algorithmic language Scheme)è¯­æ³•è§„èŒƒï¼Œè¿™ä¸ªè§„èŒƒåœ¨1998å¹´æ¨å‡ºï¼Œç°åœ¨å·²ç»è¢«å¹¿æ³›ä½¿ç”¨ã€‚
è™½ç„¶Tinyschemeæ²¡æœ‰è¯´æ˜æ–‡æ¡£ï¼Œä½†æ˜¯ä½¿ç”¨R5RSè§„èŒƒï¼Œå› æ­¤å…·ä½“çš„ç”¨æ³•å¯ä»¥å‚è€ƒå…¶ä»–ä¸»æµSchemeå®ç°ï¼Œæ¯”å¦‚Racket"><title>TinySchemeè¯»å†™æ–‡ä»¶&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.363cdd0e3e6340dd0e88b1f21887fb7e53e3129ed31d7f3cf62686d06069621ece79dc5ffb48a77ebba54468e667212f.css" integrity="sha384-NjzdDj5jQN0OiLHyGIf7flPjEp7THX889iaG0GBpYh7Oedxf&#43;0infrulRGjmZyEv"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="TinySchemeè¯»å†™æ–‡ä»¶" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/zh/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/zh/categories/">åˆ†ç±»</a><a class="nav item" href="/zh/tags/">æ ‡ç­¾</a><a class="nav item" href="/zh/about/">å…³äº</a><a class="nav item" href="/zh/links/">å‹é“¾</a><a class="nav item" href="/en/posts/tinyscheme-file-io/" title="English">
            <span class="lang-icon">ğŸŒ</span>English</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">TinySchemeè¯»å†™æ–‡ä»¶</h1><p class="article date">2018-10-21<span class="langs"><span class="lang">
                    <a href="/en/posts/tinyscheme-file-io/" title="English">
                        <span class="lang-icon">ğŸŒ</span>English</a>
                </span></span></p></section><article class="article markdown-body"><h2 id="å‰è¨€">å‰è¨€</h2>
<p>Scheme ç¼–ç¨‹è¯­è¨€æ˜¯ä¸€ç§Lispæ–¹è¨€ï¼Œè¯ç”Ÿäº1975å¹´ï¼Œç”± MIT çš„ Gerald J. Sussman å’Œ Guy L. Steele Jr. å®Œæˆã€‚å®ƒæ˜¯ç°ä»£ä¸¤å¤§Lispæ–¹è¨€ä¹‹ä¸€ï¼›å¦ä¸€ä¸ªæ–¹è¨€æ˜¯Common Lisp
å†å²æ‚ ä¹…çš„Schemeä¾ç„¶æ´»è·ƒï¼Œæ‹¥æœ‰é’ˆå¯¹å„ç§è®¡ç®—æœºå¹³å°å’Œç¯å¢ƒçš„å®ç°ï¼Œä¾‹å¦‚Racketã€Guileã€MIT Schemeã€Chez Schemeç­‰ã€‚
Tinyschemeæ˜¯ä¸€æ¬¾è½»é‡çº§åµŒå…¥å¼çš„Schemeè„šæœ¬è§£æå™¨ï¼Œä½¿ç”¨R5RS(Revised 5 Report on the algorithmic language Scheme)è¯­æ³•è§„èŒƒï¼Œè¿™ä¸ªè§„èŒƒåœ¨1998å¹´æ¨å‡ºï¼Œç°åœ¨å·²ç»è¢«å¹¿æ³›ä½¿ç”¨ã€‚
è™½ç„¶Tinyschemeæ²¡æœ‰è¯´æ˜æ–‡æ¡£ï¼Œä½†æ˜¯ä½¿ç”¨R5RSè§„èŒƒï¼Œå› æ­¤å…·ä½“çš„ç”¨æ³•å¯ä»¥å‚è€ƒå…¶ä»–ä¸»æµSchemeå®ç°ï¼Œæ¯”å¦‚<a href="https://docs.racket-lang.org/reference/index.html"target="_blank" rel="noopener noreferrer">Racket</a></p>
<h2 id="install">Install</h2>
<p>ä¸‹è½½åœ°å€</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://sourceforge.net/projects/tinyscheme/files/tinyscheme/
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ make all
</span></span><span class="line"><span class="cl">$ ./scheme
</span></span><span class="line"><span class="cl">TinyScheme 1.41
</span></span><span class="line"><span class="cl">ts&gt;
</span></span></code></pre></div><p>æ–‡ä»¶ç›®å½•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">â”œâ”€â”€ BUILDING
</span></span><span class="line"><span class="cl">â”œâ”€â”€ CHANGES
</span></span><span class="line"><span class="cl">â”œâ”€â”€ COPYING
</span></span><span class="line"><span class="cl">â”œâ”€â”€ dynload.c
</span></span><span class="line"><span class="cl">â”œâ”€â”€ dynload.h
</span></span><span class="line"><span class="cl">â”œâ”€â”€ hack.txt
</span></span><span class="line"><span class="cl">â”œâ”€â”€ init.scm
</span></span><span class="line"><span class="cl">â”œâ”€â”€ makefile
</span></span><span class="line"><span class="cl">â”œâ”€â”€ Manual.txt
</span></span><span class="line"><span class="cl">â”œâ”€â”€ MiniSCHEMETribute.txt
</span></span><span class="line"><span class="cl">â”œâ”€â”€ opdefines.h             å®šä¹‰äº†tinyschemeçš„ä¿ç•™å…³é”®å­—ï¼Œå¼€å‘è€…å¯ä»¥è‡ªå®šä¹‰æ–°çš„åŠŸèƒ½ã€‚
</span></span><span class="line"><span class="cl">â”œâ”€â”€ scheme.c                å®šä¹‰äº†å¦‚ä½•è§£æä»£ç 
</span></span><span class="line"><span class="cl">â”œâ”€â”€ scheme.h
</span></span><span class="line"><span class="cl">â””â”€â”€ scheme-private.h
</span></span></code></pre></div><h3 id="è¯»æ–‡ä»¶">è¯»æ–‡ä»¶</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-lisp" data-lang="lisp"><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">æ‰“å¼€æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">define</span> <span class="nf">shadow</span> <span class="p">(</span><span class="nv">open-input-file</span> <span class="s">&#34;/etc/shadow&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">è¯»å–æ–‡ä»¶ä¸€è¡Œå¹¶æ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nf">read</span> <span class="nf">shadow</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="å†™æ–‡ä»¶">å†™æ–‡ä»¶</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-lisp" data-lang="lisp"><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">æ‰“å¼€æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">define</span> <span class="nv">ou</span> <span class="p">(</span><span class="nv">open-output-file</span> <span class="s">&#34;/tmp/shadow&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">å®šä¹‰è¦å†™çš„å†…å®¹åˆ°å˜é‡</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">define</span> <span class="nv">text</span> <span class="s">&#34;root:aaddd.asdasd.:13333:0:99999:3:::&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">æ‰“å°å˜é‡</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">display</span> <span class="nv">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">æŠŠå˜é‡å€¼å†™åˆ°æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nf">write</span> <span class="nv">text</span> <span class="nv">ou</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">æŠŠå­—ç¬¦cå†™åˆ°æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nf">write-char</span> <span class="sc">#\c</span> <span class="nv">ou</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">åœ¨ouæœ«å°¾æ–°å¢ä¸€è¡Œ</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">newline</span> <span class="nv">ou</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nv">ä¿å­˜å¹¶å…³é—­æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">close-output-port</span> <span class="nv">ou</span><span class="p">)</span>
</span></span></code></pre></div><p>ç›´æ¥æŠŠå­—ç¬¦ä¸²å˜é‡å†™åˆ°æ–‡ä»¶ï¼Œä¼šå¸¦åŒå¼•å·ï¼Œå› æ­¤ä½¿ç”¨å­—ç¬¦é€ä¸ªå†™å…¥ï¼Œä¸€æ¬¡å†™å…¥å¤§é‡å­—ç¬¦å¯èƒ½ä¼šå‡ºç°å¤±è´¥ã€‚å¦å¤–å¦‚æœæ˜¯è¿œç¨‹tinyscheme shellï¼Œå•ä¸ªæ¢è¡Œå­—ç¬¦\nä¸èƒ½è¢«è¯†åˆ«ï¼Œå› æ­¤ä½¿ç”¨\newlineä»£æ›¿æ¢è¡Œç¬¦ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">argparse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">description</span><span class="o">=</span><span class="s2">&#34;Write file by tinyscheme&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;-l&#34;</span><span class="p">,</span> <span class="s2">&#34;--local-file&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&#34;directory to be read&#34;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;-t&#34;</span><span class="p">,</span> <span class="s2">&#34;--target-file&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&#34;directory to be write&#34;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">file_path</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">local_file</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(define ou (open-output-file </span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">args</span><span class="o">.</span><span class="n">target_file</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">))&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">raw</span> <span class="o">=</span> <span class="n">local_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="c1"># print(&#34;\n&#34;, end=&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(newline ou)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(write-char #</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34; ou)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">local_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(newline ou)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(close-output-port ou)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="reference">Reference</h2>
<p><a href="https://schemers.org/Documents/Standards/R5RS/"target="_blank" rel="noopener noreferrer">R5RS</a></p>
</article><section class="article labels"><a class="category" href=/zh/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/>ç½‘ç»œå®‰å…¨</a><a class="tag" href=/zh/tags/tinyscheme/>tinyscheme</a><a class="tag" href=/zh/tags/lisp/>Lisp</a><a class="tag" href=/zh/tags/r5rs/>R5Rs</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/zh/posts/visteon-firmware-repacking/"><span class="iconfont icon-article"></span>Visteonå›ºä»¶é‡æ‰“åŒ…</a></p><p><a class="link" href="/zh/posts/firmware-extraction-series-sd-card-unlock/"><span class="iconfont icon-article"></span>å›ºä»¶æå–ç³»åˆ— - SDå¡è§£é”</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2026 Gorgias' Blog. </p><p class="license">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">
            <img alt="CC BY-NC-SA" loading="lazy" src="/images/by-nc.svg" style="vertical-align: middle; height: 1.2em; margin: 0 0.2em;" />
            CC BY-NC-SA 4.0
        </a>
        (ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«).
    </p><p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>