<!DOCTYPE html>
<html lang="zh"><meta charset="utf-8"><meta name="generator" content="Hugo 0.154.5"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="Introduction
å­¦æ ¡çš„æ ¡å›­ç½‘å·²ç»æ­£å¼è¿è¥äº†ï¼Œä½†æ˜¯ç”¨æˆ·åå¯†ç è¿˜æ˜¯ä½¿ç”¨çš„é»˜è®¤å¯†ç ï¼Œèº«ä»½è¯å·åå…­ä½ï¼Œå¯¹äºå•ç‚¹ç™»å½•çš„å¹³å°æ¥è¯´ï¼Œæ˜¯éå¸¸å±é™©çš„ã€‚
æ¯”å¦‚æ­¦æ±‰å¤§å­¦çš„å­¦å·èƒ½åœ¨ç½‘ä¸Šçœ‹åˆ°ï¼Œå¯†ç æ˜¯èº«ä»½è¯åå…­ä½ï¼Œé‚£ä¹ˆç™»è¿›ä»–ä»¬çš„ä¸€å¡é€šç³»ç»Ÿå°±èƒ½ä½¿ç”¨å­¦ç”Ÿçš„é“¶è¡Œå¡è¿›è¡Œæ¶ˆè´¹ã€‚
åšä¸»æ‰€åœ¨çš„å­¦æ ¡ä½¿ç”¨çš„CASå®ç°SSOï¼Œçˆ†ç ´èµ·æ¥ä¸æ–¹ä¾¿ã€‚äºæ˜¯ä½¿ç”¨å¹³å°APPçš„æ¥å£çˆ†ç ´ã€‚"><title>å¼€å‘BurpSuiteæ‰©å±•çˆ†ç ´æŸå¹³å°&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.363cdd0e3e6340dd0e88b1f21887fb7e53e3129ed31d7f3cf62686d06069621ece79dc5ffb48a77ebba54468e667212f.css" integrity="sha384-NjzdDj5jQN0OiLHyGIf7flPjEp7THX889iaG0GBpYh7Oedxf&#43;0infrulRGjmZyEv"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="å¼€å‘BurpSuiteæ‰©å±•çˆ†ç ´æŸå¹³å°" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/zh/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/zh/categories/">åˆ†ç±»</a><a class="nav item" href="/zh/tags/">æ ‡ç­¾</a><a class="nav item" href="/zh/about/">å…³äº</a><a class="nav item" href="/zh/links/">å‹é“¾</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">å¼€å‘BurpSuiteæ‰©å±•çˆ†ç ´æŸå¹³å°</h1><p class="article date">2017-03-29<span class="langs"><span class="lang">
                    <a href="/en/posts/burpsuite-extension-for-bruteforcing-a-platform/" title="English">
                        <span class="lang-icon">ğŸŒ</span>English</a>
                </span></span></p></section><article class="article markdown-body"><h2 id="introduction">Introduction</h2>
<p>å­¦æ ¡çš„æ ¡å›­ç½‘å·²ç»æ­£å¼è¿è¥äº†ï¼Œä½†æ˜¯ç”¨æˆ·åå¯†ç è¿˜æ˜¯ä½¿ç”¨çš„é»˜è®¤å¯†ç ï¼Œèº«ä»½è¯å·åå…­ä½ï¼Œå¯¹äºå•ç‚¹ç™»å½•çš„å¹³å°æ¥è¯´ï¼Œæ˜¯éå¸¸å±é™©çš„ã€‚
æ¯”å¦‚æ­¦æ±‰å¤§å­¦çš„å­¦å·èƒ½åœ¨ç½‘ä¸Šçœ‹åˆ°ï¼Œå¯†ç æ˜¯èº«ä»½è¯åå…­ä½ï¼Œé‚£ä¹ˆç™»è¿›ä»–ä»¬çš„ä¸€å¡é€šç³»ç»Ÿå°±èƒ½ä½¿ç”¨å­¦ç”Ÿçš„é“¶è¡Œå¡è¿›è¡Œæ¶ˆè´¹ã€‚
åšä¸»æ‰€åœ¨çš„å­¦æ ¡ä½¿ç”¨çš„CASå®ç°SSOï¼Œçˆ†ç ´èµ·æ¥ä¸æ–¹ä¾¿ã€‚äºæ˜¯ä½¿ç”¨å¹³å°APPçš„æ¥å£çˆ†ç ´ã€‚</p>
<h2 id="prepare">Prepare</h2>
<p>Enviroment:</p>
<ul>
<li>OS: Arch Linux</li>
<li>Kernel: x86_64 Linux 4.9.8-1-ARCH</li>
<li>Shell: zsh 5.3.1</li>
<li>DE: KDE5</li>
<li>IDE: IntelliJIDEA 2016.1</li>
<li>JDK: 1.8.0_121</li>
<li>Build Tool: Gradle 3.3</li>
</ul>
<h2 id="å¿«é€Ÿå­¦ä¹ api">å¿«é€Ÿå­¦ä¹ API</h2>
<h3 id="éœ€è¦è¢«å®ç°çš„æ¥å£">éœ€è¦è¢«å®ç°çš„æ¥å£</h3>
<p><em>IBurpExtender</em>
æ‰€æœ‰æ‰©å±•å¿…é¡»å®ç°æ¬¡æ¥å£ï¼Œå¿…é¡»ç”³æ˜ä¸º public ,å¹¶ä¸”å¿…é¡»æä¾›ä¸€ä¸ªé»˜è®¤çš„æ„é€ å™¨ã€‚</p>
<blockquote>
<p>All extensions must implement this interface. Implementations must be called BurpExtender, in the package burp, must be declared public, and must provide a default (public, no-argument) constructor.</p>
</blockquote>
<p><em>IIntruderPayloadGeneratorFactory</em>
Payloadç”Ÿæˆå·¥å‚ï¼Œç”¨äºæä¾›payloadå®ä¾‹</p>
<blockquote>
<p>Extensions can implement this interface and then call IBurpExtenderCallbacks.registerIntruderPayloadGeneratorFactory() to register a factory for custom Intruder payloads.</p>
</blockquote>
<p><em>IIntruderPayloadProcessor</em>
Payloadå¤„ç†å™¨ï¼Œç”¨äºå¤„ç†ä¼ è¿›æ¥çš„å‚æ•°</p>
<blockquote>
<p>Extensions can implement this interface and then call IBurpExtenderCallbacks.registerIntruderPayloadProcessor() to register a custom Intruder payload processor.</p>
</blockquote>
<h3 id="ä¸€äº›å¸¸ç”¨çš„æ¥å£æˆ–è€…æ–¹æ³•">ä¸€äº›å¸¸ç”¨çš„æ¥å£æˆ–è€…æ–¹æ³•</h3>
<p><em>IExtensionHelpers</em>
è¯¥æ¥å£åŒ…å«è®¸å¤šå¸®åŠ©æ–¹æ³•ï¼Œå¯ç”¨äºååŠ©æ‰©å±•çš„å„ç§å¸¸è§ä»»åŠ¡ã€‚</p>
<blockquote>
<p>This interface contains a number of helper methods, which extensions can use to assist with various common tasks that arise for Burp extensions. Extensions can call IBurpExtenderCallbacks.getHelpers to obtain an instance of this interface.</p>
</blockquote>
<p><em>registerExtenderCallbacks</em>
æ­¤æ–¹æ³•å°†åœ¨æ‰©å±•åŠ è½½åè¢«è°ƒç”¨ï¼Œå®ƒæ³¨å†Œäº†ä¸€ä¸ª IBurpExtenderCallbacks æ¥å£çš„å®ä¾‹ï¼Œ IBurpExtenderCallbacks æ¥å£æä¾›äº†è®¸å¤šåœ¨å¼€å‘æ’ä»¶è¿‡ç¨‹ä¸­å¸¸ç”¨çš„ä¸€äº›æ“ä½œã€‚</p>
<blockquote>
<p>This method is invoked when the extension is loaded. It registers an instance of the IBurpExtenderCallbacks interface, providing methods that may be invoked by the extension to perform various actions.</p>
</blockquote>
<p><em>IIntruderPayloadGenerator</em>
æ­¤æ¥å£è¢«ç”¨äºè‡ªå®šä¹‰ Intruder å·¥å…·çš„ payload ç”Ÿæˆå™¨ã€‚å½“éœ€è¦å‘èµ·ä¸€æ¬¡æ–°çš„ Intruder æ”»å‡»æ—¶ï¼Œæ‰©å±•éœ€è¦æ³¨å†Œä¸€ä¸ª IIntruderPayloadGeneratorFactory å·¥å‚å¹¶ä¸”å¿…é¡»è¿”å›æ­¤æ¥å£çš„ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚æ­¤æ¥å£ä¼šå°†å½“å‰æ’ä»¶æ³¨å†Œä¸ºä¸€ä¸ª Intruder å·¥å…·çš„ payload ç”Ÿæˆå™¨ã€‚</p>
<blockquote>
<p>This interface is used for custom Intruder payload generators. Extensions that have registered an IIntruderPayloadGeneratorFactory must return a new instance of this interface when required as part of a new Intruder attack.</p>
</blockquote>
<h2 id="start">Start</h2>
<h3 id="ä½¿ç”¨intruder">ä½¿ç”¨Intruder</h3>
<p>ä¸‹è½½appï¼Œç›´æ¥æŠŠdexæå–ï¼Œè½¬æˆjarï¼Œåˆ†æé‡Œé¢çš„åŠ å¯†ç®—æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dex2jar mportal.dex
</span></span><span class="line"><span class="cl">jd-gui mportal.jar
</span></span></code></pre></div><p>åœ¨å‰ä¸€ç¯‡æ–‡ç« æœ‰åˆ†æè¿‡ç¨‹
<a href="https://gorgias.me/2015/06/14/%E4%B8%80%E6%AC%A1%E6%A0%A1%E5%9B%ADAndroid%E5%B9%B3%E5%8F%B0%E5%BA%94%E7%94%A8%E7%9A%84%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"target="_blank" rel="noopener noreferrer">ä¸€æ¬¡æ ¡å›­Androidå¹³å°åº”ç”¨çš„é€†å‘åˆ†æ</a></p>
<p>å…ˆä½¿ç”¨BurpSuiteæŠ“ç™»é™†è¯·æ±‚ã€‚Ctrl + Iï¼Œæ·»åŠ è¿›ä½¿ç”¨Intruderï¼Œç»™actionåé¢çš„å€¼æ·»åŠ dollarã€‚
<img loading="lazy"  src="Intruder.png"
        alt="Intruder"/>
åˆ‡åˆ°payloadé€‰é¡¹å¡ï¼Œç±»å‹é€‰æ‹©Custom iterator(è‡ªå®šä¹‰è¿­ä»£)ã€‚
<img loading="lazy"  src="payload.png"
        alt="payload"/>
ç„¶åæ ¹æ®åç¼–è¯‘æŸ¥åˆ°çš„æ˜æ–‡æ‹¼æ¥ç”Ÿæˆå™¨ä¸­payloadæ˜æ–‡ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Position1: <span class="nv">method</span><span class="o">=</span>checkUserLoginIFS<span class="p">&amp;</span><span class="nv">idNumber</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">Position2: å­¦å·¥å·æ˜¯20135120100314
</span></span><span class="line"><span class="cl">Position3: <span class="p">&amp;</span><span class="nv">UserPwd</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">Position4: è¿™é‡Œå¯¼å…¥å¯†ç å­—å…¸
</span></span><span class="line"><span class="cl">Position5: <span class="p">&amp;</span><span class="nv">logonIP</span><span class="o">=</span>8.8.8.8
</span></span></code></pre></div><h3 id="å‡†å¤‡å­—å…¸">å‡†å¤‡å­—å…¸</h3>
<p>é™¤äº†å¼±å£ä»¤ï¼Œè¿˜è¦å¸¦ä¸€ç‚¹ç¤¾ä¼šå·¥ç¨‹å­¦è‰²å½©ï¼Œå¹³å°å¯†ç é»˜è®¤èº«ä»½è¯åå…­ä½ã€‚
æˆ‘ä»¬ç”¨crunchç”Ÿæˆ<a href="https://mega.nz/#!ahxjSRZA!O5HLncoNVZePSzi_GkaQ2_-c_EdsIyXtp5_d5X1_67c"target="_blank" rel="noopener noreferrer">èº«ä»½è¯åå…­ä½</a>ï¼Œå¸¦Xçš„æ”¾æœ€åã€‚
ç„¶åè¿˜æœ‰æ•´ä¸ªå­¦æ ¡çš„å›ºè¯å·ç ã€‚å®˜æ–¹å°±æœ‰ä¸‹è½½ï¼Œéƒ½ä¸ç”¨è‡ªå·±ç”Ÿæˆäº†ã€‚
<img loading="lazy"  src="tel.png"
        alt="tel"/></p>
<h3 id="ç¼–å†™æ‰©å±•ä»£ç ">ç¼–å†™æ‰©å±•ä»£ç </h3>
<p>è¿™é‡Œæ²¡æœ‰ä½¿ç”¨åˆ°Generatorï¼Œå› ä¸ºæˆ‘æ˜¯ç”¨ç”Ÿæˆå¥½çš„å­—å…¸çˆ†ç ´ï¼Œå¦‚æœä½ æƒ³åœ¨ä»£ç é‡Œç”Ÿæˆï¼Œå¯ä»¥å®ç°Generatoræ¥å£ã€‚
BurpExtender.java</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">burp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BurpExtender</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">IBurpExtender</span><span class="p">,</span><span class="w"> </span><span class="n">IIntruderPayloadProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">IExtensionHelpers</span><span class="w"> </span><span class="n">helpers</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerExtenderCallbacks</span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">IBurpExtenderCallbacks</span><span class="w"> </span><span class="n">callbacks</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// obtain an extension helpers object</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">helpers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">callbacks</span><span class="p">.</span><span class="na">getHelpers</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// set our extension name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">callbacks</span><span class="p">.</span><span class="na">setExtensionName</span><span class="p">(</span><span class="s">&#34;Neusoft DCP&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// register ourselves as an Intruder payload processor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">callbacks</span><span class="p">.</span><span class="na">registerIntruderPayloadProcessor</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getProcessorName</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;NeusoftDESEncode&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">processPayload</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">currentPayload</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">originalPayload</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">baseValue</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">dataParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">helpers</span><span class="p">.</span><span class="na">bytesToString</span><span class="p">(</span><span class="n">currentPayload</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">EncryptData</span><span class="w"> </span><span class="n">enc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">EncryptData</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">helpers</span><span class="p">.</span><span class="na">stringToBytes</span><span class="p">(</span><span class="n">enc</span><span class="p">.</span><span class="na">encrypt</span><span class="p">(</span><span class="n">dataParameter</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>EncryptData.java</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">burp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.Cipher</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.SecretKey</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.SecretKeyFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.spec.DESedeKeySpec</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.spec.IvParameterSpec</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EncryptData</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">EncryptData</span><span class="w"> </span><span class="n">SingleEncryptData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">encryptKey</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">DESedeKeySpec</span><span class="w"> </span><span class="n">spec</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">SecretKeyFactory</span><span class="w"> </span><span class="n">keyFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">SecretKey</span><span class="w"> </span><span class="n">theKey</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="w"> </span><span class="n">IvParameters</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">EncryptData</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SingleEncryptData</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">SingleEncryptData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">EncryptData</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">SingleEncryptData</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">EncryptData</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Cipher</span><span class="w"> </span><span class="n">localCipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&#34;DESede&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Installling SunJCE provider.&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">encryptKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;neusofteducationplatform&#34;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">encryptKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DESedeKeySpec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">encryptKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">keyFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecretKeyFactory</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&#34;DESede&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">theKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">keyFactory</span><span class="p">.</span><span class="na">generateSecret</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">spec</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&#34;DESede/CBC/PKCS5Padding&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">IvParameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="s">&#34;01234567&#34;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">localException2</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">rawString</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">encryptedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">theKey</span><span class="p">,</span><span class="w"> </span><span class="n">IvParameters</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">plaintBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rawString</span><span class="p">.</span><span class="na">getBytes</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">encryptedString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">plaintBytes</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">localException</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">byteToHex</span><span class="p">(</span><span class="n">encryptedString</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">HEXBYTES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">48</span><span class="p">,</span><span class="w"> </span><span class="n">49</span><span class="p">,</span><span class="w"> </span><span class="n">50</span><span class="p">,</span><span class="w"> </span><span class="n">51</span><span class="p">,</span><span class="w"> </span><span class="n">52</span><span class="p">,</span><span class="w"> </span><span class="n">53</span><span class="p">,</span><span class="w"> </span><span class="n">54</span><span class="p">,</span><span class="w"> </span><span class="n">55</span><span class="p">,</span><span class="w"> </span><span class="n">56</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">57</span><span class="p">,</span><span class="w"> </span><span class="n">97</span><span class="p">,</span><span class="w"> </span><span class="n">98</span><span class="p">,</span><span class="w"> </span><span class="n">99</span><span class="p">,</span><span class="w"> </span><span class="n">100</span><span class="p">,</span><span class="w"> </span><span class="n">101</span><span class="p">,</span><span class="w"> </span><span class="n">102</span><span class="w"> </span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">HEXINDEX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;0123456789abcdef0123456789ABCDEF&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">byteToHex</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">char</span><span class="o">[</span><span class="n">len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">2</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">0xFF</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">s</span><span class="o">[</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="kt">char</span><span class="p">)</span><span class="n">HEXBYTES</span><span class="o">[</span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">4</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">0xF</span><span class="p">)</span><span class="o">]</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">s</span><span class="o">[</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="kt">char</span><span class="p">)</span><span class="n">HEXBYTES</span><span class="o">[</span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">0xF</span><span class="p">)</span><span class="o">]</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">s</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="ç”Ÿæˆæ‰©å±•æ’ä»¶å¹¶å¯¼å…¥">ç”Ÿæˆæ‰©å±•æ’ä»¶å¹¶å¯¼å…¥</h3>
<p>ProjectåŸºäºGradleï¼Œåœ¨å·¥ç¨‹ç›®å½•æ‰§è¡Œä¼šè¾“å‡ºjaråˆ°æŒ‡å®šç›®å½•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gradle task fatJar
</span></span><span class="line"><span class="cl">output: build/libs/IntruderPayloads-all.jar
</span></span></code></pre></div><p>åœ¨Extenderé€‰é¡¹å¡æ·»åŠ æ‰©å±•æ’ä»¶ï¼Œå¹¶ç¡®è®¤æ— è¯¯ã€‚
<img loading="lazy"  src="Extender.png"
        alt="Extender"/></p>
<p>åœ¨Playload Processingé€‰æ‹©å’±å†™çš„æ‰©å±•ã€‚
<img loading="lazy"  src="Processing.png"
        alt="Processing"/></p>
<p>ä¸ºäº†èŠ‚çº¦æ—¶é—´æ–¹ä¾¿æµ‹è¯•ï¼Œæ·»åŠ äº†å‡ ç»„é”™è¯¯å¯†ç å’Œä¸€ç»„æ­£ç¡®å¯†ç ã€‚å¯ä»¥çœ‹åˆ°æˆåŠŸçš„ç»“æœã€‚
<img loading="lazy"  src="result.png"
        alt="result"/></p>
<h2 id="reference">Reference</h2>
<p><a href="https://portswigger.net/burp/extender/api/"target="_blank" rel="noopener noreferrer">Burp Ext API</a></p>
<p><a href="https://github.com/PortSwigger/example-intruder-payloads"target="_blank" rel="noopener noreferrer">Intruder payloads Sample</a></p>
<p><a href="http://drops.wooyun.org/tools/14040"target="_blank" rel="noopener noreferrer">BurpSuiteæ’ä»¶å¼€å‘æŒ‡å—ä¹‹ API</a></p>
</article><section class="article labels"><a class="category" href=/zh/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/>ç½‘ç»œå®‰å…¨</a><a class="tag" href=/zh/tags/burp/>Burp</a><a class="tag" href=/zh/tags/extender/>Extender</a><a class="tag" href=/zh/tags/intruder/>Intruder</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/zh/posts/ngrok-notes/"><span class="iconfont icon-article"></span>Ngrokä½¿ç”¨ç¬”è®°</a></p><p><a class="link" href="/zh/posts/build-openwrt-firmware-from-source-notes/"><span class="iconfont icon-article"></span>æºç ç¼–è¯‘OpenWrtå›ºä»¶ç¬”è®°</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2026 Gorgias' Blog. </p><p class="license">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">
            <img alt="CC BY-NC-SA" loading="lazy" src="/images/by-nc.svg" style="vertical-align: middle; height: 1.2em; margin: 0 0.2em;" />
            CC BY-NC-SA 4.0
        </a>
        (ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«).
    </p><p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>