<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.154.5"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="Preface
Back in 2021, when I wanted to crack QNX hashes, I found that hashcat did not support QNX 6.6.0. There was already an issue requesting this feature at the time, but I was too busy to implement it."><title>QNX 7 Password Hash Analysis and Writing a Hashcat Module&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.363cdd0e3e6340dd0e88b1f21887fb7e53e3129ed31d7f3cf62686d06069621ece79dc5ffb48a77ebba54468e667212f.css" integrity="sha384-NjzdDj5jQN0OiLHyGIf7flPjEp7THX889iaG0GBpYh7Oedxf&#43;0infrulRGjmZyEv"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="QNX 7 Password Hash Analysis and Writing a Hashcat Module" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/en/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/en/categories/">Categories</a><a class="nav item" href="/en/tags/">Tags</a><a class="nav item" href="/en/about/">About</a><a class="nav item" href="/en/links/">Links</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">QNX 7 Password Hash Analysis and Writing a Hashcat Module</h1><p class="article date">Thursday, September 14, 2023<span class="langs"><span class="lang">
                    <a href="/zh/posts/qnx7-password-hash-analysis-and-hashcat-module/" title="‰∏≠Êñá">
                        <span class="lang-icon">üåê</span>‰∏≠Êñá</a>
                </span></span></p></section><article class="article markdown-body"><h2 id="preface">Preface</h2>
<p>Back in 2021, when I wanted to crack QNX hashes, I found that hashcat did not support QNX 6.6.0. There was already an issue requesting this feature at the time, but I was too busy to implement it.</p>
<p>Until the hard ‚Äúsolo run‚Äù of the MIIT vehicle-to-everything (V2X) offensive/defensive exercise in September 2023, I ran into QNX 7 hashes again‚Äîand after so many years, it was still not supported.</p>
<p>To avoid hitting the same requirement next time, I took some time to study the QNX libraries and hashcat. I also took a few detours while writing the hashcat module.</p>
<p><img loading="lazy"  src="qnxhash.png"
        alt="qnxhash.png"/></p>
<h2 id="qnx-etcshadow-hash-algorithm-analysis">QNX <code>/etc/shadow</code> hash algorithm analysis</h2>
<p>According to the official documentation <a href="https://www.qnx.com/developers/docs/7.0.0/index.html#com.qnx.doc.neutrino.user_guide/topic/accounts_etc_shadow.html"target="_blank" rel="noopener noreferrer">QNX 700 docs: accounts_etc_shadow</a>, the hash format is:</p>
<pre tabindex="0"><code>@digest@hash@salt
@digest,iterations@hash@salt
</code></pre><p>This hash uses <code>@</code> as a delimiter. Uppercase <code>S</code> indicates SHA-512, while lowercase <code>s</code> indicates SHA-256. If there is a comma followed by a number, it represents the iteration count. After that comes the Base64-encoded hash and the Base64-encoded salt.</p>
<p>After reading the QNX official documentation, it feels like it should be that simple. If you look at hashcat‚Äôs QNX 6 module (<code>-m 19200</code>), the first thought is: can‚Äôt we just tweak the iterations and the format?</p>
<p>So I copied the QNX 6 cracking module, hoping to reuse code and reduce workload. After adapting it to the official documentation, hashcat kept failing the self-test. Then I analyzed <code>/src/OpenCL/m19200.cl</code> and found it references John‚Äôs code and includes some hacks‚Äînot very elegant. My first guess was that this OpenCL code had bugs, so the next step was to analyze how QNX 7 generates the hash.</p>
<p>The hash generation logic is in <code>/usr/lib/pam.qnx.so</code>.</p>
<p>After analyzing the logic and comparing it with <code>m19200.cl</code>, I found that in the old OpenCL code the rounds are wrong: the first round is a SHA over <code>salt || password</code>, and the newly generated digest is not XORed with the previous result. So it‚Äôs not as simple as ‚Äújust Base64‚Äù.</p>
<p><img loading="lazy"  src="pam_qnx.png"
        alt="pam_qnx.png"/></p>
<p>In fact, the new hash generation logic uses the standard PBKDF2 (Password-Based Key Derivation Function) algorithm. Many products (Adobe, macOS, Cisco, etc.) use PBKDF2 to generate hashes. The higher the iteration count, the lower the cracking efficiency. QNX‚Äôs official documentation does not explicitly mention the algorithm name and only says ‚ÄúSHA-512‚Äù, which in a sense raises the barrier for security research.</p>
<p><img loading="lazy"  src="pbkdf2.png"
        alt="PBKDF2"/></p>
<p>You can verify it with CyberChef:</p>
<pre tabindex="0"><code>https://gchq.github.io/CyberChef/#recipe=Derive_PBKDF2_key(%7B&#39;option&#39;:&#39;UTF8&#39;,&#39;string&#39;:&#39;hashcat&#39;%7D,512,4096,&#39;SHA512&#39;,%7B&#39;option&#39;:&#39;Base64&#39;,&#39;string&#39;:&#39;NDY2MDEwNjk3YjBjYzM2MzliMzc3Mzc0ZTNiMTAzNzE%3D&#39;%7D)&amp;input=dm0ybkJHSGVzNlFrWHJhMGY3NFhtb3VTaVJ6allEM3IvMHB5K3R4djBLcjhBNGhDUE1HRkhvWnFyNDFKRmlZY0pQUE9lSWhlcUZzZU15THl3LzE1UHc9PQ
</code></pre><h2 id="writing-a-hashcat-module">Writing a Hashcat module</h2>
<p>See the official documentation:</p>
<p><a href="https://github.com/hashcat/hashcat/blob/master/docs/hashcat-plugin-development-guide.md"target="_blank" rel="noopener noreferrer">https://github.com/hashcat/hashcat/blob/master/docs/hashcat-plugin-development-guide.md</a></p>
<p>At first I was still thinking about writing new OpenCL code. After realizing it‚Äôs a standard algorithm, I basically gave up and decided to pick an existing, decent-looking module to modify.</p>
<pre tabindex="0"><code>./hashcat -hh | grep PBKDF2
  11900 | PBKDF2-HMAC-MD5                                            | Generic KDF
  12000 | PBKDF2-HMAC-SHA1                                           | Generic KDF
  10900 | PBKDF2-HMAC-SHA256                                         | Generic KDF
  12100 | PBKDF2-HMAC-SHA512                                         | Generic KDF
   2500 | WPA-EAPOL-PBKDF2                                           | Network Protocol
  22000 | WPA-PBKDF2-PMKID+EAPOL                                     | Network Protocol
  16800 | WPA-PMKID-PBKDF2                                           | Network Protocol
  12800 | MS-AzureSync PBKDF2-HMAC-SHA256                            | Operating System
   9200 | Cisco-IOS $8$ (PBKDF2-SHA256)                              | Operating System
   7100 | macOS v10.8+ (PBKDF2-SHA512)                               | Operating System
</code></pre><p>Hashcat self-tests each module on every run. <code>ST_HASH</code> and <code>ST_PASS</code> are the test vectors. So I directly changed <code>KERN_TYPE</code> to 7100 and planned to debug step by step‚Äîbut surprisingly, it worked on the first try.</p>
<p>Hashcat is an open-source project and merging code can take a while, so I‚Äôm attaching the code here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Author......: See docs/credits.txt
</span></span></span><span class="line"><span class="cl"><span class="cm"> * License.....: MIT
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;common.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;types.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;modules.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;bitops.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;convert.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;shared.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;emu_inc_hash_sha512.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;memory.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">ATTACK_EXEC</span>    <span class="o">=</span> <span class="n">ATTACK_EXEC_OUTSIDE_KERNEL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS0</span>      <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS1</span>      <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS2</span>      <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_POS3</span>      <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">DGST_SIZE</span>      <span class="o">=</span> <span class="n">DGST_SIZE_8_16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">HASH_CATEGORY</span>  <span class="o">=</span> <span class="n">HASH_CATEGORY_OS</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">HASH_NAME</span>      <span class="o">=</span> <span class="s">&#34;QNX 7 /etc/shadow (SHA512)&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u64</span>   <span class="n">KERN_TYPE</span>      <span class="o">=</span> <span class="mi">7100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">OPTI_TYPE</span>      <span class="o">=</span> <span class="n">OPTI_TYPE_ZERO_BYTE</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTI_TYPE_USES_BITS_64</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTI_TYPE_SLOW_HASH_SIMD_LOOP</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u64</span>   <span class="n">OPTS_TYPE</span>      <span class="o">=</span> <span class="n">OPTS_TYPE_STOCK_MODULE</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTS_TYPE_PT_GENERATE_LE</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTS_TYPE_ST_BASE64</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">|</span> <span class="n">OPTS_TYPE_HASH_COPY</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="n">u32</span>   <span class="n">SALT_TYPE</span>      <span class="o">=</span> <span class="n">SALT_TYPE_EMBEDDED</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ST_PASS</span>        <span class="o">=</span> <span class="s">&#34;hashcat&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ST_HASH</span>        <span class="o">=</span> <span class="s">&#34;@S@vm2nBGHes6QkXra0f74XmouSiRzjYD3r/0py+txv0Kr8A4hCPMGFHoZqr41JFiYcJPPOeIheqFseMyLyw/15Pw==@NDY2MDEwNjk3YjBjYzM2MzliMzc3Mzc0ZTNiMTAzNzE=&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_attack_exec</span>    <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">ATTACK_EXEC</span><span class="p">;</span>     <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos0</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS0</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos1</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS1</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos2</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS2</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_pos3</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_POS3</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_dgst_size</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">DGST_SIZE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_hash_category</span>  <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">HASH_CATEGORY</span><span class="p">;</span>   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">module_hash_name</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">HASH_NAME</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u64</span>         <span class="nf">module_kern_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">KERN_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_opti_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">OPTI_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u64</span>         <span class="nf">module_opts_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">OPTS_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">u32</span>         <span class="nf">module_salt_type</span>      <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">SALT_TYPE</span><span class="p">;</span>       <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">module_st_hash</span>        <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">ST_HASH</span><span class="p">;</span>         <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">module_st_pass</span>        <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">ST_PASS</span><span class="p">;</span>         <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">pbkdf2_sha512</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">u32</span> <span class="n">salt_buf</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kt">pbkdf2_sha512_t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">pbkdf2_sha512_tmp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">ipad</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">opad</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">dgst</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span>  <span class="n">out</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kt">pbkdf2_sha512_tmp_t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u64</span> <span class="nf">module_esalt_size</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u64</span> <span class="n">esalt_size</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">u64</span><span class="p">)</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">pbkdf2_sha512_t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">esalt_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u64</span> <span class="nf">module_tmp_size</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_t</span> <span class="o">*</span><span class="n">user_options</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">user_options_extra_t</span> <span class="o">*</span><span class="n">user_options_extra</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u64</span> <span class="n">tmp_size</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">u64</span><span class="p">)</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">pbkdf2_sha512_tmp_t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">tmp_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">ROUNDS_QNX</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">HASH_SIZE</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">module_hash_decode</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">void</span> <span class="o">*</span><span class="n">digest_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">salt_t</span> <span class="o">*</span><span class="n">salt</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">void</span> <span class="o">*</span><span class="n">esalt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">void</span> <span class="o">*</span><span class="n">hook_salt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="kt">hashinfo_t</span> <span class="o">*</span><span class="n">hash_info</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">line_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">line_len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">u64</span> <span class="o">*</span><span class="n">digest</span> <span class="o">=</span> <span class="p">(</span><span class="n">u64</span> <span class="o">*</span><span class="p">)</span> <span class="n">digest_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="kt">pbkdf2_sha512_t</span> <span class="o">*</span><span class="n">pbkdf2_sha512</span> <span class="o">=</span> <span class="p">(</span><span class="kt">pbkdf2_sha512_t</span> <span class="o">*</span><span class="p">)</span> <span class="n">esalt_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">hc_token_t</span> <span class="n">token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">token</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">hc_token_t</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">token_cnt</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// @digest@hash@salt
</span></span></span><span class="line"><span class="cl">  <span class="c1">// @digest,iterations@hash@salt
</span></span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_FIXED_LENGTH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_min</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_VERIFY_LENGTH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_min</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_max</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_VERIFY_LENGTH</span> <span class="o">|</span> <span class="n">TOKEN_ATTR_VERIFY_BASE64A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">sep</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>     <span class="o">=</span> <span class="sc">&#39;@&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_min</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">len_max</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">token</span><span class="p">.</span><span class="n">attr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>    <span class="o">=</span> <span class="n">TOKEN_ATTR_VERIFY_LENGTH</span> <span class="o">|</span> <span class="n">TOKEN_ATTR_VERIFY_BASE64A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">int</span> <span class="n">rc_tokenizer</span> <span class="o">=</span> <span class="nf">input_tokenizer</span> <span class="p">((</span><span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="p">)</span> <span class="n">line_buf</span><span class="p">,</span> <span class="n">line_len</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">token</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">rc_tokenizer</span> <span class="o">!=</span> <span class="n">PARSER_OK</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="n">rc_tokenizer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// check hash type
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;S&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SIGNATURE_UNMATCHED</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// check iter
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">u32</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">ROUNDS_QNX</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;,&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SEPARATOR_UNMATCHED</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">iter</span> <span class="o">=</span> <span class="nf">hc_strtoul</span> <span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// iter++; the additional round is added in the init kernel
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_iter</span> <span class="o">=</span> <span class="n">iter</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">hash_pos</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">int</span> <span class="n">hash_len</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">decoded_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">u8</span> <span class="n">tmp_buf</span><span class="p">[</span><span class="mi">512</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">decoded_len</span> <span class="o">=</span> <span class="nf">base64_decode</span> <span class="p">(</span><span class="n">base64_to_int</span><span class="p">,</span> <span class="n">hash_pos</span><span class="p">,</span> <span class="n">hash_len</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">decoded_len</span> <span class="o">!=</span> <span class="n">HASH_SIZE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SALT_LENGTH</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memcpy</span> <span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">,</span> <span class="mi">64</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">digest</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="nf">byte_swap_64</span> <span class="p">(</span><span class="n">digest</span><span class="p">[</span><span class="mi">7</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// salt
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">salt_pos</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">int</span> <span class="n">salt_len</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">len</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">tmp_buf</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">decoded_len</span> <span class="o">=</span> <span class="nf">base64_decode</span> <span class="p">(</span><span class="n">base64_to_int</span><span class="p">,</span> <span class="n">salt_pos</span><span class="p">,</span> <span class="n">salt_len</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">decoded_len</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_SALT_LENGTH</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span> <span class="p">(</span><span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">,</span> <span class="n">tmp_buf</span><span class="p">,</span> <span class="n">decoded_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbkdf2_sha512</span><span class="o">-&gt;</span><span class="n">salt_buf</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">salt</span><span class="o">-&gt;</span><span class="n">salt_len</span> <span class="o">=</span> <span class="n">decoded_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span><span class="n">PARSER_OK</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">module_hash_encode</span> <span class="p">(</span><span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashconfig_t</span> <span class="o">*</span><span class="n">hashconfig</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">digest_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">salt_t</span> <span class="o">*</span><span class="n">salt</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">esalt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">hook_salt_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">hashinfo_t</span> <span class="o">*</span><span class="n">hash_info</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">line_buf</span><span class="p">,</span> <span class="n">MAYBE_UNUSED</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">line_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">snprintf</span> <span class="p">(</span><span class="n">line_buf</span><span class="p">,</span> <span class="n">line_size</span><span class="p">,</span> <span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">hash_info</span><span class="o">-&gt;</span><span class="n">orighash</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">module_init</span> <span class="p">(</span><span class="kt">module_ctx_t</span> <span class="o">*</span><span class="n">module_ctx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_context_size</span>             <span class="o">=</span> <span class="n">MODULE_CONTEXT_SIZE_CURRENT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_interface_version</span>        <span class="o">=</span> <span class="n">MODULE_INTERFACE_VERSION_CURRENT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_attack_exec</span>              <span class="o">=</span> <span class="n">module_attack_exec</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_esalt</span>          <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_hook_salt</span>      <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_mask</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_charset</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_benchmark_salt</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_build_plain_postprocess</span>  <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_deep_comp_kernel</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_deprecated_notice</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos0</span>                <span class="o">=</span> <span class="n">module_dgst_pos0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos1</span>                <span class="o">=</span> <span class="n">module_dgst_pos1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos2</span>                <span class="o">=</span> <span class="n">module_dgst_pos2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_pos3</span>                <span class="o">=</span> <span class="n">module_dgst_pos3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dgst_size</span>                <span class="o">=</span> <span class="n">module_dgst_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_dictstat_disable</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_esalt_size</span>               <span class="o">=</span> <span class="n">module_esalt_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_extra_buffer_size</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_extra_tmp_size</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_extra_tuningdb_block</span>     <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_forced_outfile_format</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_binary_count</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_binary_parse</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_binary_save</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode_postprocess</span>  <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode_potfile</span>      <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode_zero_hash</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_decode</span>              <span class="o">=</span> <span class="n">module_hash_decode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_encode_status</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_encode_potfile</span>      <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_encode</span>              <span class="o">=</span> <span class="n">module_hash_encode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_init_selftest</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_mode</span>                <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_category</span>            <span class="o">=</span> <span class="n">module_hash_category</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hash_name</span>                <span class="o">=</span> <span class="n">module_hash_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hashes_count_min</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hashes_count_max</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hlfmt_disable</span>            <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_extra_param_size</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_extra_param_init</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_extra_param_term</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook12</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook23</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_salt_size</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_hook_size</span>                <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_jit_build_options</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_jit_cache_disable</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_accel_max</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_accel_min</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_loops_max</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_loops_min</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_threads_max</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kernel_threads_min</span>       <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kern_type</span>                <span class="o">=</span> <span class="n">module_kern_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_kern_type_dynamic</span>        <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_opti_type</span>                <span class="o">=</span> <span class="n">module_opti_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_opts_type</span>                <span class="o">=</span> <span class="n">module_opts_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_outfile_check_disable</span>    <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_outfile_check_nocomp</span>     <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_potfile_custom_check</span>     <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_potfile_disable</span>          <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_potfile_keep_all_hashes</span>  <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_pwdump_column</span>            <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_pw_max</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_pw_min</span>                   <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_salt_max</span>                 <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_salt_min</span>                 <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_salt_type</span>                <span class="o">=</span> <span class="n">module_salt_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_separator</span>                <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_st_hash</span>                  <span class="o">=</span> <span class="n">module_st_hash</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_st_pass</span>                  <span class="o">=</span> <span class="n">module_st_pass</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_tmp_size</span>                 <span class="o">=</span> <span class="n">module_tmp_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_unstable_warning</span>         <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">module_ctx</span><span class="o">-&gt;</span><span class="n">module_warmup_disable</span>           <span class="o">=</span> <span class="n">MODULE_DEFAULT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="references">References</h2>
<p><a href="https://news.sophos.com/fr-fr/2013/11/21/stocker-mots-de-passe-en-securite/"target="_blank" rel="noopener noreferrer">Serious Security : stocker vos mots de passe en toute s√©curit√©</a></p>
<p><a href="https://github.com/openwall/john/blob/bleeding-jumbo/src/sha2.c#L578-L595"target="_blank" rel="noopener noreferrer">https://github.com/openwall/john/blob/bleeding-jumbo/src/sha2.c#L578-L595</a></p>
<p><a href="https://github.com/hashcat/hashcat"target="_blank" rel="noopener noreferrer">https://github.com/hashcat/hashcat</a></p>
</article><section class="article labels"><a class="category" href=/en/categories/automotive-security/>Automotive Security</a><a class="tag" href=/en/tags/qnx/>QNX</a><a class="tag" href=/en/tags/hashcat/>Hashcat</a><a class="tag" href=/en/tags/pbkdf2/>PBKDF2</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/en/posts/vw-id4-vehicle-control-analysis/"><span class="iconfont icon-article"></span>VW ID.4 ICAS1 Vehicle Control Analysis</a></p><p><a class="link" href="/en/posts/general-firmware-reversing-tips/"><span class="iconfont icon-article"></span>General Tips for Firmware Reverse Engineering</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2026 Gorgias' Blog. </p><p class="license">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">
            <img alt="CC BY-NC-SA" loading="lazy" src="/images/by-nc.svg" style="vertical-align: middle; height: 1.2em; margin: 0 0.2em;" />
            CC BY-NC-SA 4.0
        </a>
        (Attribution-NonCommercial-ShareAlike).
    </p><p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>