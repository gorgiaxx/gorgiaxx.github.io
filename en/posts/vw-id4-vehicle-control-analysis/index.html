<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.154.5"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="Preface
In 2021, while working at 360, I built a test bench for the VW ID.4. I was close to getting significant results‚ÄîI had internal ODIS access and root privileges on ICAS3‚Äîbut I was abruptly reassigned to build a demo vehicle during a business trip, which disrupted my follow-up plans. During that period, a combination of professional obligations and personal challenges forced me to pause the research."><title>VW ID.4 ICAS1 Vehicle Control Analysis&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.363cdd0e3e6340dd0e88b1f21887fb7e53e3129ed31d7f3cf62686d06069621ece79dc5ffb48a77ebba54468e667212f.css" integrity="sha384-NjzdDj5jQN0OiLHyGIf7flPjEp7THX889iaG0GBpYh7Oedxf&#43;0infrulRGjmZyEv"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="VW ID.4 ICAS1 Vehicle Control Analysis" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/en/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/en/categories/">Categories</a><a class="nav item" href="/en/tags/">Tags</a><a class="nav item" href="/en/about/">About</a><a class="nav item" href="/en/links/">Links</a><a class="nav item" href="/zh/posts/vw-id4-vehicle-control-analysis/" title="‰∏≠Êñá">
            <span class="lang-icon">üåê</span>‰∏≠Êñá</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">VW ID.4 ICAS1 Vehicle Control Analysis</h1><p class="article date">Thursday, December 26, 2024<span class="langs"><span class="lang">
                    <a href="/zh/posts/vw-id4-vehicle-control-analysis/" title="‰∏≠Êñá">
                        <span class="lang-icon">üåê</span>‰∏≠Êñá</a>
                </span></span></p></section><article class="article markdown-body"><h2 id="preface">Preface</h2>
<p>In 2021, while working at 360, I built a test bench for the VW ID.4. I was close to getting significant results‚ÄîI had internal ODIS access and root privileges on ICAS3‚Äîbut I was abruptly reassigned to build a demo vehicle during a business trip, which disrupted my follow-up plans. During that period, a combination of professional obligations and personal challenges forced me to pause the research.</p>
<p>You could call this a &ldquo;regret project&rdquo;‚Äîan unfinished endeavor I wish I had completed. By coincidence, I revisited the vehicle control logic of the ID.4‚Äôs ICAS1 this past May. Another such project is CAN-Pick NG, which I partially wrote before shelving. I am unsure if I will be able to finish it in 2025.</p>
<p>The ID.4 is based on Volkswagen‚Äôs MEB platform. Its EE (Electrical/Electronic) architecture features two primary domain controllers: ICAS1 and ICAS3. ICAS1 (J533) is responsible for body control.</p>
<p>The figure below shows the location of J533 at position 13. By mounting a drive-by-wire module here, you can monitor and control body functions.</p>
<p><img loading="lazy"  src="./icas1.png"
        alt="icas1"/></p>
<h2 id="in-vehicle-ecu-topology">In-Vehicle ECU Topology</h2>
<ul>
<li><strong>Classic CAN:</strong> 500 kbps</li>
<li><strong>CAN-FD:</strong> Arbitration phase 500 kbps, Data phase 2 Mbps. (For CAN-FD analysis, ZLG devices are highly recommended).</li>
</ul>
<p>Analyzing the ELSA wiring diagrams and internal VW training materials revealed inconsistent bus naming. Reorganizing this information is necessary to derive the correct CAN topology.</p>
<p>The J533 gateway manages a total of 9 CAN buses and 4 LIN buses (LIN is not utilized in this analysis). The key ECUs are as follows:</p>
<ul>
<li><strong>Running-Gear CAN (CAN-FD)</strong>
<ul>
<li>J104 - ABS</li>
<li>J500 - EPS (Electric Power Steering control unit)</li>
<li>NX6 - Brake Controller (Brake Booster)</li>
</ul>
</li>
<li><strong>Powertrain CAN (CAN-FD)</strong>
<ul>
<li>J623 - Engine/Motor Control Module</li>
<li>J841/J944 - Electric Drive Unit</li>
<li>J234 - Airbag (Do not fuzz this; it is dangerous)</li>
</ul>
</li>
<li><strong>Driver Assistance CAN (CAN-FAS) (CAN-FD)</strong>
<ul>
<li>J428 - Distance Control Unit</li>
<li>J446 - Parking Radar Control Unit</li>
<li>J769/J770 - Lane Change Assist Control Units</li>
<li>J928 - Surround-View Camera Control Unit</li>
</ul>
</li>
<li><strong>Convenience CAN (Classic)</strong>
<ul>
<li>J527 - Steering Column Electronics Control Module (Shift-by-wire module)</li>
<li>J605 - Tailgate Control Unit</li>
<li>J764 - Steering Column Lock</li>
<li>&hellip;and other body controls</li>
</ul>
</li>
<li><strong>CAN-EV (CAN-FD)</strong>
<ul>
<li>J979 - Heater and Air Conditioning Control Module</li>
</ul>
</li>
</ul>
<p><img loading="lazy"  src="./topicdiagram.png"
        alt="topicdiagram"/></p>
<h2 id="j533-connector-t40a-definition">J533 Connector T40a Definition</h2>
<p>The following table details the T40a connector pinout.</p>
<p><img loading="lazy"  src="./T40a_datasheet.png"
        alt="T40a_datasheet"/></p>
<p><img loading="lazy"  src="./T40a.png"
        alt="T40a"/></p>
<h2 id="bus-security-strategy">Bus Security Strategy</h2>
<h3 id="gateway-isolation">Gateway Isolation</h3>
<p>Multifunction steering wheel control signals originate on the Convenience CAN, but ECUs on the Chassis CAN can also observe them. However, the J533 gateway blocks any steering wheel control signals originating from the Chassis CAN, preventing them from reaching their target ECUs.</p>
<h2 id="crc-check">CRC Check</h2>
<p>Observing the CAN bus traffic reveals a pattern in most messages: the first byte appears random, while the second byte increments regularly. The first byte is the CRC (Cyclic Redundancy Check), and the second byte is a counter.</p>
<h3 id="crc-seeds">CRC Seeds</h3>
<p><strong>Reference:</strong> <a href="https://github.com/commaai/opendbc"target="_blank" rel="noopener noreferrer">OpenDBC github</a>
<code>/opendbc/can/common.cc</code> <code>volkswagen_mqb_checksum</code></p>
<p>While checksum seeds for the VW MQB platform are available, the ID.4 introduces many new CRC seeds. I reverse-engineered them and listed them below.</p>
<p>Most control signals include both a CRC and a counter. ECUs typically skip CRC validation for non-critical functions (e.g., sunroof, windows, horn) but enforce it for safety-critical functions such as EPS, tailgate operation, and wipers.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Signal</th>
          <th style="text-align: left">CAN ID</th>
          <th style="text-align: left">CRC Seed</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">AAA_01</td>
          <td style="text-align: left">0x12DD5502</td>
          <td style="text-align: left">0x62,0x14,0x7c,0xa1,0x49,0x95,0x43,0x04,0x78,0x46,0x74,0x19,0x39,0x17,0x9f,0x1c</td>
      </tr>
      <tr>
          <td style="text-align: left">ACC_18</td>
          <td style="text-align: left">0x14D</td>
          <td style="text-align: left">0x1a,0x65,0x81,0x96,0xc0,0xdf,0x11,0x92,0xd3,0x61,0xc6,0x95,0x8c,0x29,0x21,0xb5</td>
      </tr>
      <tr>
          <td style="text-align: left">Airbag_01</td>
          <td style="text-align: left">0x040</td>
          <td style="text-align: left">0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40</td>
      </tr>
      <tr>
          <td style="text-align: left">Airbag_02</td>
          <td style="text-align: left">0x520</td>
          <td style="text-align: left">0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44</td>
      </tr>
      <tr>
          <td style="text-align: left">APS_Master</td>
          <td style="text-align: left">0x380</td>
          <td style="text-align: left">0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13</td>
      </tr>
      <tr>
          <td style="text-align: left">AWV_03</td>
          <td style="text-align: left">0x0DB</td>
          <td style="text-align: left">0x09,0xfa,0xca,0x8e,0x62,0xd5,0xd1,0xf0,0x31,0xa0,0xaf,0xda,0x4d,0x1a,0x0a,0x97</td>
      </tr>
      <tr>
          <td style="text-align: left">BEM_06</td>
          <td style="text-align: left">0x48B</td>
          <td style="text-align: left">0x54,0xaf,0x8a,0xfb,0x0d,0x87,0x6a,0x0f,0x47,0x78,0x31,0x4f,0x35,0x28,0x82,0x6d</td>
      </tr>
      <tr>
          <td style="text-align: left">Blinkmodi_02</td>
          <td style="text-align: left">0x366</td>
          <td style="text-align: left">0xa9,0xbd,0xfb,0x3c,0x95,0x0f,0x75,0x3a,0x4f,0x19,0x59,0x6d,0xb2,0xe9,0xd1,0x97</td>
      </tr>
      <tr>
          <td style="text-align: left">EA_01</td>
          <td style="text-align: left">0x1A4</td>
          <td style="text-align: left">0x69,0xbb,0x54,0xe6,0x4e,0x46,0x8d,0x7b,0xea,0x87,0xe9,0xb3,0x63,0xce,0xf8,0xbf</td>
      </tr>
      <tr>
          <td style="text-align: left">EA_02</td>
          <td style="text-align: left">0x1F0</td>
          <td style="text-align: left">0x2f,0x3c,0x22,0x60,0x18,0xeb,0x63,0x76,0xc5,0x91,0x0f,0x27,0x34,0x04,0x7f,0x02</td>
      </tr>
      <tr>
          <td style="text-align: left">ELV_01</td>
          <td style="text-align: left">0x656</td>
          <td style="text-align: left">0xab,0x2f,0xd3,0x39,0x6f,0x37,0xfa,0x59,0xa4,0x70,0xce,0x11,0x54,0x82,0x62,0x56</td>
      </tr>
      <tr>
          <td style="text-align: left">EM1_01</td>
          <td style="text-align: left">0x0C0</td>
          <td style="text-align: left">0x2f,0x44,0x72,0xd3,0x07,0xf2,0x39,0x09,0x8d,0x6f,0x57,0x20,0x37,0xf9,0x9b,0xfa</td>
      </tr>
      <tr>
          <td style="text-align: left">EML_02</td>
          <td style="text-align: left">0x1A555541</td>
          <td style="text-align: left">0x3e,0xb4,0x25,0xc1,0x31,0x1f,0xf1,0xd7,0xb1,0xbe,0xcc,0xe0,0x0f,0x46,0x51,0xb2</td>
      </tr>
      <tr>
          <td style="text-align: left">EML_06</td>
          <td style="text-align: left">0x20A</td>
          <td style="text-align: left">0x9d,0xe8,0x36,0xa1,0xca,0x3b,0x1d,0x33,0xe0,0xd5,0xbb,0x5f,0xae,0x3c,0x31,0x9f</td>
      </tr>
      <tr>
          <td style="text-align: left">ESC_50</td>
          <td style="text-align: left">0x102</td>
          <td style="text-align: left">0xd7,0x12,0x85,0x7e,0x0b,0x34,0xfa,0x16,0x7a,0x25,0x2d,0x8f,0x04,0x8e,0x5d,0x35</td>
      </tr>
      <tr>
          <td style="text-align: left">ESC_51</td>
          <td style="text-align: left">0x0FC</td>
          <td style="text-align: left">0x77,0x5c,0xa0,0x89,0x4b,0x7c,0xbb,0xd6,0x1f,0x6c,0x4f,0xf6,0x20,0x2b,0x43,0xdd</td>
      </tr>
      <tr>
          <td style="text-align: left">ESP_10</td>
          <td style="text-align: left">0x116</td>
          <td style="text-align: left">0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac,0xac</td>
      </tr>
      <tr>
          <td style="text-align: left">ESP_20</td>
          <td style="text-align: left">0x65D</td>
          <td style="text-align: left">0xac,0xb3,0xab,0xeb,0x7a,0xe1,0x3b,0xf7,0x73,0xba,0x7c,0x9e,0x06,0x5f,0x02,0xd9</td>
      </tr>
      <tr>
          <td style="text-align: left">ESP_21</td>
          <td style="text-align: left">0x0FD</td>
          <td style="text-align: left">0xb4,0xef,0xf8,0x49,0x1e,0xe5,0xc2,0xc0,0x97,0x19,0x3c,0xc9,0xf1,0x98,0xd6,0x61</td>
      </tr>
      <tr>
          <td style="text-align: left">ESP_24</td>
          <td style="text-align: left">0x31B</td>
          <td style="text-align: left">0x67,0x8a,0xae,0x22,0x4d,0xd0,0x51,0x80,0x5c,0xb9,0xce,0x1e,0xdf,0x02,0x2d,0xd4</td>
      </tr>
      <tr>
          <td style="text-align: left">Getriebe_11</td>
          <td style="text-align: left">0x0AD</td>
          <td style="text-align: left">0x3f,0x69,0x39,0xdc,0x94,0xf9,0x14,0x64,0xd8,0x6a,0x34,0xce,0xa2,0x55,0xb5,0x2c</td>
      </tr>
      <tr>
          <td style="text-align: left">GRA_ACC_01</td>
          <td style="text-align: left">0x12B</td>
          <td style="text-align: left">0x6a,0x38,0xb4,0x27,0x22,0xef,0xe1,0xbb,0xf8,0x80,0x84,0x49,0xc7,0x9e,0x1e,0x2b</td>
      </tr>
      <tr>
          <td style="text-align: left">HCA_01</td>
          <td style="text-align: left">0x126</td>
          <td style="text-align: left">0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda,0xda</td>
      </tr>
      <tr>
          <td style="text-align: left">HVL_01</td>
          <td style="text-align: left">0x12DD553D</td>
          <td style="text-align: left">0x1d,0x82,0x7b,0x79,0xa5,0xee,0x3a,0xb9,0xb7,0xf9,0xe4,0x67,0x7f,0x97,0x11,0xad</td>
      </tr>
      <tr>
          <td style="text-align: left">IPA_01</td>
          <td style="text-align: left">0x138</td>
          <td style="text-align: left">0x77,0x4e,0x14,0x87,0xf2,0xf8,0xb2,0x61,0xf6,0xa4,0x52,0x94,0xd4,0x81,0x2a,0xb1</td>
      </tr>
      <tr>
          <td style="text-align: left">IPA_02</td>
          <td style="text-align: left">0x16A9545F</td>
          <td style="text-align: left">0xc6,0x7f,0x85,0xb6,0xe6,0xae,0xf8,0x26,0xb0,0x8c,0x19,0x10,0x5b,0x33,0x64,0x6c</td>
      </tr>
      <tr>
          <td style="text-align: left">Klemmen_Status_01</td>
          <td style="text-align: left">0x3C0</td>
          <td style="text-align: left">0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3,0xc3</td>
      </tr>
      <tr>
          <td style="text-align: left">LH_EPS_02</td>
          <td style="text-align: left">0x11D</td>
          <td style="text-align: left">0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c</td>
      </tr>
      <tr>
          <td style="text-align: left">LH_EPS_03</td>
          <td style="text-align: left">0x09F</td>
          <td style="text-align: left">0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5,0xf5</td>
      </tr>
      <tr>
          <td style="text-align: left">Licht_Anf_01</td>
          <td style="text-align: left">0x3D5</td>
          <td style="text-align: left">0xc5,0x39,0xc7,0xf9,0x92,0xd8,0x24,0xce,0xf1,0xb5,0x7a,0xc4,0xbc,0x60,0xe3,0xd1</td>
      </tr>
      <tr>
          <td style="text-align: left">LWI_01</td>
          <td style="text-align: left">0x086</td>
          <td style="text-align: left">0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86</td>
      </tr>
      <tr>
          <td style="text-align: left">Motor_14</td>
          <td style="text-align: left">0x3BE</td>
          <td style="text-align: left">0x1f,0x28,0xc6,0x85,0xe6,0xf8,0xb0,0x19,0x5b,0x64,0x35,0x21,0xe4,0xf7,0x9c,0x24</td>
      </tr>
      <tr>
          <td style="text-align: left">Motor_51</td>
          <td style="text-align: left">0x10B</td>
          <td style="text-align: left">0x77,0x5c,0xa0,0x89,0x4b,0x7c,0xbb,0xd6,0x1f,0x6c,0x4f,0xf6,0x20,0x2b,0x43,0xdd</td>
      </tr>
      <tr>
          <td style="text-align: left">Motor_54</td>
          <td style="text-align: left">0x14C</td>
          <td style="text-align: left">0x16,0x35,0x59,0x15,0x9a,0x2a,0x97,0xb8,0x0e,0x4e,0x30,0xcc,0xb3,0x07,0x01,0xad</td>
      </tr>
      <tr>
          <td style="text-align: left">Motor_Code_01</td>
          <td style="text-align: left">0x641</td>
          <td style="text-align: left">0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47</td>
      </tr>
      <tr>
          <td style="text-align: left">Parken_01</td>
          <td style="text-align: left">0x206</td>
          <td style="text-align: left">0x09,0xfa,0xca,0x8e,0x62,0xd5,0xd1,0xf0,0x31,0xa0,0xaf,0xda,0x4d,0x1a,0x0a,0x97</td>
      </tr>
      <tr>
          <td style="text-align: left">PLA_04</td>
          <td style="text-align: left">0x407</td>
          <td style="text-align: left">0xef,0x60,0x04,0xa8,0x0c,0x1c,0xda,0x07,0x36,0xd7,0x28,0x92,0xa9,0x88,0x2c,0x4a</td>
      </tr>
      <tr>
          <td style="text-align: left">QFK_01</td>
          <td style="text-align: left">0x13D</td>
          <td style="text-align: left">0x20,0xca,0x68,0xd5,0x1b,0x31,0xe2,0xda,0x08,0x0a,0xd4,0xde,0x9c,0xe4,0x35,0x5b</td>
      </tr>
      <tr>
          <td style="text-align: left">RCTA_01</td>
          <td style="text-align: left">0x2B7</td>
          <td style="text-align: left">0x5e,0xc7,0x04,0x11,0x4d,0x27,0x0d,0x31,0x91,0xb8,0x62,0x76,0x64,0x09,0xeb,0xec</td>
      </tr>
      <tr>
          <td style="text-align: left">SAL_01</td>
          <td style="text-align: left">0x12DD54C9</td>
          <td style="text-align: left">0xde,0xa9,0x83,0x0b,0x0c,0x64,0x79,0x44,0x0f,0xf6,0xc6,0xc7,0x05,0x45,0xb7,0x59</td>
      </tr>
      <tr>
          <td style="text-align: left">SAM_01</td>
          <td style="text-align: left">0x205</td>
          <td style="text-align: left">0x19,0x36,0xd4,0x1e,0x80,0x22,0xf4,0xb8,0xad,0x41,0x0b,0x3f,0x87,0x42,0x25,0x40</td>
      </tr>
      <tr>
          <td style="text-align: left">SMLS_01</td>
          <td style="text-align: left">0x3D4</td>
          <td style="text-align: left">0xc3,0x79,0xbf,0xdb,0xe9,0x11,0x46,0x86,0x69,0xb6,0x9b,0x29,0x15,0x9c,0x45,0x0d</td>
      </tr>
      <tr>
          <td style="text-align: left">TA_01</td>
          <td style="text-align: left">0x26B</td>
          <td style="text-align: left">0xce,0xcc,0xbd,0x69,0xa1,0x3c,0x18,0x76,0x0f,0x04,0xf2,0x3a,0x93,0x24,0x19,0x51</td>
      </tr>
      <tr>
          <td style="text-align: left">TSG_FT_02</td>
          <td style="text-align: left">0x3E5</td>
          <td style="text-align: left">0xc4,0x6a,0x69,0x30,0xcf,0x61,0x58,0x51,0x1b,0x86,0x99,0xd3,0xf6,0x1d,0x9a,0x37</td>
      </tr>
      <tr>
          <td style="text-align: left">VMM_01</td>
          <td style="text-align: left">0x105</td>
          <td style="text-align: left">0xde,0x0e,0xa7,0x1d,0xc3,0x83,0xbd,0x82,0x8c,0xa2,0x0c,0x7b,0x4d,0x3c,0x58,0x79</td>
      </tr>
      <tr>
          <td style="text-align: left">VMM_02</td>
          <td style="text-align: left">0x139</td>
          <td style="text-align: left">0xed,0x03,0x1c,0x13,0xc6,0x23,0x78,0x7a,0x8b,0x40,0x14,0x51,0xbf,0x68,0x32,0xba</td>
      </tr>
  </tbody>
</table>
<h3 id="crc-algorithm">CRC Algorithm</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">MEB_Kennungsfolge</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># LWI_01 Steering Angle</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x86</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># LH_EPS_03 Electric Power Steering</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x9F</span><span class="p">:</span> <span class="p">[</span><span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># HCA_01 Heading Control Assist</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x126</span><span class="p">:</span> <span class="p">[</span><span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># GRA_ACC_01 Steering wheel controls for ACC</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x12B</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gen_crc_lookup_table_8</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">crc_lut</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">crc</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">crc</span> <span class="o">=</span> <span class="p">(</span><span class="n">crc</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="n">poly</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">crc</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc_lut</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">crc</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">crc_lut</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">volkswagen_mqb_checksum</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">crc8_lut_8h2f</span>
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="mh">0xFF</span>  <span class="c1"># CRC8 8H2F/AUTOSAR</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">crc</span> <span class="o">^</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(hex(crc), hex(i))</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">crc8_lut_8h2f</span><span class="p">[</span><span class="n">crc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">counter</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0F</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">MEB_Kennungsfolge</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">^=</span> <span class="n">MEB_Kennungsfolge</span><span class="p">[</span><span class="n">address</span><span class="p">][</span><span class="n">counter</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># No validation required</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">^=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">]</span> <span class="o">*</span> <span class="mi">16</span>  <span class="c1"># Return all 0s by default</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="n">crc8_lut_8h2f</span><span class="p">[</span><span class="n">crc</span><span class="p">]</span>  <span class="c1"># Standard CRC8 8H2F/AUTOSAR final XOR</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">crc</span> <span class="o">^</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">can_id</span> <span class="o">=</span> <span class="mh">0x126</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">crc8_lut_8h2f</span> <span class="o">=</span> <span class="n">gen_crc_lookup_table_8</span><span class="p">(</span><span class="mh">0x2f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">crc</span> <span class="o">=</span> <span class="n">volkswagen_mqb_checksum</span><span class="p">(</span><span class="n">can_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">crc</span>
</span></span></code></pre></div><h2 id="can-signals">CAN Signals</h2>
<p>The Convenience CAN carries the signal traffic listed below. It allows for state monitoring and control of most body functions, including HVAC, front/rear lights, horn, wipers, windows, door locks, and various vehicle status updates.</p>
<pre tabindex="0"><code>0x12B   GRA_ACC_01          Adaptive Cruise Control (GRA/ACC)
0x1F0   EA_02               Emergency Assist
0x205   SAM_01              Switches and Execution Module
0x2B7   RCTA_01             Rear Cross Traffic Alert
0x31B   ESP_24  
0x366   Blinkmodi_02        Blinking Mode (Turn Signals)
0x397   LDW_02              Lane Departure Warning System
0x3BE   Motor_14            Motor Control
0x3C0   Klemmen_Status_01   Terminal Status (Clamp Status)
0x3CE   TSG_HFS_01          Rear Door Window Function System (Left?)
0x3CF   TSG_HBFS_01         Rear Door Window Function System (Right?)
0x3D0   TSG_FT_01           Front Door Function System
0x3D4   SMLS_01             Steering Column Switch Module
0x3D5   Licht_Anf_01        Light Request
0x3D6   Licht_hinten_01     Rear Light Status
0x3DC   Gateway_73          Gateway Info (System alerts, safety warnings, fault diagnosis, signal updates)
0x48B   BEM_06              Low Voltage Energy Management
0x520   Airbag_02           Airbag 2
0x551   WFS_01              Immobilizer
0x582   HDSG_01             Trunk Management Status
0x583   ZV_02               Central Locking System
0x585   Systeminfo_01       Diagnostic and Production Mode Settings
0x592   Kessy_04            Smart Key System (Kessy) / Remote Parking Status/Control
0x5A0   RLS_01              Light and Rain Sensor
0x5A7   TM_01               Telematics
0x5F0   Dimmung_01          Dimming
0x5F4   Innenlicht_11       Interior Lighting
0x641   Motor_Code_01       Motor Coding
0x643   Einheiten_01        Unit Settings
0x656   ELV_01              Electronic Steering Column Lock
0x658   Licht_vorne_01      Front Light Status
0x65D   ESP_20  
0x668   Klima_12            Air Conditioning System
0x670   Motor_18    
0x6AE   Spiegel_01          Mirrors
0x6AF   Rear_View_01        Rear View Camera
0x6B2   Diagnose_01 
0x6B4   VIN_01  
0x12DD54C9  SAL_01          Lighting Module
</code></pre><h2 id="other-signals">Other Signals</h2>
<p>While the DBC has been analyzed, it is not currently published.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">0x184
</span></span><span class="line"><span class="cl">1. Lock Vehicle
</span></span><span class="line"><span class="cl">   1. Byte 2: Mirror Open (0x20 Open)
</span></span><span class="line"><span class="cl">   2. Byte 3: Mirror Close (0x40 Close)
</span></span><span class="line"><span class="cl">2. Windows
</span></span><span class="line"><span class="cl">   1. Byte 6: Window Control - 04 Front Left Down, 02 Front Left Up, 40 Rear Left Down, 08 Front Right Up, 10 Front Right Down
</span></span><span class="line"><span class="cl">   2. Byte 7: 01 Rear Right Down
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0x185
</span></span><span class="line"><span class="cl">1. Window Control (10, 20 Up; 40, 80 Down)
</span></span><span class="line"><span class="cl">   1. Byte 1: Front Row
</span></span><span class="line"><span class="cl">   2. Byte 2: Rear Row
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0x598
</span></span><span class="line"><span class="cl">1. Sunroof Control
</span></span><span class="line"><span class="cl">   1. Byte 3: 0x20 None, 0x21 Tap, 0x22 Slide, 0x25 Long Press
</span></span><span class="line"><span class="cl">   2. Byte 7: 04 Close Once, 08 Close Cont., 0C Open Once, 10 Open Cont., 14/1C Others
</span></span></code></pre></div><h2 id="steering-control">Steering Control</h2>
<p>The vehicle must be in Gear D/B or R. The following five signals can be used to control the steering wheel:</p>
<ul>
<li><strong>LWI_01:</strong> Steering Angle Sensor</li>
<li><strong>LH_EPS_03:</strong> Electric Power Steering (Steering Assist)</li>
<li><strong>HCA_01:</strong> Heading Control Assist</li>
<li><strong>GRA_ACC_01:</strong> Adaptive Cruise Control</li>
<li><strong>PLA_05:</strong> Park Lane Assist</li>
</ul>
<p><strong>Notes:</strong></p>
<ul>
<li>Combining signals 0x86, 0x9f, 0x126, 0x12b, and 0x302 on the <strong>CAN-FAS</strong> bus allows for parking steering actuation.</li>
<li>Combining signals 0x86, 0x9f, and 0x302 on the <strong>Gear-Running CAN</strong> can also actuate the steering wheel.</li>
<li>Both 0x9f (LH_EPS_03) and 0x302 (PLA_05) can directly control the steering wheel.</li>
<li>Since 0x302 (PLA_05) lacks a CRC check, it offers a simpler method for steering control compared to 0x9f.</li>
</ul>
<h3 id="demo">DEMO</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_pla_control</span><span class="p">(</span><span class="n">sendestatus</span><span class="p">,</span> <span class="n">positive</span><span class="p">,</span> <span class="n">degree</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x40</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_QFK_Spuerb</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFA</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_QFK_KruemmSoll</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_QFK_KruemmSoll_VZ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">positive</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_05_Sendestatus</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">sendestatus</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">hca_01_counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">degree</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># data = create_steering_control(10 * i, 1)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># meb_can_send(0x126, 0.1, data)</span>
</span></span><span class="line"><span class="cl">    <span class="n">degree</span> <span class="o">+=</span> <span class="mh">0x10</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">create_pla_control</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">can_send</span><span class="p">(</span><span class="mh">0x302</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="rpi-can-hat">RPi CAN HAT</h3>
<p>This steering control demo only makes the steering wheel move. To implement true remote driving, you need a solid understanding of vehicle dynamics and must design a proper control algorithm.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">can</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">can0</span> <span class="o">=</span> <span class="n">can</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Bus</span><span class="p">(</span><span class="n">channel</span> <span class="o">=</span> <span class="s1">&#39;can0&#39;</span><span class="p">,</span> <span class="n">bustype</span> <span class="o">=</span> <span class="s1">&#39;socketcan&#39;</span><span class="p">,</span> <span class="n">fd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bitrate</span><span class="o">=</span><span class="mi">500000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># msg = can.Message(is_extended_id=False, arbitration_id=0x123, data=[0, 1, 2, 3, 4, 5, 6, 7])</span>
</span></span><span class="line"><span class="cl"><span class="c1"># can0.send(msg)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MEB_Kennungsfolge</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># LWI_01 Steering Angle</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x86</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># LH_EPS_03 Electric Power Steering</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x9F</span><span class="p">:</span> <span class="p">[</span><span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># HCA_01 Heading Control Assist</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x126</span><span class="p">:</span> <span class="p">[</span><span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># GRA_ACC_01 Steering wheel controls for ACC</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x12B</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">volkswagen_mqb_checksum</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">crc8_lut_8h2f</span>
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="mh">0xFF</span>  <span class="c1"># CRC8 8H2F/AUTOSAR</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">crc</span> <span class="o">^</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(hex(crc), hex(i))</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">crc8_lut_8h2f</span><span class="p">[</span><span class="n">crc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">counter</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0F</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">MEB_Kennungsfolge</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">^=</span> <span class="n">MEB_Kennungsfolge</span><span class="p">[</span><span class="n">address</span><span class="p">][</span><span class="n">counter</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Attempt to CRC check undefined Volkswagen message 0x</span><span class="si">%02X</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">address</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">^=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">]</span> <span class="o">*</span> <span class="mi">16</span>  <span class="c1"># Return all 0s by default</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="n">crc8_lut_8h2f</span><span class="p">[</span><span class="n">crc</span><span class="p">]</span>  <span class="c1"># Standard CRC8 8H2F/AUTOSAR final XOR</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">crc</span> <span class="o">^</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gen_crc_lookup_table_8</span><span class="p">(</span><span class="n">poly</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">crc_lut</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">crc</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">crc</span> <span class="o">=</span> <span class="p">(</span><span class="n">crc</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="n">poly</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">crc</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc_lut</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">crc</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">crc_lut</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">meb_can_send</span><span class="p">(</span><span class="n">can_id</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">hca_01_counter</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">hca_01_counter</span>
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="n">volkswagen_mqb_checksum</span><span class="p">(</span><span class="n">can_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">crc</span>
</span></span><span class="line"><span class="cl">    <span class="n">hca_01_counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;, &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg</span> <span class="o">=</span> <span class="n">can</span><span class="o">.</span><span class="n">Message</span><span class="p">(</span><span class="n">is_extended_id</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arbitration_id</span><span class="o">=</span><span class="n">can_id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">is_fd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">can0</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">can_send</span><span class="p">(</span><span class="n">can_id</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg</span> <span class="o">=</span> <span class="n">can</span><span class="o">.</span><span class="n">Message</span><span class="p">(</span><span class="n">is_extended_id</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arbitration_id</span><span class="o">=</span><span class="n">can_id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">is_fd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">can0</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">crc8_lut_8h2f</span> <span class="o">=</span> <span class="n">gen_crc_lookup_table_8</span><span class="p">(</span><span class="mh">0x2f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">start_pos</span><span class="p">,</span> <span class="n">value_length</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">end_pos</span> <span class="o">=</span> <span class="n">start_pos</span> <span class="o">+</span> <span class="n">value_length</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">bit_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_pos</span><span class="p">,</span> <span class="n">end_pos</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">byte_index</span> <span class="o">=</span> <span class="n">bit_index</span> <span class="o">//</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="n">bit_offset</span> <span class="o">=</span> <span class="n">bit_index</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="n">bit_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">bit_index</span> <span class="o">-</span> <span class="n">start_pos</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(&#34;\n&#34;)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(&#34;index&#34;, bit_index, start_pos, end_pos, &#34;byte_index:&#34;, byte_index, &#34;bit_offset:&#34;, bit_offset, &#34;v:&#34;, bit_value)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">bit_value</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span><span class="p">[</span><span class="n">byte_index</span><span class="p">]</span> <span class="o">|=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit_offset</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span><span class="p">[</span><span class="n">byte_index</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit_offset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># for i in data:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(bin(i), end=&#34;,&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">set_bit</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">bit</span><span class="p">,</span> <span class="n">bit_index</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">bit_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">bit_index</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;bit_index must be between 0 and 7&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit_index</span>
</span></span><span class="line"><span class="cl">    <span class="n">flipped_byte</span> <span class="o">=</span> <span class="n">b</span> <span class="o">^</span> <span class="n">mask</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">flipped_byte</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_steering_control</span><span class="p">(</span><span class="n">apply_steer</span><span class="p">,</span> <span class="n">lkas_enabled</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">lkas_enabled</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># HCA_01_Sendestatus</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># HCA_01_Status_HCA</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># HCA_01_Sendestatus</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># HCA_01_Status_HCA</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># HCA_01_LM_Offset</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;create_steering_control&#34;</span><span class="p">,</span> <span class="n">apply_steer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">apply_steer</span><span class="p">),</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># HCA_01_LM_OffSign</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">apply_steer</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># HCA_01_Vib_Freq</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># HCA_01_Vib_Amp</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_pla_control</span><span class="p">(</span><span class="n">sendestatus</span><span class="p">,</span> <span class="n">positive</span><span class="p">,</span> <span class="n">degree</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x40</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_QFK_Spuerb</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFA</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_QFK_KruemmSoll</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_QFK_KruemmSoll_VZ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">positive</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># PLA_05_Sendestatus</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">sendestatus</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">set_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">hca_01_counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">degree</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># data = create_steering_control(10 * i, 1)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># meb_can_send(0x126, 0.1, data)</span>
</span></span><span class="line"><span class="cl">    <span class="n">degree</span> <span class="o">+=</span> <span class="mh">0x10</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">create_pla_control</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">can_send</span><span class="p">(</span><span class="mh">0x302</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="notes">Notes</h2>
<ol>
<li><strong>Ensure the CAN bus enters sleep mode before leaving the vehicle</strong>; otherwise, it may drain the battery considerably.</li>
<li><strong>Do not fuzz the Powertrain and Running Gear CAN buses.</strong> This poses a direct risk of physical injury and may trigger abnormal ECU behavior or introduce hidden hazards (e.g., turn signal failure, mirrors not unfolding).</li>
</ol>
</article><section class="article labels"><a class="category" href=/en/categories/automotive-security/>Automotive Security</a><a class="tag" href=/en/tags/id%2e4/>ID.4</a><a class="tag" href=/en/tags/icas1/>ICAS1</a><a class="tag" href=/en/tags/can-bus/>CAN-Bus</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/en/posts/igs-arcade-re-1/"><span class="iconfont icon-article"></span>IGS Arcade Reverse Engineering Series (1) - E2000 Platform Analysis</a></p><p><a class="link" href="/en/posts/qnx7-password-hash-analysis-and-hashcat-module/"><span class="iconfont icon-article"></span>QNX 7 Password Hash Analysis and Writing a Hashcat Module</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2026 Gorgias' Blog. </p><p class="license">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">
            <img alt="CC BY-NC-SA" loading="lazy" src="/images/by-nc.svg" style="vertical-align: middle; height: 1.2em; margin: 0 0.2em;" />
            CC BY-NC-SA 4.0
        </a>
        (Attribution-NonCommercial-ShareAlike).
    </p><p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>