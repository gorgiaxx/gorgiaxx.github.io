<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.154.5"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="Preface
I wrote this post in September last year. Back in July, our team lead brought in a router and handed it to an intern to work on. He couldn‚Äôt crack it and eventually stopped. Later, when I had some free time, I continued, but the decryption part still wasn‚Äôt finished‚Äîhalfway through I got pulled onto other work. So this is an unfinished post."><title>Getting Root Access on Verizon FIOS-G1100&nbsp;&ndash;&nbsp;Gorgias&#39; Blog</title><link rel="stylesheet" href="/css/core.min.363cdd0e3e6340dd0e88b1f21887fb7e53e3129ed31d7f3cf62686d06069621ece79dc5ffb48a77ebba54468e667212f.css" integrity="sha384-NjzdDj5jQN0OiLHyGIf7flPjEp7THX889iaG0GBpYh7Oedxf&#43;0infrulRGjmZyEv"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Getting Root Access on Verizon FIOS-G1100" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/en/"><span class="site name">Gorgias' Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/en/categories/">Categories</a><a class="nav item" href="/en/tags/">Tags</a><a class="nav item" href="/en/about/">About</a><a class="nav item" href="/en/links/">Links</a><a class="nav item" href="/zh/posts/fios-g1100-get-root/" title="‰∏≠Êñá">
            <span class="lang-icon">üåê</span>‰∏≠Êñá</a></nav></div></span></div></section><section id="content"><style>
     
    .toc-wrapper {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 9999;
        display: flex;
        flex-direction: column-reverse;
        align-items: flex-end;
        gap: 10px;
    }

     
    .toc-button {
        background-color: #fff;
        color: #333;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        border: 1px solid #ddd;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .toc-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    .toc-button svg {
        width: 24px;
        height: 24px;
        fill: currentColor;
    }

     
    .toc-content-box {
        background: #fff;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 15px;
        width: 250px;
        max-height: 60vh;
        overflow-y: auto;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        display: none;
         
        font-size: 0.9em;
        opacity: 0;
        transform: translateY(10px);
        transition: opacity 0.3s, transform 0.3s;
    }

    .toc-content-box.show {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    .toc-header {
        font-weight: bold;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 8px;
        margin-bottom: 8px;
        font-size: 1.1em;
    }

     
    #TableOfContents {
        text-align: left;
    }

    #TableOfContents ul,
    #TableOfContents ol {
        list-style: none;
        padding-left: 0;
        margin: 0;
    }

    #TableOfContents li {
        margin: 4px 0;
    }

    #TableOfContents ul ul,
    #TableOfContents ol ol {
        padding-left: 1em;
    }

    #TableOfContents a {
        text-decoration: none;
        color: #555;
        display: block;
        padding: 2px 0;
        transition: color 0.2s;
    }

    #TableOfContents a:hover {
        color: #007bff;
    }

     
    @media (prefers-color-scheme: dark) {
        .toc-button {
            background-color: #333;
            color: #ddd;
            border-color: #555;
        }

        .toc-content-box {
            background-color: #2a2a2a;
            border-color: #444;
            color: #ddd;
        }

        .toc-header {
            border-bottom-color: #444;
        }

        #TableOfContents a {
            color: #aaa;
        }

        #TableOfContents a:hover {
            color: #fff;
        }
    }
</style><div class="article-container"><section class="article header">
    <h1 class="article title">Getting Root Access on Verizon FIOS-G1100</h1><p class="article date">Friday, September 1, 2017<span class="langs"><span class="lang">
                    <a href="/zh/posts/fios-g1100-get-root/" title="‰∏≠Êñá">
                        <span class="lang-icon">üåê</span>‰∏≠Êñá</a>
                </span></span></p></section><article class="article markdown-body"><h2 id="preface">Preface</h2>
<p>I wrote this post in September last year. Back in July, our team lead brought in a router and handed it to an intern to work on. He couldn‚Äôt crack it and eventually stopped. Later, when I had some free time, I continued, but the decryption part still wasn‚Äôt finished‚Äîhalfway through I got pulled onto other work. So this is an unfinished post.</p>
<p>There are three firmware variants for the FIOS-G1100, and the files in their directories are mostly the same:</p>
<p>Frontier<br>
Verizon<br>
0.x.x<br>
1.x.x.x.x<br>
01.x.x.x</p>
<p>G1100 runs a CPE service as a backdoor and exposes port 4567. Verizon controls the device via the TR-069 protocol. If we set up a local ACS and modify the config to point the ACS URL to our local ACS, we can enable an SSH service with root privileges on the WAN interface.</p>
<h2 id="setting-up-a-local-acs">Setting up a local ACS</h2>
<h3 id="genieacs">GenieACS</h3>
<p>GenieACS is an open-source TR-069 remote management system that supports device provisioning.</p>
<p>It requires Node.js, MongoDB, and Redis. DockerHub provides prebuilt images, so you can bring it up quickly. Install genieacs globally:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo npm install -g genieacs
</span></span></code></pre></div><p>Enter the npm module directory and run the services:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> /usr/lib/node_modules/genieacs
</span></span></code></pre></div><p>Start the ACS service (default port 7547):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">genieacs-cwmp
</span></span></code></pre></div><p>Start the GUI REST API service (default port 7557):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">genieacs-nbi
</span></span></code></pre></div><h3 id="genieacs-gui">GenieACS GUI</h3>
<p>Download from GitHub and install dependencies:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/zaidka/genieacs-gui.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> genieacs-gui
</span></span><span class="line"><span class="cl">cp config/graphs-sample.json.erb config/graphs.json.erb
</span></span><span class="line"><span class="cl">cp config/index_parameters-sample.yml config/index_parameters.yml
</span></span><span class="line"><span class="cl">cp config/summary_parameters-sample.yml config/summary_parameters.yml
</span></span><span class="line"><span class="cl">cp config/parameters_edit-sample.yml config/parameters_edit.yml
</span></span><span class="line"><span class="cl">cp config/parameter_renderers-sample.yml config/parameter_renderers.yml
</span></span><span class="line"><span class="cl">cp config/roles-sample.yml config/roles.yml
</span></span><span class="line"><span class="cl">cp config/users-sample.yml config/users.yml
</span></span><span class="line"><span class="cl">bundle
</span></span><span class="line"><span class="cl">rails s
</span></span></code></pre></div><p>You may see a JSON version error here. In <code>Gemfile</code>, replace it with 1.8.4 like below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">gem</span> <span class="err">&#39;json&#39;,</span> <span class="err">&#39;~&gt;</span> <span class="mf">1.8</span><span class="err">.</span><span class="mi">4</span><span class="err">&#39;</span>
</span></span></code></pre></div><h2 id="modifying-the-configuration-file">Modifying the configuration file</h2>
<p>Encryption/decryption scripts (general-purpose scripts for decrypting FIOS config files):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">https://gist.github.com/laanwj/5343bbb48759c8813b5807b43fd01fb6
</span></span><span class="line"><span class="cl">https://gist.github.com/jameshilliard/7112235b62dd929d69d7980c979ae7c0
</span></span><span class="line"><span class="cl">https://gist.github.com/jameshilliard/99191b2a2877220041dc8789fa07339a
</span></span></code></pre></div><p>The config file is encrypted. By analyzing <code>/sbin/frontier4</code> (called <code>bhr4</code> in firmware version 0.x), we can see the config file is encrypted via a function <code>getEncryptedBase64Backup()</code>: it uses OpenSSL‚Äôs <code>EVP_aes_256_cbc</code> and then Base64-encodes the result. As long as you extract the key and IV, you can decrypt it.
<img loading="lazy"  src="./idapro_base64.png"
        alt="idapro_base64"/></p>
<h3 id="todo">TODO</h3>
<p>Although the key is fixed, it is generated at runtime rather than hard-coded. You need to obtain it dynamically in a QEMU environment. I‚Äôm leaving a note here; I didn‚Äôt have time to finish it.</p>
<p>Find the <code>management_server.url</code> section:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;net.tr69_client.management_server.url&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;https://cpe-ems0271.verizon.com/cwmpWeb/CPEMgt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Change the URL to your local ACS address:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">http://192.168.1.241:7547
</span></span></code></pre></div><p>Upload the modified config file, and it will reboot automatically.
<img loading="lazy"  src="./upload_configfile.png"
        alt="upload_configfile"/></p>
<h2 id="enabling-ssh">Enabling SSH</h2>
<h3 id="enable-temporary-ssh">Enable temporary SSH</h3>
<p>From <code>/etc/cwmp/cwmp.xml</code>, we can see the device supports enabling SSH.
<img loading="lazy"  src="./tr069_ssh_config.png"
        alt="tr069_ssh_config"/></p>
<p>Open the GenieACS GUI and you should see the device online.
<img loading="lazy"  src="./device_status.png"
        alt="device_status"/></p>
<p>To control the device, you need to log in first (username/password: admin/admin).
<img loading="lazy"  src="./login.png"
        alt="login"/></p>
<p>Get the list of configuration parameters:
<img loading="lazy"  src="./genieacs_config.png"
        alt="genieacs_config"/></p>
<p>Set <code>X_D4A928_SSH_State</code> to <code>SSH_REMOTE</code>, which means enabling remote access on the WAN interface:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">InternetGatewayDevice</span><span class="p">.</span><span class="nx">X_D4A928_SSH_State</span>
</span></span></code></pre></div><p>Then refresh the value of <code>X_D4A928_SSH_Session_Password</code> (this is a one-time password):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">InternetGatewayDevice</span><span class="p">.</span><span class="nx">X_D4A928_SSH_Session_Password</span>
</span></span></code></pre></div><p>After refreshing, SSH to port 22222 to log in. You can only log in once; if it fails, you need to disable SSH (<code>SSH_REMOTE</code> -&gt; <code>SSH_OFF</code>) and repeat the two steps above.</p>
<h3 id="enable-persistent-ssh-and-modify-firewall-settings">Enable persistent SSH and modify firewall settings</h3>
<p>The default SSH ports on the G1100 are 22 and 8022, but the firewall blocks them by default so you can‚Äôt access SSH directly. The web UI option for SSH firewall configuration was removed; you can use Burp to modify the request and disable the firewall block.
<img loading="lazy"  src="./burp.png"
        alt="burp"/></p>
<p>The G1100‚Äôs SSH service is customized. On boot, it generates its config file under <code>/tmp/ssh</code> from the template <code>/etc/ssh/sshd_config.t</code>.</p>
<p>By default it only allows <code>admin</code> to log in and chroots into <code>/chroot</code>. Modify it to allow any user to log in and remove the chroot; after reboot you‚Äôll be able to connect.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Protocol <span class="m">2</span>
</span></span><span class="line"><span class="cl">PidFile /var/run/sshd.pid
</span></span><span class="line"><span class="cl">Subsystem       sftp    /libexec/sftp-server
</span></span><span class="line"><span class="cl">Port <span class="o">(</span>SSHD_PORT_1<span class="o">)</span>
</span></span><span class="line"><span class="cl">Port <span class="o">(</span>SSHD_PORT_2<span class="o">)</span>
</span></span><span class="line"><span class="cl">SyslogFacility local4
</span></span><span class="line"><span class="cl">PermitRootLogin yes
</span></span><span class="line"><span class="cl">PermitEmptyPasswords yes
</span></span><span class="line"><span class="cl">AllowUsers *
</span></span></code></pre></div><p><img loading="lazy"  src="./getshell.png"
        alt="burp"/></p>
<h2 id="references">References</h2>
<p><a href="https://github.com/The5heepDev/FIOS-G1100"target="_blank" rel="noopener noreferrer">FIOS-G1100 Github</a></p>
<p><a href="https://github.com/zaidka/genieacs/wiki/API-Reference"target="_blank" rel="noopener noreferrer">Genieacs API</a></p>
</article><section class="article labels"><a class="category" href=/en/categories/hardware-security/>Hardware Security</a><a class="tag" href=/en/tags/verizon/>Verizon</a><a class="tag" href=/en/tags/fios/>FIOS</a><a class="tag" href=/en/tags/genieacs/>Genieacs</a></section>
</div>

<div class="toc-wrapper">
    <div class="toc-content-box" id="toc-content-box">
        <div class="toc-header">Table of Contents</div>
        <nav id="TableOfContents">
  <ol>
    <li><a href="#preface">Preface</a></li>
    <li><a href="#setting-up-a-local-acs">Setting up a local ACS</a>
      <ol>
        <li><a href="#genieacs">GenieACS</a></li>
        <li><a href="#genieacs-gui">GenieACS GUI</a></li>
      </ol>
    </li>
    <li><a href="#modifying-the-configuration-file">Modifying the configuration file</a>
      <ol>
        <li><a href="#todo">TODO</a></li>
      </ol>
    </li>
    <li><a href="#enabling-ssh">Enabling SSH</a>
      <ol>
        <li><a href="#enable-temporary-ssh">Enable temporary SSH</a></li>
        <li><a href="#enable-persistent-ssh-and-modify-firewall-settings">Enable persistent SSH and modify firewall settings</a></li>
      </ol>
    </li>
    <li><a href="#references">References</a></li>
  </ol>
</nav>
    </div>
    <div class="toc-button" onclick="toggleTOC()" title="">
        
        <svg viewBox="0 0 24 24">
            <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"></path>
        </svg>
    </div>
</div>

<script>
    function toggleTOC() {
        const tocBox = document.getElementById('toc-content-box');
        if (tocBox.classList.contains('show')) {
            tocBox.classList.remove('show');
            
            
            
            
            
            setTimeout(() => {
                tocBox.style.display = 'none';
            }, 300); 
        } else {
            tocBox.style.display = 'block';
            
            void tocBox.offsetWidth;
            tocBox.classList.add('show');
        }
    }

    
    document.addEventListener('click', function (event) {
        const wrapper = document.querySelector('.toc-wrapper');
        const tocBox = document.getElementById('toc-content-box');
        if (wrapper && !wrapper.contains(event.target) && tocBox.classList.contains('show')) {
            toggleTOC();
        }
    });
</script><div class="article bottom"><section class="article navigation"><p><a class="link" href="/en/posts/find-origin-server-behind-cdn/"><span class="iconfont icon-article"></span>Approaches to Finding the Origin Server Behind a CDN</a></p><p><a class="link" href="/en/posts/hackrf-gps-spoofing/"><span class="iconfont icon-article"></span>HackRF GPS Spoofing Notes</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">2015 - 2026 Gorgias' Blog. </p><p class="license">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">
            <img alt="CC BY-NC-SA" loading="lazy" src="/images/by-nc.svg" style="vertical-align: middle; height: 1.2em; margin: 0 0.2em;" />
            CC BY-NC-SA 4.0
        </a>
        (Attribution-NonCommercial-ShareAlike).
    </p><p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div></section></body>

</html>